

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>16. Customizing and Extending GPS &mdash; GPS 5.2.1 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '5.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="GPS 5.2.1 documentation" href="index.html" />
    <link rel="next" title="17. Environment" href="environment.html" />
    <link rel="prev" title="15. Using GPS for Remote Development" href="remote.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="environment.html" title="17. Environment"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="remote.html" title="15. Using GPS for Remote Development"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">GPS 5.2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/adacore_transparent.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">16. Customizing and Extending GPS</a><ul>
<li><a class="reference internal" href="#the-preferences-dialog">16.1. The Preferences Dialog</a></li>
<li><a class="reference internal" href="#gps-themes">16.2. GPS Themes</a></li>
<li><a class="reference internal" href="#the-key-manager-dialog">16.3. The Key Manager Dialog</a></li>
<li><a class="reference internal" href="#the-plug-ins-editor">16.4. The Plug-ins Editor</a></li>
<li><a class="reference internal" href="#customizing-through-xml-and-python-files">16.5. Customizing through XML and Python files</a><ul>
<li><a class="reference internal" href="#customization-files-and-plugins">16.5.1. Customization files and plugins</a><ul>
<li><a class="reference internal" href="#python-files">16.5.1.1. Python files</a></li>
<li><a class="reference internal" href="#xml-files">16.5.1.2. XML files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#defining-actions">16.5.2. Defining Actions</a></li>
<li><a class="reference internal" href="#macro-arguments">16.5.3. Macro arguments</a></li>
<li><a class="reference internal" href="#filtering-actions">16.5.4. Filtering actions</a><ul>
<li><a class="reference internal" href="#the-filters-tags">16.5.4.1. The filters tags</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-new-menus">16.5.5. Adding new menus</a></li>
<li><a class="reference internal" href="#adding-contextual-menus">16.5.6. Adding contextual menus</a></li>
<li><a class="reference internal" href="#adding-tool-bar-buttons">16.5.7. Adding tool bar buttons</a></li>
<li><a class="reference internal" href="#binding-actions-to-keys">16.5.8. Binding actions to keys</a></li>
<li><a class="reference internal" href="#preferences-support-in-custom-files">16.5.9. Preferences support in custom files</a><ul>
<li><a class="reference internal" href="#creating-new-preferences">16.5.9.1. Creating new preferences</a></li>
<li><a class="reference internal" href="#setting-preferences-values">16.5.9.2. Setting preferences values</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-themes">16.5.10. Creating themes</a></li>
<li><a class="reference internal" href="#defining-new-search-patterns">16.5.11. Defining new search patterns</a></li>
<li><a class="reference internal" href="#adding-support-for-new-languages">16.5.12. Adding support for new languages</a></li>
<li><a class="reference internal" href="#defining-text-aliases">16.5.13. Defining text aliases</a></li>
<li><a class="reference internal" href="#aliases-files">16.5.14. Aliases files</a></li>
<li><a class="reference internal" href="#defining-project-attributes">16.5.15. Defining project attributes</a><ul>
<li><a class="reference internal" href="#declaring-the-new-attributes">16.5.15.1. Declaring the new attributes</a></li>
<li><a class="reference internal" href="#declaring-the-type-of-the-new-attributes">16.5.15.2. Declaring the type of the new attributes</a></li>
<li><a class="reference internal" href="#examples">16.5.15.3. Examples</a></li>
<li><a class="reference internal" href="#accessing-the-project-attributes">16.5.15.4. Accessing the project attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-casing-exceptions">16.5.16. Adding casing exceptions</a></li>
<li><a class="reference internal" href="#adding-documentation">16.5.17. Adding documentation</a></li>
<li><a class="reference internal" href="#adding-stock-icons">16.5.18. Adding stock icons</a></li>
<li><a class="reference internal" href="#remote-programming-customization">16.5.19. Remote programming customization</a><ul>
<li><a class="reference internal" href="#defining-a-remote-connection-tool">16.5.19.1. Defining a remote connection tool</a></li>
<li><a class="reference internal" href="#defining-a-shell">16.5.19.2. Defining a shell</a></li>
<li><a class="reference internal" href="#configuring-rsync-usage">16.5.19.3. Configuring rsync usage</a></li>
<li><a class="reference internal" href="#defining-a-remote-server">16.5.19.4. Defining a remote server</a></li>
<li><a class="reference internal" href="#defining-a-remote-path-translation">16.5.19.5. Defining a remote path translation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#customizing-build-targets-and-models">16.5.20. Customizing build Targets and Models</a><ul>
<li><a class="reference internal" href="#defining-new-target-models">16.5.20.1. Defining new Target Models</a></li>
<li><a class="reference internal" href="#defining-new-targets">16.5.20.2. Defining new Targets</a></li>
<li><a class="reference internal" href="#defining-new-modes">16.5.20.3. Defining new Modes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#toolchains-customization">16.5.21. Toolchains customization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-support-for-new-tools">16.6. Adding support for new tools</a><ul>
<li><a class="reference internal" href="#defining-supported-languages">16.6.1. Defining supported languages</a></li>
<li><a class="reference internal" href="#defining-default-command-line">16.6.2. Defining default command line</a></li>
<li><a class="reference internal" href="#defining-tool-switches">16.6.3. Defining tool switches</a></li>
<li><a class="reference internal" href="#executing-external-tools">16.6.4. Executing external tools</a><ul>
<li><a class="reference internal" href="#chaining-commands">16.6.4.1. Chaining commands</a></li>
<li><a class="reference internal" href="#saving-open-windows">16.6.4.2. Saving open windows</a></li>
<li><a class="reference internal" href="#querying-project-switches">16.6.4.3. Querying project switches</a></li>
<li><a class="reference internal" href="#querying-switches-interactively">16.6.4.4. Querying switches interactively</a></li>
<li><a class="reference internal" href="#redirecting-the-command-output">16.6.4.5. Redirecting the command output</a></li>
<li><a class="reference internal" href="#processing-the-tool-output">16.6.4.6. Processing the tool output</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#customization-examples">16.7. Customization examples</a><ul>
<li><a class="reference internal" href="#menu-example">16.7.1. Menu example</a></li>
<li><a class="reference internal" href="#tool-example">16.7.2. Tool example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#scripting-gps">16.8. Scripting GPS</a><ul>
<li><a class="reference internal" href="#scripts">16.8.1. Scripts</a></li>
<li><a class="reference internal" href="#scripts-and-gps-actions">16.8.2. Scripts and GPS actions</a></li>
<li><a class="reference internal" href="#the-gps-shell">16.8.3. The GPS Shell</a></li>
<li><a class="reference internal" href="#the-python-interpreter">16.8.4. The Python Interpreter</a></li>
<li><a class="reference internal" href="#python-modules">16.8.5. Python modules</a></li>
<li><a class="reference internal" href="#subprogram-parameters">16.8.6. Subprogram parameters</a></li>
<li><a class="reference internal" href="#python-faq">16.8.7. Python FAQ</a><ul>
<li><a class="reference internal" href="#hello-world-in-python">16.8.7.1. Hello World! in python</a></li>
<li><a class="reference internal" href="#spawning-external-processes">16.8.7.2. Spawning external processes</a></li>
<li><a class="reference internal" href="#redirecting-the-output-of-spawned-processes">16.8.7.3. Redirecting the output of spawned processes</a></li>
<li><a class="reference internal" href="#contextual-menus-on-object-directories-only">16.8.7.4. Contextual menus on object directories only</a></li>
<li><a class="reference internal" href="#redirecting-the-output-to-specific-windows">16.8.7.5. Redirecting the output to specific windows</a></li>
<li><a class="reference internal" href="#reloading-a-python-file-in-gps">16.8.7.6. Reloading a python file in GPS</a></li>
<li><a class="reference internal" href="#printing-the-gps-python-documentation">16.8.7.7. Printing the GPS Python documentation</a></li>
<li><a class="reference internal" href="#automatically-loading-python-files-at-startup">16.8.7.8. Automatically loading python files at startup</a></li>
<li><a class="reference internal" href="#hiding-contextual-menus">16.8.7.9. Hiding contextual menus</a></li>
<li><a class="reference internal" href="#creating-custom-graphical-interfaces">16.8.7.10. Creating custom graphical interfaces</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hooks">16.8.8. Hooks</a><ul>
<li><a class="reference internal" href="#adding-commands-to-hooks">16.8.8.1. Adding commands to hooks</a></li>
<li><a class="reference internal" href="#action-hooks">16.8.8.2. Action hooks</a></li>
<li><a class="reference internal" href="#running-hooks">16.8.8.3. Running hooks</a></li>
<li><a class="reference internal" href="#creating-new-hooks">16.8.8.4. Creating new hooks</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#adding-support-for-new-version-control-systems">16.9. Adding support for new Version Control Systems</a><ul>
<li><a class="reference internal" href="#custom-vcs-interfaces">16.9.1. Custom VCS interfaces</a></li>
<li><a class="reference internal" href="#describing-a-vcs">16.9.2. Describing a VCS</a><ul>
<li><a class="reference internal" href="#the-vcs-node">16.9.2.1. The VCS node</a></li>
<li><a class="reference internal" href="#associating-actions-to-operations">16.9.2.2. Associating actions to operations</a></li>
<li><a class="reference internal" href="#defining-revision-information">16.9.2.3. Defining revision information</a></li>
<li><a class="reference internal" href="#defining-status">16.9.2.4. Defining status</a></li>
<li><a class="reference internal" href="#output-parsers">16.9.2.5. Output parsers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-vcs-actions">16.9.3. Implementing VCS actions</a></li>
<li><a class="reference internal" href="#implementing-vcs-menus">16.9.4. Implementing VCS menus</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-server-mode">16.10. The Server Mode</a></li>
<li><a class="reference internal" href="#adding-project-templates">16.11. Adding project templates</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="remote.html"
                        title="previous chapter">15. Using GPS for Remote Development</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="environment.html"
                        title="next chapter">17. Environment</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/extending.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="customizing-and-extending-gps">
<span id="id1"></span><h1>16. Customizing and Extending GPS<a class="headerlink" href="#customizing-and-extending-gps" title="Permalink to this headline">¶</a></h1>
<p id="index-0">GPS provides several levels of customization, from simple preferences dialog to
powerful scripting capability through the <cite>python</cite> language.  This chapters
describes each of these capabilities.</p>
<div class="section" id="the-preferences-dialog">
<span id="id2"></span><h2>16.1. The Preferences Dialog<a class="headerlink" href="#the-preferences-dialog" title="Permalink to this headline">¶</a></h2>
<span class="target" id="preferences-dialog"></span><p id="index-1">This dialog, available through the menu <cite>Edit-&gt;Preferences</cite>, allows you to
modify the global preferences of GPS.  To enable the new preferences, you
simply need to confirm by pressing the <cite>OK</cite> button. To test your changes, you
can use the <cite>Apply</cite> button. Pressing the <cite>Cancel</cite> button will undo all your
changes.</p>
<img alt="_images/preferences-general.jpg" id="index-2" src="_images/preferences-general.jpg" />
<p>Each preference is composed of a label displaying the name of the preference,
and an editing area to modify its value. If you leave to mouse over the label,
a tool tip will be displayed giving an on-line help on the preference.</p>
<p>The preferences dialog is composed of several areas, accessible through the
tabs at the left of the dialog.  Each page corresponds to a set of preferences.</p>
<ul>
<li><p class="first"><strong>Themes</strong></p>
<p>This page allows you to quickly change the current settings for GPS,
including preferences, key bindings, menus...; See <a class="reference internal" href="#gps-themes"><em>GPS Themes</em></a> for more
information on themes. It is only displayed when there are themes registered.</p>
</li>
<li><p class="first"><strong>General</strong></p>
<dl class="docutils">
<dt><em>Default font</em></dt>
<dd><span class="target" id="index-3"></span><p class="first last" id="index-4">The default font used in GPS. The background color you select for this
preference will set the background color for all consoles and most views
(the ones that display their data as trees, mostly). To change the
background color of editors, see the preference Edit/Fonts&amp;Colors/Default.</p>
</dd>
<dt><em>Fixed view font</em></dt>
<dd><p class="first last" id="index-5">The fixed (monospace) font used in views like the outline view, the
bookmark view, ...; As much as possible, this font should use a fixed width
for characters, for a better rendering</p>
</dd>
<dt><em>Character set</em></dt>
<dd><span class="target" id="index-6"></span><p class="first" id="index-7">Name of character set to use when reading or writting text files.  GPS uses
UTF-8 and Unicode internally, which can handle any character in any
language. However, your system will generally not support Unicode natively,
and thus the contents of the files should be translated from the file
system encoding to unicode.</p>
<p class="last">This preference indicates the file system encoding in use. It defaults to
ISO-8859-1, which corresponds to western european characters.</p>
</dd>
<dt><em>Display splash screen</em></dt>
<dd><p class="first last" id="index-8">Whether a splash screen should be displayed when starting GPS.</p>
</dd>
<dt><em>Display welcome window</em></dt>
<dd><p class="first last" id="index-9">Whether GPS should display the welcome window for the selection of the
project to use.</p>
</dd>
<dt><em>Show text in tool bar</em></dt>
<dd><p class="first last" id="index-10">Whether the tool bar should show both text and icons, or only icons.</p>
</dd>
<dt><em>Auto save</em></dt>
<dd><p class="first last" id="index-11">Whether unsaved files and projects should be saved automatically before
calling external tools (e.g. before a build).</p>
</dd>
<dt><em>Save desktop on exit</em></dt>
<dd><p class="first last" id="index-12">Whether the desktop (size and positions of all windows) should be saved
when exiting.  If you are working with a project created automatically by
GPS, the desktop will not be saved.</p>
</dd>
<dt><em>Save editor in desktop</em></dt>
<dd><p class="first last" id="index-13">Determines when source editors should be saved in the desktop: <cite>Never</cite>,
<cite>Always</cite>, or when a source file is associated with the current project
(<cite>From_Project</cite>).</p>
</dd>
<dt><em>Default builder</em></dt>
<dd><p class="first">The default builder to be used by GPS.</p>
<ul class="last simple">
<li><cite>Auto</cite> to use <em>gnatmake</em> for Ada-only projects and <em>gprbuild</em> otherwise
(for multi-language and non Ada projects).</li>
<li><cite>Gnatmake</cite> to always use <em>gnatmake</em> for builds, even for projects that
contain other sources. This will disable support for building non Ada
projects.</li>
<li><cite>Gprbuild</cite> to always use <em>gprbuild</em> for builds, even for Ada only
projects.</li>
</ul>
</dd>
<dt><em>Jump to first location</em></dt>
<dd><p class="first last" id="index-14">Whether the first entry of the location window should be selected
automatically, and thus whether the corresponding editor should be
immediately open.</p>
</dd>
<dt><em>Wrap around on next/previous</em></dt>
<dd><p class="first last" id="index-15">Whether using the <cite>Next Tag</cite> and <cite>Previous Tag</cite> actions/menus should wrap
around to the beginning when reaching the end of the category.  The default
is to wrap around, as was done in previous GPS versions.</p>
</dd>
<dt><em>Auto close Locations view</em></dt>
<dd><p class="first last" id="index-16">Whether the Locations view should be closed automatically when it becomes
empty.</p>
</dd>
<dt><em>Hyper links</em></dt>
<dd><p class="first last" id="index-17">Whether to display hyper links in the editors when the Control key is
pressed.  <a class="reference internal" href="navigation.html#navigating-with-hyperlinks"><em>Navigating with hyperlinks</em></a>.</p>
</dd>
<dt><em>Clipboard size</em></dt>
<dd><p class="first last" id="index-18">This controls the size of the list where all the entries copied into the
clipboard through <cite>Edit-&gt;Copy</cite> and <cite>Edit-&gt;Cut</cite> are saved. This list is
navigated through the menu <cite>Edit-&gt;Paste</cite> and <cite>Edit-&gt;Paste Previous</cite>, as
described earlier in this guide.</p>
</dd>
<dt><em>Tool bar style</em></dt>
<dd><p class="first last" id="index-19">How the tool bar should be displayed: not at all, with small icons or with
large icons</p>
</dd>
<dt><em>Show status bar</em></dt>
<dd><p class="first" id="index-20">Whether the status bar at the bottom of the GPS window should be displayed.
This status bar contains one or more progress bars while GPS is executing
long actions like a build or a search. These progress bars can be used to
monitor the progress of those actions.</p>
<p class="last">If you wish to save vertical screen space, you can hide this status bar.
The progress bars will no longer be visible. Instead, you can display the
Task Manager through the <cite>Tools-&gt;Views-&gt;Tasks</cite> menu, to get similar
information.  This manager can then be put on the right or left side of the
GPS window, for instance just below the Project View.</p>
</dd>
<dt><em>Remove policy when fixing code</em></dt>
<dd><p class="first last" id="index-21">Prefered way to fix code when parts have to be removed.  <cite>Always_Remove</cite>
means that the code will be removed by GPS.  <cite>Always_Comment</cite> means that
the code will always be commented out.  <cite>Propose_Both_Choices</cite> will propose
a menu with both choices.</p>
</dd>
<dt><em>Tip of the Day</em></dt>
<dd><p class="first last" id="index-22">Whether GPS will display a <em>Tip of the Day</em> dialog at start up.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>Windows</strong></p>
<span class="target" id="index-23"></span><p id="index-24">This section specifies preferences that apply to the <em>Multiple Document
Interface</em> described in <a class="reference internal" href="mdi.html#multiple-document-interface"><em>Multiple Document Interface</em></a>.</p>
<dl class="docutils">
<dt><em>Opaque</em></dt>
<dd><p class="first last" id="index-25">If True, items will be resized or moved opaquely when not maximized.</p>
</dd>
<dt><em>Destroy floats</em></dt>
<dd><p class="first last" id="index-26">If False, closing the window associated with a floating item will put the
item back in the main GPS window, but will not destroy it. If True, the
item is destroyed.</p>
</dd>
<dt><em>All floating</em></dt>
<dd><p class="first last" id="index-27">If True, then all the windows will be floating by default, i.e. be under
the control of your system (Windows) or your window manager (Unix
machines). This replaces the MDI.</p>
</dd>
<dt><em>Short titles for floats</em></dt>
<dd><p class="first last" id="index-28">If True, all floating windows will have a short title. In particular, base
file names will be used for editors instead of full names.</p>
</dd>
<dt><em>Background color</em></dt>
<dd><p class="first last" id="index-29">Color to use for the background of the MDI.</p>
</dd>
<dt><em>Title bar color</em></dt>
<dd><p class="first last" id="index-30">Color to use for the title bar of unselected items.</p>
</dd>
<dt><em>Selected title bar color</em></dt>
<dd><p class="first last" id="index-31">Color to use for the title bar of selected items.</p>
</dd>
</dl>
<p><em>Show title bars</em></p>
<blockquote>
<div><p>If Always, each window in GPS will have its own title bars, showing some
particular information (like the name of the file edited for editors), and
some buttons to iconify, maximize or close the window. This title bar is
highlighted when the window is the one currently selected.</p>
<p>If Never, the title bar is not displayed, to save space on the screen. The
tabs of the notebooks will then be highlighted.</p>
<p>If Central Only, then only the windows in the central area (ie the part that
gets preserved when switching perspective, mostly editors) will have a title
bar. All other windows will not show the title bar. This is often a good way
to save space on the screen: the title bar is useful for editors since it
gives the full name of the file as well as provide an easy handle for drag
and drop operations, whereas the other views do not change position as much
and it is better to save space on the screen by not displaying their title.</p>
</div></blockquote>
</li>
</ul>
<p><em>Notebook tabs policy</em></p>
<blockquote>
<div><blockquote>
<div>Indicates when the notebook tabs should be displayed. If set to &#8220;Never&#8221;, you
will have to select the window in the Window menu, or through the keyboard.
If set to &#8220;Automatic&#8221;, then the tabs will be shown when two or more windows
are stacked.</div></blockquote>
<p><em>Notebook tabs position</em></p>
<blockquote>
<div>Indicates where the notebook tabs should be displayed by default. It is
possible to select the position of tabs individually for each notebook
by right-clicking in any of their tabs and chosing a new position in the
contextual menu. This position will be saved as part of the desktop and
restored the next time you restart GPS. However, if you change the value
of this preference, all notebooks will reset the position of their tabs
to match the new value of the preference.</div></blockquote>
</div></blockquote>
<ul>
<li><p class="first"><strong>Editor</strong>
.. index:: editor</p>
<p><em>General</em></p>
<blockquote>
<div><dl class="docutils">
<dt><em>Strip blanks</em></dt>
<dd><p class="first last" id="index-32">Whether the editor should remove trailing blanks when saving a file.</p>
</dd>
<dt><em>Line terminator</em></dt>
<dd><p class="first last" id="index-33">Choose between <em>Unix</em>, <em>Windows</em> and <em>Unchanged</em> line terminators when
saving files. Choosing <em>Unchanged</em> will use the original line terminator
when saving the file; <em>Unix</em> will use LF line terminators; <em>Windows</em> will
use CRLF line terminators.</p>
</dd>
<dt><em>Display line numbers</em></dt>
<dd><p class="first last" id="index-34">Whether the line numbers should be displayed in file editors.</p>
</dd>
<dt><em>Display subprogram names</em></dt>
<dd><p class="first last" id="index-35">Whether the subprogram name should be displayed in the editor&#8217;s status
bar.</p>
</dd>
<dt><em>Tooltips</em></dt>
<dd><p class="first last" id="index-36">Whether tool tips should be displayed automatically.</p>
</dd>
<dt><em>Tooltips timeout</em></dt>
<dd><p class="first last" id="index-37">Time (in milliseconds) before displaying tooltips.</p>
</dd>
<dt><em>Highlight delimiters</em></dt>
<dd><p class="first last" id="index-38">Determine whether the delimiter matching the character following the
cursor should be highlighted. The list of delimiters includes: <cite>{}[]()</cite></p>
</dd>
<dt><em>Autosave delay</em></dt>
<dd><p class="first" id="autosave-delay"><span id="index-39"></span>The period (in seconds) after which an editor is automatically saved,
0 if none.</p>
<p class="last">Each modified file is saved under a file called <cite>.#filename#</cite>, which is
removed on the next explicit save operation.</p>
</dd>
<dt><em>Right margin</em></dt>
<dd><p class="first last" id="index-40">The right margin to highlight. 0 if none.
This value is also used to implement the <cite>Edit-&gt;Refill</cite> command.</p>
</dd>
<dt><em>Block highlighting</em></dt>
<dd><p class="first last" id="index-41">Whether the editor should highlight the current block.
The current block depends on the programming language, and will include
e.g. procedures, loops, if statements, ...</p>
</dd>
<dt><em>Block folding</em></dt>
<dd><p class="first last" id="index-42">Whether the editor should provide the ability to fold/unfold blocks.</p>
</dd>
<dt><em>Speed Column Policy</em></dt>
<dd><p class="first" id="index-43">When the Speed Column should be shown on the side of the editors:</p>
<dl class="last docutils">
<dt><em>Never</em></dt>
<dd><p class="first last">The Speed Column is never displayed.</p>
</dd>
<dt><em>Automatic</em></dt>
<dd><p class="first last">The Speed Column is shown whenever lines are highlighted in the editor,
for example to show the current execution point, or lines containing
compilation errors, ...; It disappears when no lines are highlighted.</p>
</dd>
<dt><em>Always</em></dt>
<dd><p class="first last">The Speed Column is always displayed.</p>
</dd>
</dl>
</dd>
<dt><em>Use Windows ACL</em></dt>
<dd><p class="first last">This is a Windows specific preference which is disabled by default. When
enabled GPS will use the ACL to change the file&#8217;s write permission. Note
that ACL can&#8217;t be used on network drives.</p>
</dd>
<dt><em>External editor</em></dt>
<dd><p class="first last" id="index-44">The default external editor to use.</p>
</dd>
<dt><em>Custom editor command</em></dt>
<dd><p class="first" id="custom-editor-command">Specify the command line for launching a custom editor.  It is assumed
that the command will create a new window/terminal as needed.  If the
editor itself does not provide this capability (such as vi or pico under
Unix systems), you can use an external terminal command, e.g:</p>
<div class="highlight-python"><pre>xterm -geo 80x50 -exe vi +%l %f</pre>
</div>
<p>The following substitutions are provided:</p>
<dl class="last docutils">
<dt><em>%l</em></dt>
<dd><p class="first last">line to display</p>
</dd>
<dt><em>%c</em></dt>
<dd><p class="first last">column to display</p>
</dd>
<dt><em>%f</em></dt>
<dd><p class="first last">full pathname of file to edit</p>
</dd>
<dt><em>%e</em></dt>
<dd><p class="first last">extended lisp inline command</p>
</dd>
<dt><em>%p</em></dt>
<dd><p class="first last">top level project file name</p>
</dd>
<dt><em>%%</em></dt>
<dd><p class="first last">percent sign (&#8216;%&#8217;)</p>
</dd>
</dl>
</dd>
<dt><em>Always use external editor</em></dt>
<dd><p class="first last">True if all editions should be done with the external editor. This will
deactivate completely the internal editor. False if the external editor
needs to be explicitly called by the user.</p>
</dd>
<dt><em>Smart completion</em></dt>
<dd><p class="first last" id="index-45">When enabled, GPS loads on startup all the information needed for the
Smart completion to work.</p>
</dd>
<dt><em>Smart completion timeout</em></dt>
<dd><p class="first last">The timeout, expressed in milliseconds, after which the Smart completion
window appears automatically after entering a triggering character, such
as &#8216;.&#8217;</p>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt><em>Fonts &amp; Colors</em></dt>
<dd><span class="target" id="index-46"></span><dl class="first last docutils" id="index-47">
<dt><em>Default</em></dt>
<dd><p class="first last">The default font, default foreground and default background colors used
in the source editor.</p>
</dd>
<dt><em>Block</em></dt>
<dd><p class="first last">Font variant and colors used to highlight blocks (subprograms, task,
entries, ...) in declarations.</p>
</dd>
<dt><em>Type</em></dt>
<dd><p class="first last">Font variant and colors used to highlight types in declarations.</p>
</dd>
<dt><em>Keywords</em></dt>
<dd><p class="first last">Font variant and colors used to highlight keywords.</p>
</dd>
<dt><em>Comments</em></dt>
<dd><p class="first last">Font variant and colors used to highlight comments.
Setting the color to white will set a transparent color.</p>
</dd>
<dt><em>SPARK Annotations</em></dt>
<dd><p class="first last">Font variant and colors used to highlight SPARK annotations within
Ada comments (Starting with <cite>&#8211;#</cite>). Setting the color to white
will set a transparent color.</p>
</dd>
<dt><em>Strings</em></dt>
<dd><p class="first last">Font variant and colors used to highlight strings.
Setting the color to white will set a transparent color.</p>
</dd>
<dt><em>Current line color</em></dt>
<dd><p class="first last">Color for highlighting the current line. Leave it to blank for no
highlighting.  Setting the color to white will set a transparent color.</p>
</dd>
<dt><em>Draw current line as a thin line</em></dt>
<dd><p class="first last">Whether to use a thin line rather than full background highlighting on the
current line.</p>
</dd>
<dt><em>Current block color</em></dt>
<dd><p class="first last">Color for highlighting the current source block.</p>
</dd>
<dt><em>Delimiter highlighting color</em></dt>
<dd><p class="first last">Color for highlighting delimiters.</p>
</dd>
<dt><em>Search results highlighting</em></dt>
<dd><p class="first last">Color for highlighting the search results in the text of source editors.</p>
</dd>
<dt><em>Cursor color</em></dt>
<dd><p class="first last">Color used for the cursor in editors and interactive consoles</p>
</dd>
<dt><em>Cursor aspect ratio</em></dt>
<dd><p class="first last">Defines the size of the cursor, relatively to characters. 100 means the
cursor will occupy the same size as a character, 10 means it will only
occupy 10% of the size occupies by a character.</p>
</dd>
</dl>
</dd>
<dt><em>Ada</em></dt>
<dd><blockquote class="first">
<div><dl class="docutils" id="index-48">
<dt><em>Auto indentation</em></dt>
<dd><p class="first last" id="index-49">How the editor should indent Ada sources.
None means no indentation; Simple means that indentation from the previous
line is used for the next line; Extended means that a language specific
parser is used for indenting sources.</p>
</dd>
<dt><em>Use tabulations</em></dt>
<dd><p class="first last" id="index-50">Whether the editor should use tabulations when indenting.  Note that this
preference does not modify the <tt class="kbd docutils literal"><span class="pre">Tab</span></tt> key which will still insert Tab
characters. Consider also the <cite>/Edit/Insert Tab With Spaces</cite> key shortcut
which can be mapped (to e.g. <tt class="kbd docutils literal"><span class="pre">Tab</span></tt>) via
<a class="reference internal" href="#the-key-manager-dialog"><em>The Key Manager Dialog</em></a>. Finally, another alternative is to
reconfigure the default key binding for the automatic indentation action:
by default, it is mapped to <tt class="kbd docutils literal"><span class="pre">Ctrl-Tab</span></tt> and can be changed to
<tt class="kbd docutils literal"><span class="pre">Tab</span></tt> by modifying the <cite>/Edit/Format Selection</cite> action from
<a class="reference internal" href="#the-key-manager-dialog"><em>The Key Manager Dialog</em></a>.</p>
</dd>
<dt><em>Default indentation</em></dt>
<dd><p class="first last" id="index-51">The number of spaces for the default Ada indentation.</p>
</dd>
<dt><em>Continuation lines</em></dt>
<dd><p class="first last" id="index-52">The number of extra spaces for continuation lines.</p>
</dd>
<dt><em>Declaration lines</em></dt>
<dd><p>The number of extra spaces for multiple line declarations.  For example,
using a value of 4, here is how the following code would be indented:</p>
<div class="last highlight-ada"><div class="highlight"><pre><span class="n">variable1</span><span class="p">,</span>
    <span class="n">variable2</span><span class="p">,</span>
    <span class="n">variable3</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
</pre></div>
</div>
</dd>
<dt><em>Conditional continuation lines</em></dt>
<dd><p class="first" id="index-54">The number of extra spaces used to indent multiple lines conditionals
within parentheses.</p>
<p>For example, when this preference is set to 1 (the default), continuation
lines are indented based on the previous parenthesis plus one space:</p>
<div class="highlight-ada"><div class="highlight"><pre><span class="kr">if</span> <span class="p">(</span><span class="n">Condition1</span>
    <span class="ow">and then</span> <span class="n">Condition2</span><span class="p">)</span>
<span class="kr">then</span>
</pre></div>
</div>
<p>When this preference is set to 3, this gives:</p>
<div class="last highlight-ada"><div class="highlight"><pre><span class="kr">if</span> <span class="p">(</span><span class="n">Condition1</span>
      <span class="ow">and then</span> <span class="n">Condition2</span><span class="p">)</span>
<span class="kr">then</span>
</pre></div>
</div>
</dd>
<dt><em>Record indentation</em></dt>
<dd><p class="first" id="index-55">The number of extra spaces for record definitions, when the <cite>record</cite>
keyword is on its own line.</p>
<p>For example, when this preference is set to 3 (the default), the
following sample will be indented as:</p>
<div class="highlight-ada"><div class="highlight"><pre><span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span>
   <span class="kr">record</span>
      <span class="nv">F</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">;</span>
   <span class="nv">end</span> <span class="nv">record</span><span class="p">;</span>
</pre></div>
</div>
<p>When this preference is set to 1, this gives:</p>
<div class="last highlight-ada"><div class="highlight"><pre><span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span>
 <span class="kr">record</span>
    <span class="nv">F</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">;</span>
 <span class="nv">end</span> <span class="nv">record</span><span class="p">;</span>
</pre></div>
</div>
</dd>
<dt><em>Case indentation</em></dt>
<dd><p class="first" id="index-56">Whether GPS should indent case statements with an extra level, as used in
the Ada Reference Manual, e.g:</p>
<div class="highlight-ada"><div class="highlight"><pre><span class="kr">case</span> <span class="n">Value</span> <span class="kr">is</span>
   <span class="kr">when</span> <span class="kr">others</span> <span class="p">=&gt;</span>
      <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="kr">case</span><span class="p">;</span>
</pre></div>
</div>
<p>If this preference is set to <cite>Non_Rm_Style</cite>, this would be indented as:</p>
<div class="highlight-ada"><div class="highlight"><pre><span class="kr">case</span> <span class="n">Value</span> <span class="kr">is</span>
<span class="kr">when</span> <span class="kr">others</span> <span class="p">=&gt;</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="kr">case</span><span class="p">;</span>
</pre></div>
</div>
<p class="last">By default (<cite>Automatic</cite>), GPS will choose to indent with an extra
level or not based on the first <cite>when</cite> construct: if the first
<cite>when</cite> is indented by an extra level, the whole case statement will
be indented following the RM style.</p>
</dd>
<dt><em>Casing policy</em></dt>
<dd><p class="first">The way the editor will handle the case settings below.  <cite>Disabled</cite> no
auto-casing will be done; <cite>End_Of_Line</cite> auto-casing will be done when
hitting <tt class="kbd docutils literal"><span class="pre">Enter</span></tt> key; <cite>End_Of_Word</cite> auto-casing will be done
word-by-word while typing; <cite>On_The_Fly</cite> auto-casing will be done
character-by-character while typing.  For the <cite>End_Of_Line</cite>,
<cite>End_Of_Word</cite> and <cite>On_The_Fly</cite> policies it is always possible to force
the casing of the current line by pressing the indentation key
(<tt class="kbd docutils literal"><span class="pre">Ctrl-Tab</span></tt> by default).</p>
<p class="last">It is also possible to disable the casing for a single character (action
<cite>No Casing/indentation on Next Key</cite>, default <tt class="kbd docutils literal"><span class="pre">Ctrl-Q</span></tt>) or
temporarily (action <cite>Toggle Auto Casing/indentation</cite>, default
<tt class="kbd docutils literal"><span class="pre">Alt-Q</span></tt>).</p>
</dd>
<dt><em>Reserved word casing</em></dt>
<dd><p class="first last">How the editor should handle reserved words casing.  <cite>Unchanged</cite> will
keep the casing as-is; <cite>Upper</cite> will change the casing of all reserved
words to upper case; <cite>Lower</cite> will change the casing to lower case;
<cite>Mixed</cite> will change the casing to mixed case (all characters to lower
case except first character and characters after an underscore which are
set to upper case); <cite>Smart_Mixed</cite> As above but do not force upper case
characters to lower case.</p>
</dd>
<dt><em>Identifier casing</em></dt>
<dd><p class="first last">How the editor should handle identifiers casing.
The values are the same as for the <em>Reserved word casing</em> preference.</p>
</dd>
<dt><em>Format operators/delimiters</em></dt>
<dd><p class="first last">Whether the editor should add extra spaces around operators and
delimiters if needed.  If enabled, an extra space will be added when
needed in the following cases: before an opening parenthesis; after a
closing parenthesis, comma, semicolon; around all Ada operators (e.g.
<cite>&lt;=</cite>, <cite>:=</cite>, <cite>=&gt;</cite>, ...)</p>
</dd>
<dt><em>Align colons in declarations</em></dt>
<dd><p class="first last">Whether the editor should automatically align colons in declarations and
parameter lists. Note that the alignment is computed by taking into
account the current buffer up to the current line (or end of the current
selection), so if declarations continue after the current line, you can
select the declarations lines and hit the reformat key.</p>
</dd>
<dt><em>Align associations on arrows</em></dt>
<dd><p class="first last">Whether the editor should automatically align arrows in associations
(e.g. aggregates or function calls). See also previous preference.</p>
</dd>
</dl>
</div></blockquote>
<dl class="last docutils">
<dt><em>Align declarations after colon</em></dt>
<dd><blockquote class="first">
<div><p>Whether the editor should align continuation lines in variable
declarations based on the colon character.</p>
<p>Consider the following code:</p>
<div class="highlight-ada"><div class="highlight"><pre><span class="no">Variable</span> <span class="p">:</span> <span class="kr">constant</span> <span class="kt">String</span> <span class="p">:=</span>
  <span class="s">&quot;a string&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>If this preference is enabled, it will be indented as follows:</p>
<div class="highlight-ada"><div class="highlight"><pre><span class="no">Variable</span> <span class="p">:</span> <span class="kr">constant</span> <span class="kt">String</span> <span class="p">:=</span>
             <span class="s">&quot;a string&quot;</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<dl class="last docutils">
<dt><em>Indent comments</em></dt>
<dd><p class="first last">Whether to indent lines containing only comments and blanks, or to keep
these lines unchanged.</p>
</dd>
<dt><em>Align comments on keywords</em></dt>
<dd><p class="first">Whether to align comment lines following <cite>record</cite> and
<cite>is</cite> keywords immediately with no extra space.</p>
<p>When enabled, the following code will be indented as:</p>
<div class="highlight-ada"><pre>package P is
--  Comment

   [...]
end P;</pre>
</div>
<p>When disabled, the indentation will be:</p>
<div class="last highlight-ada"><pre>package P is
   --  Comment

   [...]
end P;</pre>
</div>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt><em>C &amp; C++</em></dt>
<dd><span class="target" id="index-57"></span><dl class="first last docutils" id="index-58">
<dt><em>Auto indentation</em></dt>
<dd><p class="first last" id="index-59">How the editor should indent C/C++ sources.  None means no indentation;
Simple means that indentation from the previous line is used for the next
line; Extended means that a language specific parser is used for
indenting sources.</p>
</dd>
<dt><em>Use tabulations</em></dt>
<dd><p class="first last" id="index-60">Whether the editor should use tabulations when indenting. If True, the
editor will replace each occurrence of eight characters by a tabulation
character.</p>
</dd>
<dt><em>Default indentation</em></dt>
<dd><p class="first last" id="index-61">The number of spaces for the default indentation.</p>
</dd>
<dt><em>Extra indentation</em></dt>
<dd><p class="first" id="index-62">Whether to indent loops, if and switch statements an extra level.
if this preference is enabled, the following layout will be chosen:</p>
<div class="highlight-ada"><pre>if (condition)
  {
    int x;
  }</pre>
</div>
<p>If disabled, the same code will be indented as:</p>
<div class="last highlight-ada"><pre>if (condition)
{
  int x;
}</pre>
</div>
</dd>
<dt><em>Indent comments</em></dt>
<dd><p class="first last">Whether to indent lines containing only comments and blanks, or to keep
these lines unchanged.</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><p class="first"><strong>Debugger</strong>
.. index:: debugger</p>
<dl class="docutils">
<dt><em>Preserve State on Exit</em></dt>
<dd><p class="first" id="index-63">If this preference is enabled, the debugger will automatically save
breakpoints when it exists, and restore them the next time the same
executable is debugged.  This is a convenient way to work on an executable,
where the typical usage looks like compile, debug, compile, debug, ...</p>
<p class="last">When the preference is enabled, the debugger will also preserve the
contents of the data window whenever it is closed. Reopening the window
either during the same debugger session, or automatically when a new
debugger is started on the same executable, will recreate the same boxes
within the data window.</p>
</dd>
<dt><em>Debugger Windows</em></dt>
<dd><blockquote class="first">
<div><p id="index-64">This preference controls what happens to debugger-related windows, like the
call stack, the data window, the tasks view,..., when the debugger is
terminated. There are three possible behavior:</p>
<dl class="docutils">
<dt><em>Close Windows</em></dt>
<dd><p class="first last">In this case, all these windows are closed. This saves memory and space
on the screen, but you will need to explicitly reopen them and put them
in the right location on the desktop the next time you start a debugger
session.</p>
</dd>
</dl>
</div></blockquote>
<dl class="last docutils">
<dt><em>Keep Windows</em></dt>
<dd><p class="first last">In this case, the windows are cleared, but kept on the desktop. When you
start a new debugger session, the windows will be automatically reused.
This ensures that you won&#8217;t have to reopen and reposition them, but takes
space on your screen</p>
</dd>
<dt><em>Hide Windows</em></dt>
<dd><p class="first last">The windows are cleared, and hidden. When you start a new debugger
session, they are automatically made visible again and reused. This also
ensures you will not have to reopen and reposition them, but requires a
bit of memory.  If you move some windows around while these windows are
hidden, they might reappear in unexpected location the next time,
although you then just have to move them.</p>
</dd>
</dl>
</dd>
<dt><em>Break on exceptions</em></dt>
<dd><span class="target" id="index-65"></span><p class="first last" id="index-66">Specifies whether a breakpoint on all exceptions should be set by default
when loading a program. This setup is only taken into account when a new
debugger is initialized, and will not modify a running debugger (use the
breakpoint editor for running debuggers).</p>
</dd>
<dt><em>Execution window</em></dt>
<dd><span class="target" id="index-67"></span><p class="first" id="index-68">Specifies whether the debugger should create a separate execution
window for the program being debugged.</p>
<p>Note that this preference cannot be taken into account for the current
debug session: you need to terminate the current debug session and restart
a new one.</p>
<p>If true, a separate console will be created. Under Unix systems, this
console is another window in the bottom part of the main window; under
Windows, this is a separate window created by the underlying gdb, since
Windows does not have the notion of separate terminals (aka ttys).</p>
<p>Note that in this mode under Windows, the <cite>Debug-&gt;Interrupt</cite> menu will only
interrupt the debugged program with recent versions of gdb.  If you are
using older versions of gdb, you need to hit <tt class="kbd docutils literal"><span class="pre">Ctrl-C</span></tt> in the separate
execution window to interrupt it while it is running. Note also that this
separate execution window uses the default system-wide console properties
(the size of the window, the colors...). It is possible to change those
properties using e.g. the default console menu (top-left of the console) on
Windows XP.</p>
<p class="last">If false, no execution window will be created. The debugger assumes that
the program being debugged does not require input, or that if it does,
input is handled outside GPS. For example, when you attach to a running
process, this process already has a separate associated terminal.</p>
</dd>
<dt><em>Show lines with code</em></dt>
<dd><p class="first last">Specifies whether the source editor should display blue dots for lines that
contain code. If set to <em>False</em>, gray dots will be displayed instead on
each line, allowing breakpoint on any line. Disabling this option provides
a faster feedback, since GPS does not need to query the debugger about
which lines contain code.</p>
</dd>
<dt><em>Detect aliases</em></dt>
<dd><p class="first last" id="index-69">If enabled, do not create new items when an item with the same address is
already present on the canvas.</p>
</dd>
<dt><em>Assembly range size</em></dt>
<dd><p class="first last" id="index-70">Number of assembly lines to display in the initial display of the assembly
window. If the size is 0, then the whole subprogram is displayed, but this
can take a very long time on slow machines.</p>
</dd>
<dt><em>Current assembly line</em></dt>
<dd><p class="first last">Color used to highlight the assembly code for the current line.</p>
</dd>
<dt><em>Color highlighting</em></dt>
<dd><p class="first last" id="index-71">Color used for highlighting in the debugger console.</p>
</dd>
<dt><em>Clickable item</em></dt>
<dd><p class="first last">Indicates color to be used for the items that are click-able (e.g pointers).</p>
</dd>
<dt><em>Changed data</em></dt>
<dd><p class="first last">Indicates color to be used to highlight fields in the data window that have
changed since the last update.</p>
</dd>
<dt><em>Memory color</em></dt>
<dd><p class="first last">Color used by default in the memory view window.</p>
</dd>
<dt><em>Memory highlighting</em></dt>
<dd><p class="first last">Color used for highlighted items in the memory view.</p>
</dd>
<dt><em>Memory selection</em></dt>
<dd><p class="first last">Color used for selected items in the memory view.</p>
</dd>
<dt><em>Item name</em></dt>
<dd><p class="first last">Indicates the font to be used for the name of the item in the data window.</p>
</dd>
<dt><em>Item type</em></dt>
<dd><p class="first last">Indicates font to be used to display the type of the item in the data
window.</p>
</dd>
<dt><em>Max item width</em></dt>
<dd><p class="first last">The maximum width an item can have.</p>
</dd>
<dt><em>Max item height</em></dt>
<dd><p class="first last">The maximum height an item can have.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>External Commands</strong>
.. index:: helper
.. index:: external commands</p>
<dl class="docutils">
<dt><em>List processes</em></dt>
<dd><p class="first last">Command used to list processes running on the machine.</p>
</dd>
<dt><em>Remote shell</em></dt>
<dd><p class="first last" id="index-72">Program used to run a process on a remote machine. You can specify
arguments, e.g. <cite>rsh -l user</cite></p>
</dd>
<dt><em>Remote copy</em></dt>
<dd><p class="first last" id="index-73">Program used to copy a file from a remote machine. You can specify
arguments, e.g. <cite>rcp -l user</cite></p>
</dd>
<dt><em>Execute command</em></dt>
<dd><p class="first last" id="index-74">Program used to execute commands externally.</p>
</dd>
<dt><em>HTML Browser</em></dt>
<dd><p class="first last" id="index-75">Only used under Unix, not relevant under Windows where the default HTML
browser is used.  Program used to execute view HTML files, for instance the
documentation.  Empty by default, which means that GPS will try to find a
suitable HTML browser automatically. Only change the value if GPS cannot
find a HTML browser, or if the browser found is not your preferred one.</p>
</dd>
<dt><em>Print command</em></dt>
<dd><span class="target" id="index-76"></span><span class="target" id="index-77"></span><p class="first" id="print-command"><span id="index-78"></span>External program used to print files.</p>
<p>This program is required under Unix systems in order to print, and is set
to <cite>a2ps</cite> by default.  If <cite>a2ps</cite> is not installed on your system, you can
download it from <a class="reference external" href="ftp://ftp.enst.fr/pub/unix/a2ps/">ftp://ftp.enst.fr/pub/unix/a2ps/</a>, although other printing programs such
as <cite>lp</cite> can be specified instead.</p>
<p class="last">Under Windows systems, this program is optional and is empty by default,
since a built-in printing is provided. An external tool will be used if
specified, such as the PrintFile freeware utility available from
<a class="reference external" href="http://www.lerup.com/printfile/descr.html">http://www.lerup.com/printfile/descr.html</a></p>
</dd>
</dl>
</li>
<li><p class="first"><strong>Search</strong>
.. index:: search</p>
<dl class="docutils">
<dt><em>Confirmation for &#8220;Replace all&#8221;</em></dt>
<dd><p class="first last" id="index-79">Enable or disable the confirmation popup for the replace all action.</p>
</dd>
<dt><em>Close on Match</em></dt>
<dd><p class="first last" id="index-80">If this option is enabled, the search window will be closed when a match is
found.</p>
</dd>
<dt><em>Select on Match</em></dt>
<dd><p class="first last" id="index-81">If this option is enabled, the focus will be given to the editor when a
match is found.</p>
</dd>
<dt><em>Preserve Search Context</em></dt>
<dd><p class="first last" id="index-82">If this option is enabled, the contents of the &#8220;Look in:&#8221; field will be
preserved between consecutive searches in files.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>Browsers</strong>
.. index:: browsers</p>
<p><em>General</em></p>
<blockquote>
<div><dl class="docutils">
<dt><em>Selected item color</em></dt>
<dd><p class="first last" id="index-83">Color to use to draw the selected item.</p>
</dd>
<dt><em>Background color</em></dt>
<dd><p class="first last" id="index-84">Color used to draw the background of the browsers.</p>
</dd>
<dt><em>Hyper link color</em></dt>
<dd><p class="first last" id="index-85">Color used to draw the hyper links in the items.</p>
</dd>
<dt><em>Selected link color</em></dt>
<dd><p class="first last" id="index-86">Color to use for links between selected items.</p>
</dd>
<dt><em>Default link color</em></dt>
<dd><p class="first last" id="index-87">Color used to draw the links between unselected items.</p>
</dd>
<dt><em>Ancestor items color</em></dt>
<dd><p class="first last" id="index-88">Color to use for the background of the items linked to the selected item.</p>
</dd>
<dt><em>Offspring items color</em></dt>
<dd><p class="first last" id="index-89">Color to use for the background of the items linked from the selected
item.</p>
</dd>
<dt><em>Vertical layout</em></dt>
<dd><p class="first last" id="index-90">Whether the layout of the graph should be vertical (<em>True</em>) or
horizontal (<em>False</em>). This setting applies to most browsers (call graph
for instance), but does not apply to the entities browsers.</p>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><strong>VCS</strong>
.. index:: vcs</p>
<dl class="docutils">
<dt><em>Implicit status</em></dt>
<dd><p class="first last" id="index-91">Whether a status action can be launched as part of another action. For
example to get the revision numbers of new files after an update
command. If the network connection with the repository is slow
disabling this command can speed-up the VCS actions.</p>
</dd>
<dt><em>Default VCS</em></dt>
<dd><p class="first last" id="index-92">The default VCS to use when the project does not define a VCS.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>Visual diff</strong>
.. index:: visual diff
.. index:: file comparison</p>
<p>Note that in order to perform visual comparison between files, GPS needs to
call external tool (not distributed with GPS) such as <em>diff</em> or <em>patch</em>.
These tools are usually found on most unix systems, and may not be available
by default on other OSes. Under Windows, you can download them from one of
the unix toolsets available, such as msys (<a class="reference external" href="http://www.mingw.org">http://www.mingw.org</a>) or cygwin (<a class="reference external" href="http://www.cygwin.com">http://www.cygwin.com</a>).</p>
<dl class="docutils">
<dt><em>mode</em></dt>
<dd><p class="first" id="index-93">How GPS displays visual diffs between two files:</p>
<dl class="last docutils">
<dt><em>Side_By_Side</em></dt>
<dd><p class="first last">Editors are displayed side-by-side; new editors are created as needed</p>
</dd>
<dt><em>Unified</em></dt>
<dd><p class="first last">No new editor is created, and changes are displayed directly in the
reference editor.</p>
</dd>
</dl>
</dd>
<dt><em>Diff command</em></dt>
<dd><span class="target" id="index-94"></span><p class="first" id="index-95">Command used to compute differences between two files.  Arguments can also
be specified. The visual diff expects a standard diff output with no
context (that is, no <cite>-c</cite> nor <cite>-u</cite> switch).  Arguments of interest may
include (this will depend on the version of diff used):</p>
<dl class="last docutils">
<dt><em>-b</em></dt>
<dd><p class="first last">Ignore changes in amount of white space.</p>
</dd>
<dt><em>-B</em></dt>
<dd><p class="first last">Ignore changes that just insert or delete blank lines.</p>
</dd>
<dt><em>-i</em></dt>
<dd><p class="first last">Ignore changes in case; consider upper and lower case letters equivalent.</p>
</dd>
<dt><em>-w</em></dt>
<dd><p class="first last">Ignore white space when comparing lines.</p>
</dd>
</dl>
</dd>
<dt><em>Patch command</em></dt>
<dd><p class="first" id="index-96">Command used to apply a patch. Arguments can also be specified.
This command is used internally by GPS to perform the visual comparison on
versioned files (e.g. when performing a comparison with a version control
system).</p>
<p class="last">This command should be compatible with the <em>GNU patch</em> utility.</p>
</dd>
<dt><em>Use old diff</em></dt>
<dd><p class="first last" id="index-97">Use the old version of the visual comparison.</p>
</dd>
<dt><em>Diff3 command</em></dt>
<dd><p class="first last" id="index-98">This item is only displayed if the preference <em>Use old diff</em> is disabled.
Command used to query a 3-way diff. See <em>Diff command</em> for a description
of the parameters.</p>
</dd>
<dt><em>Default color</em></dt>
<dd><p class="first last">This item is only displayed if the preference <em>Use old diff</em> is disabled.
The color used to indicate lines on which there is a difference, in the
&#8220;reference&#8221; editor.</p>
</dd>
<dt><em>Old color</em></dt>
<dd><p class="first last">This item is only displayed if the preference <em>Use old diff</em> is disabled.
The color used to indicate spaces used by lines not present in one of the
editors in a 3-way diff and present in the other editors.</p>
</dd>
<dt><em>Append color</em></dt>
<dd><p class="first last">This item is only displayed if the preference <em>Use old diff</em> is disabled.
The color used to display the lines that are present in an editor but not
in the reference editor.</p>
</dd>
<dt><em>Remove color</em></dt>
<dd><p class="first last">This item is only displayed if the preference <em>Use old diff</em> is disabled.
The color used to display the lines that are present in the reference editor
but not in other editors.</p>
</dd>
<dt><em>Change color</em></dt>
<dd><p class="first last">This item is only displayed if the preference <em>Use old diff</em> is disabled.
The color used to display the lines that have changed between the reference
editor and the other editors.</p>
</dd>
<dt><em>Fine change color</em></dt>
<dd><p class="first last">This item is only displayed if the preference <em>Use old diff</em> is disabled.
The color used to highlight fine differences within a modified line.</p>
</dd>
<dt><em>Context length</em></dt>
<dd><p class="first last" id="index-99">This item is only displayed if the preference <em>Use old diff</em> is enabled.
The number of lines displayed before and after each chunk of differences.
Specifying -1 will display the whole file.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>Messages</strong>
.. index:: messages</p>
<dl class="docutils">
<dt><em>Color highlighting</em></dt>
<dd><p class="first last" id="index-100">Color used to highlight text in the messages window.</p>
</dd>
<dt><em>Errors highlighting</em></dt>
<dd><p class="first last" id="index-101">Color used to highlight lines causing compilation errors, in the
source editors. When this color is set to white, the errors are
not highlighted. (<a class="reference internal" href="compilation.html#compilation-build"><em>Compilation/Build</em></a>)</p>
</dd>
<dt><em>Warnings highlighting</em></dt>
<dd><p class="first last" id="index-102">Color used to highlight lines causing compilation warnings, in the
source editors. When this color is set to white, the warnings are
not highlighted.</p>
</dd>
<dt><em>Style errors highlighting</em></dt>
<dd><p class="first last" id="index-103">Color used to highlight lines containing style errors, in the
source editors. When this color is set to white, the errors are
not highlighted.</p>
</dd>
<dt><em>Compiler info highlighting</em></dt>
<dd><p class="first last" id="index-104">Color used to highlight lines containing compiler information, in the
source editors. When this color is set to white, the information is
not highlighted.</p>
</dd>
<dt><em>File pattern</em></dt>
<dd><span class="target" id="index-105"></span><p class="first last" id="index-106">Pattern used to detect file locations and the type of the output from the
messages window.  This is particularly useful when using an external tool
such as a compiler or a search tool, so that GPS will highlight and allow
navigation through source locations. This is a standard system V regular
expression containing from two to five parenthesized subexpressions
corresponding to the file, line, column, warnings or style error patterns.</p>
</dd>
<dt><em>File index</em></dt>
<dd><p class="first last" id="index-107">Index of filename in the file pattern.</p>
</dd>
<dt><em>Line index</em></dt>
<dd><p class="first last" id="index-108">Index of the line number in the file pattern.</p>
</dd>
<dt><em>Column index</em></dt>
<dd><p class="first last" id="index-109">Index of the column number in the file pattern.</p>
</dd>
<dt><em>Warning index</em></dt>
<dd><p class="first last" id="index-110">Index of the warning identifier in the file pattern.</p>
</dd>
<dt><em>Style index</em></dt>
<dd><p class="first last" id="index-111">Index of the style error identifier in the file pattern.</p>
</dd>
<dt><em>Info index</em></dt>
<dd><p class="first last" id="index-112">Index of the compiler info identifier in the file pattern.</p>
</dd>
<dt><em>Secondary File pattern</em></dt>
<dd><span class="target" id="index-113"></span><p class="first last" id="index-114">Pattern used to detect additional file locations from the messages window.
This is a standard system V regular expression containing from two to three
parenthesized subexpressions corresponding to the file, line, and column
patterns.</p>
</dd>
<dt><em>Secondary File index</em></dt>
<dd><p class="first last" id="index-115">Index of filename in the file pattern.</p>
</dd>
<dt><em>Secondary Line index</em></dt>
<dd><p class="first last" id="index-116">Index of the line number in the file pattern.</p>
</dd>
<dt><em>Secondary Column index</em></dt>
<dd><p class="first last" id="index-117">Index of the column number in the file pattern.</p>
</dd>
<dt><em>Alternate Secondary File pattern</em></dt>
<dd><p class="first last" id="index-118">Pattern used to detect additional file locations in alternate form from the
messages window.  This is a standard system V regular expression containing
one parenthesized subexpressions corresponding to the line patterns.</p>
</dd>
<dt><em>Alternate Secondary Line index</em></dt>
<dd><p class="first last" id="index-119">Index of the line number in the file pattern.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>Project</strong></p>
<dl class="docutils">
<dt><em>Relative project paths</em></dt>
<dd><p class="first last" id="index-120">Whether paths should be absolute or relative when the projects are modified.</p>
</dd>
<dt><em>Fast Project Loading</em></dt>
<dd><p class="first" id="index-121">If the project respects a number of restrictions, activating the preference
will provide major speed up when GPS parses the project. This is especially
noticeable if the source files are on a network drive.</p>
<p>GPS assumes that the following restricitions are true when the preference
is activated. If this isn&#8217;t the case, no error is reported, and only minor
drawacks will be visible in GPS (no detection that two files are the same
if one of them is a symbolic link for instance, although GPS will still
warn you if you are trying to overwrite a file modified on the disk).</p>
<p>The restrictions are the following:</p>
<dl class="last docutils">
<dt><em>Symbolic links shouldn&#8217;t be used in the project.</em></dt>
<dd><p class="first last">More precisely, you can only have symbolic links that point to files
outside of the project, but not to another file in the project</p>
</dd>
<dt><em>Directories can&#8217;t have source names.</em></dt>
<dd><p class="first last">No directory name should match the naming scheme defined in the
project. For instance, if you are using the default GNAT naming scheme,
you cannot have directories with names ending with &#8221;.ads&#8221; or &#8221;.adb&#8221;</p>
</dd>
</dl>
</dd>
<dt><em>Load Xref info on project load</em></dt>
<dd><p class="first last" id="index-122">Whether the Xref information should be automatically loaded into memory when
a new project is loaded. <a class="reference internal" href="navigation.html#support-for-cross-references"><em>Support for Cross-References</em></a>.</p>
</dd>
<dt><em>Hidden directories pattern</em></dt>
<dd><p class="first last" id="index-123">A regular expression used to match hidden directories. Such directories
are not displayed by default in the project view, and are not taken into
account for VCS operations working on directories.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>Outline</strong></p>
<dl class="docutils" id="outline-preferences">
<dt><em>Font</em></dt>
<dd><p class="first last">You can choose a specific font for the outline view. Typically, this will
be used to use a slightly smaller font than in the editor, so that you can
see more entities at once on the screen.</p>
</dd>
<dt><em>Show Profiles</em></dt>
<dd><p class="first last">For some of the languages, in particular Ada, GPS can display the profile
(list of parameters) for the subprograms. This can be used to differentiate
between overloaded entities (ie entities with the same name). Disabling
this preference will only show the entity name.</p>
</dd>
<dt><em>Sort alphabetically</em></dt>
<dd><p class="first last">If this preference is activated, the entities will be sorted alphabetically
in the outline view. If disabled, they will be displayed in the order they
are found in the source file.</p>
</dd>
<dt><em>Link with Editor</em></dt>
<dd><p class="first last">If this option is set, the current subprogram will be selected in the
outline view every time the cursor position changes in the current editor.
This option requires some computation for GPS, and you might want to avoid
the slow down by disabling it.</p>
</dd>
<dt><em>Show file name</em></dt>
<dd><p class="first last">If this option is set, the outline view will show the name of the file on
its first line, and indent slightly all following lines. If this option is
unset, this will save some screen real estate, but you will have to look at
the current editor to see what file is descrived in the Outline View.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>Documentation</strong>
.. _Documention_Preferences:</p>
<p>This section specifies preferences that apply to the
<em>Documentation Generator</em>. <a class="reference internal" href="tools.html#documentation-generation"><em>Documentation Generation</em></a> for more
information.</p>
<dl class="docutils">
<dt><em>Process body files</em></dt>
<dd><p class="first last">If this preference is enabled, implementation files will be processed.
Otherwise, only the specification files will.</p>
</dd>
<dt><em>Show private entities</em></dt>
<dd><p class="first last">By default, no documentation is generated for private entities.
Enabling this preference will change this behavior.</p>
</dd>
<dt><em>Call graph</em></dt>
<dd><p class="first last">If enabled, the documentation tool will compute and take advantage of source
references to e.g generate call graph information.
Activating this option will slow down the documentation generation process.</p>
</dd>
<dt><em>Up-to-date files only</em></dt>
<dd><p class="first last">If enabled, only files having up-to-date cross references information will
be documented.</p>
</dd>
<dt><em>Comments filter regexp</em></dt>
<dd><p class="first last">A regular expression used to filter to comments found in the source code
before using them for generating documentation. For example &#8220;^!.*&#8221; will
remove all comments starting with &#8216;!&#8217;.</p>
</dd>
<dt><em>Spawn a browser</em></dt>
<dd><p class="first last">If enabled, a browser is spawned after each documentation generation to view
the generated files. This browser is not spawned if disabled.</p>
</dd>
<dt><em>Find xrefs in comments</em></dt>
<dd><p class="first last">If enabled, GPS will try to find references to entities in comments, and
generate links to them when generating the documentation.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>Coverage Analysis</strong>
.. _Coverage_Analysis_Preferences:</p>
<dl class="docutils">
<dt><em>Coverage toolchain</em></dt>
<dd><p class="first last">Select which coverage toolchain (<cite>gcov</cite> or <cite>xcov</cite>) to use from
the <cite>Tools-&gt;Coverage</cite> menu.</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="gps-themes">
<span id="id3"></span><h2>16.2. GPS Themes<a class="headerlink" href="#gps-themes" title="Permalink to this headline">¶</a></h2>
<p id="index-124">GPS provides an extensive support for themes. Themes are predefined set of
value for the preferences, for the key bindings, or any other configurable
aspect of GPS.</p>
<p>For instance, color themes are a convenient way to change all colors in GPS at
once, according to predefined choices (strongly contrasted colors,
monochrome,...). It is also possible to have key themes, defining a set of key
bindings to emulate e.g. other editors.</p>
<p>Any number of themes can be activated at the same time through the preferences
dialog (<cite>Edit-&gt;Preferences</cite>). This dialog contains a list of all themes that
GPS knows about, organized into categories for convenient handling. Just click
on the buttons on the left of each theme name to activate that theme.</p>
<p>Note that this will immediately change the current preferences settings. For
instance, if the theme you just selected changes the colors in the editor,
these are changed immediately in the <cite>Editor-&gt;Fonts &amp; Colors</cite>. You can of
course still press <cite>Cancel</cite> to keep your previous settings</p>
<p>If multiple themes are active at the same time and try to override the same
preferences, the last theme which is loaded by GPS will override all previously
loaded themes. However, there is no predefined order in which the themes are
loaded.</p>
</div>
<div class="section" id="the-key-manager-dialog">
<span id="id4"></span><h2>16.3. The Key Manager Dialog<a class="headerlink" href="#the-key-manager-dialog" title="Permalink to this headline">¶</a></h2>
<p>The key manager is accessible through the menu <cite>Edit-&gt;Key Shortcuts</cite>.  This
dialog provides an easy way to associate key shortcuts with actions.  These
actions are either predefined in GPS, or defined in your own customization
files, as documented in <a class="reference internal" href="#customizing-through-xml-and-python-files"><em>Customizing through XML and Python files</em></a>.  It
also provides an easy way to redefine the menu shortcuts.</p>
<img alt="_images/key-shortcuts.jpg" id="index-125" src="_images/key-shortcuts.jpg" />
<p>Actions are referenced by their name, and are grouped into categories. These
categories indicate when the action applies. For instance, the indentation
command only applies in source editors, whereas the command to change the
current window applies anywhere in GPS.  The categories can be explicitly
specified when you created your own actions through XML files
(<a class="reference internal" href="#defining-actions"><em>Defining Actions</em></a>).</p>
<p>Through the key manager, you can define key bindings similar to what Emacs uses
(<tt class="kbd docutils literal"><span class="pre">control-x</span></tt> followed by <tt class="kbd docutils literal"><span class="pre">control-k</span></tt> for instance). To register such
key bindings, you need to press the <cite>Grab</cite> button as usual, and then type the
shortcut. The recording of the key binding will stop a short while after the
last key stroke.</p>
<p>If you define complex shortcuts for menus, they will not appear next to the
menu name when you select it with the mouse. This is expected, and is due to
technical limitations in the graphical toolkit that GPS uses.</p>
<p>When you assign a new shortcut to an action, the following happens:</p>
<ul class="simple">
<li>All actions and menus currently associated with the same key will no
longer be executed when the key is pressed.</li>
<li>All key shortcuts defined for this action are replaced by the new one.
As a result, the action is only executable through this new shortcut.</li>
</ul>
</div>
<div class="section" id="the-plug-ins-editor">
<span id="id5"></span><h2>16.4. The Plug-ins Editor<a class="headerlink" href="#the-plug-ins-editor" title="Permalink to this headline">¶</a></h2>
<p id="index-126">GPS can be extensively customized through external plug-ins. You can write your
own plug-ins (<a class="reference internal" href="#customization-files-and-plugins"><em>Customization files and plugins</em></a>), but GPS also comes with
its own collection of plug-ins.</p>
<p>Some of them are loaded by default when GPS starts (for instance the support
for the CVS version management system or support for highlighting in various
programming languages); others are available for any user but not loaded
automatically by GPS, for instance an Emacs emulation mode.</p>
<p>Among the plug-ins that are provided with GPS, you will find:</p>
<ul>
<li><p class="first">Emacs emulation
.. index:: Emacs</p>
<p>Several plug-ins emulate some of the functions provided by Emacs, such as the
interactive search, manipulation of rectangles, navigation in the editor, and
of course the usual Emacs key shortcuts</p>
<p>This emacs mode used to be activated in the preferences dialog, on the Themes
page, but you should now activate it by loading the <tt class="file docutils literal"><span class="pre">emacs.xml</span></tt>
plug-in.</p>
</li>
<li><p class="first">Makefile support
.. index:: Makefile</p>
<p>A plug-in is provided that parses a Makefile and creates menus for each of
its possible targets, so that you can easily start a make command.</p>
</li>
<li><p class="first">Cross-references enhancements</p>
<p>Various plug-ins take advantage of GPS&#8217;s cross-references information to
create additional menus to navigate (for instance to jump to the primitive
operations of Ada tagged types, to the body of Ada separate entities, ...)</p>
</li>
<li><p class="first">Text manipulation</p>
<p>Several plug-ins provide support for advanced text manipulation in the
editors, for instance to be able to align a set of lines based on various
criteria, or to manipulate a rectangular selection of text.</p>
</li>
</ul>
<p>You can choose graphically which plug-ins should or should not be loaded on
startup. To do so, select the menu <cite>/Tools/Plug-ins</cite>.  This brings up a new
window, containing two parts:</p>
<ul>
<li><p class="first">On the left is the list of all known plug-ins.</p>
<p>As described in <a class="reference internal" href="#customization-files-and-plugins"><em>Customization files and plugins</em></a>, GPS will search for
candidates in various directories, and based on these directories decide
whether to automatically load the plug-in or not.</p>
<p>This list indicates the name of the plug-in, and whether it has been loaded
in this GPS session (when the toggle button is checked).</p>
</li>
<li><p class="first">On the right are the details for the selected plug-in.</p>
<p>This window is displayed as a notebook with two pages: on the first one you
will see the exact location of the plug-in, the reason why it was loaded or
not, and, more importantly, the source of the plug-in.  By convention, each
plug-in starts with a general comment that indicates the purpose of this
plug-in, and some more detailed documentation on its usage.</p>
<p>For those interested, this also contains the plug-in itself, so that this can
act as an example to create your own customization script.</p>
<p>Technically, the list of plug-ins to load or not to load are stored in the
file <tt class="file docutils literal"><span class="pre">HOME/.gps/startup.xml</span></tt>.</p>
<p>If you have modified anything through this dialog (the list of plug-ins to
load or unload), you will need to restart GPS. GPS cannot unload a module,
since it can have too many possible effects on GPS (adding menus, overriding
key shortcuts, ...).</p>
<p>A dialog is displayed asking you whether you would like to exit GPS now. This
will properly save all your files.</p>
</li>
</ul>
</div>
<div class="section" id="customizing-through-xml-and-python-files">
<span id="id6"></span><h2>16.5. Customizing through XML and Python files<a class="headerlink" href="#customizing-through-xml-and-python-files" title="Permalink to this headline">¶</a></h2>
<div class="section" id="customization-files-and-plugins">
<span id="index-127"></span><span id="id7"></span><h3>16.5.1. Customization files and plugins<a class="headerlink" href="#customization-files-and-plugins" title="Permalink to this headline">¶</a></h3>
<p>You can customize lots of capabilities in GPS using files that are loaded by
GPS at start up.</p>
<p>For example, you can add items in the menu and tool bars, as well as defining
new key bindings, new languages, new tools, ...; Using Python as a programming
language, you can also add brand new facilities and integrate your own tools in
the GPS platform.</p>
<p>These customization files are searched for at startup in several different
places. Depending on the location where they are found, these files will either
be automatically loaded by GPS (and thus can immediately modify things in GPS),
or will simply be made visible in the Plug-ins Editor
(<a class="reference internal" href="#the-plug-ins-editor"><em>The Plug-ins Editor</em></a>).</p>
<p>These directories are searched for in the order given below. Any script loaded
latter can override setups done by previously loaded scripts. For instance,
they could override a key shortcut, remove a menu, redefine a GPS action, ...</p>
<p>In the directory names below, <tt class="file docutils literal"><span class="pre">INSTALL</span></tt> is the name of the directory in
which you have installed GPS. <tt class="file docutils literal"><span class="pre">HOME</span></tt> is the user&#8217;s home directory, either
by default or as overriden by the <cite>GPS_HOME</cite> environment variable. If none of
these exists, GPS will use the <cite>USERPROFILE</cite> environment variable.</p>
<p>In all these directories, only the files with <tt class="file docutils literal"><span class="pre">.xml</span></tt> or <tt class="file docutils literal"><span class="pre">.py</span></tt>
extensions are taken into account. Other files are ignored, although for
compatibility with future versions of GPS it is recommended not to keep other
files in the same directory.</p>
<ul>
<li><p class="first">Automatically loaded system wide modules</p>
<p>The <tt class="file docutils literal"><span class="pre">INSTALL/share/gps/plug-ins</span></tt> directory should contain the files
that GPS will automatically load by default (unless overriden by the user
through the Plug-ins Editor). These plug-ins are visible to any user on the
system that uses the same GPS installation. This directory should be reserved
for critical plug-ins that almost everyone should use.</p>
</li>
<li><p class="first">Not automatically loaded system wide modules</p>
<p>The <tt class="file docutils literal"><span class="pre">INSTALL/share/gps/library</span></tt> directory should contain the files that
GPS should show in the Plug-ins Editor, but not load automatically.
Typically, these would be files that add optional capabilities to GPS, for
instance an emacs emulation mode, or additional editor capabilities that a
lot of users would not generally use.</p>
</li>
<li><p class="first"><cite>GPS_CUSTOM_PATH</cite></p>
<p>This environment variable can be set before launching GPS. It should contain
a list of directories, separated by semicolons (&#8216;;&#8217;) on Windows systems and
colons (&#8216;:&#8217;) on Unix systems. All the files in these directories with the
appropriate extensions will be automatically loaded by default by GPS, unless
overriden by the user through the Plug-ins Editor.</p>
<p>This is a convenient way to have project-specific customization files. You
can for instance create scripts, or icons, that set the appropriate value for
the variable and then start GPS. Depending on your project, this allows you
to load specific aliases which do not make sense for other projects.</p>
</li>
<li><p class="first">Automatically loaded user directory</p>
<p>The directory <tt class="file docutils literal"><span class="pre">HOME/.gps/plug-ins</span></tt> is searched last. Any script found
in there will be automatically loaded unless overriden in the Plug-ins
Editor.</p>
<p>This is a convenient way for users to create their own plug-ins, or test them
before they are made available to the whole system by copying them to one of
the other directories.</p>
</li>
</ul>
<p>Any script loaded by GPS can contain customization for various aspects of GPS,
mixing aliases, new languages or menus, ... in a single file. This is a
convenient way to distribute your plug-ins to other users.</p>
<div class="section" id="python-files">
<h4>16.5.1.1. Python files<a class="headerlink" href="#python-files" title="Permalink to this headline">¶</a></h4>
<p>Although the format of the python plug-ins is free (as long as it can be
executed by Python), the following organization is suggested. These plug-ins
will be visible in the Plug-ins Editor, and therefore having a common format
makes it easier for users to understand the goal of the plug-ins:</p>
<ul>
<li><p class="first">Comment</p>
<p>The first part of the script should be a general comment on the goal and
usage of the script. This comment should use python&#8217;s triple-quote
convention, rather than start-of-line hash (&#8216;#&#8217;) signs.</p>
<p>The first line of the comment should be a one liner explaining the goal of
the script. It is separated by a blank line from the rest of the comment.</p>
<p>The rest of the comment is free-form.</p>
</li>
<li><p class="first">Customization variables</p>
<p>If your script can be configured by the user by changing some global
variables, they should be listed in their own section, and fully documented.
The user can then, through the /Tools/Plug-ins editor change the value of
these variables</p>
</li>
<li><p class="first">Implementation</p>
<p>The implementation should be separated from the initial comment by a
form-feed (control-L) character. The startup scripts editor will know not to
display the rest of the script on the first page of the editor.</p>
<p>Generally speaking, scripts should avoid executing code as soon as they are
loaded. This gives a chance to the user to change the value of global
variables or even override functions before the script is actually launched.</p>
<p>The solution is to connect to the <cite>&#8220;gps_started&#8221;</cite> hook, as in:</p>
<div class="highlight-ada"><pre>^L
###########################################################
## No user customization below this line
###########################################################

import GPS

def on_gps_started (hook_name):
   ... launch the script

GPS.Hook ("gps_started").add (on_gps_started)</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="xml-files">
<h4>16.5.1.2. XML files<a class="headerlink" href="#xml-files" title="Permalink to this headline">¶</a></h4>
<p>XML files must be utf8-encoded by default. In addition, you can specify any
specific encoding through the standard <cite>&lt;?xml encoding=&#8221;...&#8221; ?&gt;</cite> declaration,
as in the following example:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;</span>
<span class="c">&lt;!--  general description --&gt;</span>
<span class="nt">&lt;submenu&gt;</span>
  <span class="nt">&lt;title&gt;</span>encoded text<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/submenu&gt;</span>
</pre></div>
</div>
<p>These files must be valid XML files, i.e. must start with the <cite>&lt;?xml?&gt;</cite> tag,
and contain a single root XML node, the name of which is left to your
consideration. The general format is therefore:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;root_node&gt;</span>
   ...
<span class="nt">&lt;/root_node&gt;</span>
</pre></div>
</div>
<p>It is also recommended that the first line after the <cite>&lt;?xml?&gt;</cite> tag contains a
general comment describing the purpose and usage of the script.  This comment
will be made visible in the Plug-ins editor.</p>
<p>The list of valid XML nodes that can be specified under &lt;root&gt; is described in
later sections. It includes:</p>
<dl class="docutils">
<dt><em>&lt;action&gt;</em></dt>
<dd>(<a class="reference internal" href="#defining-actions"><em>Defining Actions</em></a>)</dd>
<dt><em>&lt;key&gt;</em></dt>
<dd>(<a class="reference internal" href="#binding-actions-to-keys"><em>Binding actions to keys</em></a>)</dd>
<dt><em>&lt;submenu&gt;</em></dt>
<dd>(<a class="reference internal" href="#adding-new-menus"><em>Adding new menus</em></a>)</dd>
<dt><em>&lt;pref&gt;</em></dt>
<dd>(<a class="reference internal" href="#preferences-support-in-custom-files"><em>Preferences support in custom files</em></a>)</dd>
<dt><em>&lt;preference&gt;</em></dt>
<dd>(<a class="reference internal" href="#preferences-support-in-custom-files"><em>Preferences support in custom files</em></a>)</dd>
<dt><em>&lt;alias&gt;</em></dt>
<dd>(<a class="reference internal" href="#defining-text-aliases"><em>Defining text aliases</em></a>)</dd>
<dt><em>&lt;language&gt;</em></dt>
<dd>(<a class="reference internal" href="#adding-support-for-new-languages"><em>Adding support for new languages</em></a>)</dd>
<dt><em>&lt;button&gt;</em></dt>
<dd>(<a class="reference internal" href="#adding-tool-bar-buttons"><em>Adding tool bar buttons</em></a>)</dd>
<dt><em>&lt;entry&gt;</em></dt>
<dd>(<a class="reference internal" href="#adding-tool-bar-buttons"><em>Adding tool bar buttons</em></a>)</dd>
<dt><em>&lt;vsearch-pattern&gt;</em></dt>
<dd>(<a class="reference internal" href="#defining-new-search-patterns"><em>Defining new search patterns</em></a>)</dd>
<dt><em>&lt;tool&gt;</em></dt>
<dd>(<a class="reference internal" href="#adding-support-for-new-tools"><em>Adding support for new tools</em></a>)</dd>
<dt><em>&lt;filter&gt;</em></dt>
<dd>(<a class="reference internal" href="#filtering-actions"><em>Filtering actions</em></a>)</dd>
<dt><em>&lt;contextual&gt;</em></dt>
<dd>(<a class="reference internal" href="#adding-contextual-menus"><em>Adding contextual menus</em></a>)</dd>
<dt><em>&lt;case_exceptions&gt;</em></dt>
<dd>(<a class="reference internal" href="#adding-casing-exceptions"><em>Adding casing exceptions</em></a>)</dd>
<dt><em>&lt;documentation_file&gt;</em></dt>
<dd>(<a class="reference internal" href="#adding-documentation"><em>Adding documentation</em></a>)</dd>
<dt><em>&lt;doc_path&gt;</em></dt>
<dd>(<a class="reference internal" href="#adding-documentation"><em>Adding documentation</em></a>)</dd>
<dt><em>&lt;stock&gt;</em></dt>
<dd>(<a class="reference internal" href="#adding-stock-icons"><em>Adding stock icons</em></a>)</dd>
<dt><em>&lt;project_attribute&gt;</em></dt>
<dd>(<a class="reference internal" href="#defining-project-attributes"><em>Defining project attributes</em></a>)</dd>
<dt><em>&lt;remote_machine_descriptor&gt;</em></dt>
<dd>(<a class="reference internal" href="#defining-a-remote-server"><em>Defining a remote server</em></a>)</dd>
<dt><em>&lt;remote_path_config&gt;</em></dt>
<dd>(<a class="reference internal" href="#defining-a-remote-path-translation"><em>Defining a remote path translation</em></a>)</dd>
<dt><em>&lt;remote_connection_config&gt;</em></dt>
<dd>(<a class="reference internal" href="#defining-a-remote-connection-tool"><em>Defining a remote connection tool</em></a>)</dd>
<dt><em>&lt;rsync_configuration&gt;</em></dt>
<dd>(<a class="reference internal" href="#configuring-rsync-usage"><em>Configuring rsync usage</em></a>)</dd>
</dl>
</div>
</div>
<div class="section" id="defining-actions">
<span id="id8"></span><h3>16.5.2. Defining Actions<a class="headerlink" href="#defining-actions" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-128"></span><span class="target" id="index-129"></span><span class="target" id="index-130"></span><span class="target" id="index-131"></span><p id="index-132">This facility distinguishes the actions from their associated menus or key
bindings. Actions can take several forms: external commands, shell commands and
predefined commands, as will be explained in more details below.</p>
<p>The general form to define new actions is to use the <cite>&lt;action&gt;</cite> tag.  This tag
accepts the following attributes:</p>
<dl class="docutils">
<dt><em>name   (mandatory)</em></dt>
<dd>This tag must be specified. It provides the name by which the action is
referenced in other parts of the customization files, for instance when it is
associated with a menu or a toolbar button. The name can contain any
character, although it is recommended to avoid XML special characters. It
mustn&#8217;t start with a &#8216;/&#8217;.</dd>
<dt><em>output  (optional)</em></dt>
<dd>If specified, this attribute indicates where the output of the commands will
be sent by default. This can be overridden by each command, using the same
attribute for <cite>&lt;shell&gt;</cite> and <cite>&lt;external&gt;</cite> tags,
<a class="reference internal" href="#redirecting-the-command-output"><em>Redirecting the command output</em></a>.</dd>
<dt><em>show-command (optional, default true)</em></dt>
<dd>If specified, this attribute indicates whether the text of the command itself
should be displayed at the same location as its output. Neither will be
displayed if the output is hidden. The default is to show the command along
with its output.  This attribute can be overridden for each command.</dd>
<dt><em>show-task-manager (optional, default false)</em></dt>
<dd>This attribute indicates whether an entry should be created in the task
manager to show this command. Associated with this entry is the progress
bar indicator, so if you hide the entry, no progress will be shown. On the
other hand, several progress bars might be displayed for your action if you
show the progress bar here, which might be an issue depending on the
context.
This attribute can be overriden for each external command.</dd>
<dt><em>category (optional, default &#8220;General&#8221;)</em></dt>
<dd>The category in the keybindings editor (menu <cite>Edit/Key bindings</cite>) in which
the action should be shown to the user. If you specify an empty string, the
action is considered as an implementation detail, and not displayed in the
editor. The user will thus not be able to assign it a keybinding through the
graphical user interface (although this is still doable through XML commands).</dd>
</dl>
<p>If you are defining the same action multiple times, the last definition will be
kept. However, existing menus, buttons, ... that already reference that action
will keep their existing semantic. The new definition will only be used for all
new menus created from that point on.</p>
<p>The <cite>&lt;action&gt;</cite> can have one or several children, all of which define a
particular command to execute. All of these commands are executed one after the
other, unless one of them fails in which case the following commands are not
executed.</p>
<p>The following XML tags are valid children for <cite>&lt;action&gt;</cite>.</p>
<dl class="docutils" id="index-133">
<dt><em>&lt;external&gt;</em></dt>
<dd><p class="first">This defines a command to execute through the system (i.e. a standard Unix or
Windows command)</p>
<p>Note for Windows users: like under UNIX, scripts can be called from custom
menu. In order to do that, you need to write your script in a <tt class="file docutils literal"><span class="pre">.bat</span></tt> or
<tt class="file docutils literal"><span class="pre">.cmd</span></tt> file, and call this file as usual.  The <cite>external</cite> tag would
e.g. look like:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;external_example&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;my_command&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;external&gt;</span>c:\\.gps\\my_scripts\\my_cmd.cmd<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/external_example&gt;</span>
</pre></div>
</div>
<p>This tag accepts the following attributes:</p>
<dl class="last docutils">
<dt><em>server (optional)</em></dt>
<dd>This attribute can be used to execute the external command on a remote
server. The accepted values are <cite>&#8220;gps_server&#8221;</cite> (default), <cite>&#8220;build_server&#8221;</cite>,
<cite>&#8220;execution_server&#8221;</cite>, <cite>&#8220;debug_server&#8221;</cite> and <cite>&#8220;tools_server&#8221;</cite>.
<a class="reference internal" href="remote.html#remote-operations"><em>Remote operations</em></a>, for explanation of what these servers are.</dd>
<dt><em>check-password (optional)</em></dt>
<dd><p class="first last" id="index-134">This attribute can be used to tell GPS to check and handle password prompts
from the external command. The accepted values are <cite>&#8220;false&#8221;</cite> (default) and
<cite>&#8220;true&#8221;</cite>.</p>
</dd>
<dt><em>show-command (optional)</em></dt>
<dd>This attribute can be used to override the homonym attribute specified for
the <cite>&lt;action&gt;</cite> tag.</dd>
<dt><em>output (optional)</em></dt>
<dd>This attribute can be used to override the homonym attribute specified for
the <cite>&lt;action&gt;</cite> tag.</dd>
<dt><em>progress-regexp (optional)</em></dt>
<dd><p class="first">This attribute specifies a regular expression that the output of the
command will be checked against. Every time the regular expression matches,
it should provide two numeric values that are used to display the usual
progress indicators at the bottom-right corner of the GPS window, as
happens during regular compilations.</p>
<p>The name of the action is printed in the progress bar while the action is
executing:</p>
<div class="last highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;progress_action&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;progress&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;external</span>
      <span class="na">progress-regexp=</span><span class="s">&quot;(\\d+) out of (\\d+).*$&quot;</span>
      <span class="na">progress-current=</span><span class="s">&quot;1&quot;</span>
      <span class="na">progress-final=</span><span class="s">&quot;2&quot;</span>
      <span class="na">progress-hide=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>gnatmake foo.adb
    <span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/progress_action&gt;</span>
</pre></div>
</div>
</dd>
<dt><em>progress-current (optional, default is 1)</em></dt>
<dd>This is the opening parenthesis count index in <cite>progress-regexp</cite>
that contains the current step.</dd>
<dt><em>progress-final   (optional, default is 2)</em></dt>
<dd>This is the opening parenthesis count index in <cite>progress-regexp</cite>
that contains the current last step. This last index can grow as
needed. For example, gnatmake will output the number of
the file it is currently examining, and the total number of files to be
examined. However, that last number may grow up, since parsing a new file
might generate a list of additional files to parse later on.</dd>
<dt><em>progress-hide    (optional, default is true)</em></dt>
<dd>If this attribute is set to the value &#8220;true&#8221;, then all the lines that
match <cite>progress-regexp</cite> and are used to compute the progress will
not be displayed in the output console. For any other value of this
attribute, these lines are displayed along will the rest of the output.</dd>
<dt><em>show-task-manager (optional, default inherited from `&lt;action&gt;`)</em></dt>
<dd><p class="first">This attribute indicates whether an entry should be created in the task
manager to show this command. Associated with this entry is the progress
bar indicator, so if you hide the entry, no progress will be shown. On the
other hand, several progress bars might be displayed for your action if you
show the progress bar here, which might be an issue depending on the
context.</p>
<p class="last">If you have set a value for <cite>progress-regexp</cite>, this will automatically
be set to true by default so that the progress bar is indeed displayed in
the task manager. You can still override it explicitly for that
<cite>&lt;external&gt;</cite> element to force hiding the progress bar.</p>
</dd>
</dl>
</dd>
<dt><em>&lt;on-failure&gt;</em></dt>
<dd><p class="first">This tag specifies a group of command to be executed if the previous
external command fails. Typically, this is used to parse the output of the
command and fill the location window appropriately
(<a class="reference internal" href="#processing-the-tool-output"><em>Processing the tool output</em></a>).</p>
<p>For instance, the following action spawns an external tool, and parses its
output to the location window and the automatic fixing tool if the external
tool happens to fail.</p>
<p>In this group of commands the %... and $... macros can be used
(<a class="reference internal" href="#macro-arguments"><em>Macro arguments</em></a>):</p>
<div class="last highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;action_launch_to_location&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;launch tool to location&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;external&gt;</span>tool-path<span class="nt">&lt;/external&gt;</span>
    <span class="nt">&lt;on-failure&gt;</span>
      <span class="nt">&lt;shell&gt;</span>Locations.parse &quot;%1&quot; category<span class="nt">&lt;shell&gt;</span>
      <span class="nt">&lt;external&gt;</span>echo the error message is &quot;%2&quot;<span class="nt">&lt;/external&gt;</span>
    <span class="nt">&lt;/on-failure&gt;</span>
    <span class="nt">&lt;external&gt;</span>echo the tool succeeded with message %1<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/action_launch_to_location&gt;</span>
</pre></div>
</div>
<span class="target" id="index-136"></span><span class="target" id="index-137"></span></dd>
<dt><em>&lt;shell&gt;</em></dt>
<dd><p class="first">As well as external commands, you can use custom menu items to invoke GPS
commands using the <cite>shell</cite> tag. These are command written in one of the
shell scripts supported by GPS.</p>
<p>This tag supports the same <cite>show-command</cite> and <cite>output</cite> attributes
as the <cite>&lt;action&gt;</cite> tag.</p>
<p>The following example shows how to
create two actions to invoke the <cite>help</cite> interactive command and to open
the file <tt class="file docutils literal"><span class="pre">main.c</span></tt>:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;help&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;help&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell&gt;</span>help<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;edit&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell&gt;</span>edit main.c<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/help&gt;</span>
</pre></div>
</div>
<p>By default, commands are expected to be written in the GPS shell language.
However, you can specify the language through the <cite>lang</cite> attribute. Its
default value is <cite>&#8220;shell&#8221;</cite>.</p>
<p>The value of this attribute could also be &#8220;python&#8221;.</p>
<p>When programming with the GPS shell, you can execute multiple commands by
separating them with semicolons. Therefore, the following example adds a menu
which lists all the files used by the current file, in a project browser:</p>
<div class="last highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;current_file_uses&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;current file uses&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;shell&quot;</span><span class="nt">&gt;</span>File %f<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;shell&quot;</span><span class="nt">&gt;</span>File.uses %1<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/current_file_uses&gt;</span>
</pre></div>
</div>
</dd>
<dt><em>&lt;description&gt;</em></dt>
<dd><p class="first last" id="index-139">This tag contains a description for the command, which is used in the
graphical editor for the key manager. <a class="reference internal" href="#the-key-manager-dialog"><em>The Key Manager Dialog</em></a>.</p>
</dd>
<dt><em>&lt;filter&gt;, &lt;filter_and&gt;, &lt;filter_or&gt;</em></dt>
<dd><p class="first last" id="index-140">This is the context in which the action can be executed,
<a class="reference internal" href="#filtering-actions"><em>Filtering actions</em></a>.</p>
</dd>
</dl>
<p>It is possible to mix both shell commands and external commands. For
instance, the following command opens an xterm (on Unix systems only)
in the current directory, which depends on the context:</p>
<div class="highlight-xml"><pre>&lt;?xml version="1.0" ?&gt;
&lt;xterm_directory&gt;
  &lt;action "xterm in current directory"&gt;
    &lt;shell lang="shell"&gt;cd %d&lt;/shell&gt;
    &lt;external&gt;xterm&lt;/external&gt;
  &lt;/action&gt;
&lt;/xterm_directory&gt;</pre>
</div>
<p>As seen in some of the examples above, some special strings are expanded by GPS
just prior to executing the command. These are the &#8220;%f&#8221;, &#8220;%d&#8221;,.. See below for
a full list.</p>
<p>More information on chaining commands is provided in <a class="reference internal" href="#chaining-commands"><em>Chaining commands</em></a>.</p>
<p>Some actions are also predefined in GPS itself. This include for instance
aliases expansion, manipulating MDI windows, ...; All known actions (predefined
and the ones you have defined in your own customization files) can be
discovered by opening the key shortcut editor (<cite>Edit-&gt;Key shortcuts</cite> menu).</p>
</div>
<div class="section" id="macro-arguments">
<span id="id9"></span><h3>16.5.3. Macro arguments<a class="headerlink" href="#macro-arguments" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-141"></span><span class="target" id="index-142"></span><p id="index-143">When an action is defined, you can use macro arguments to pass to your shell or
external commands. Macro arguments are special parameters that are transformed
every time the command is executed.  The following macro arguments are
provided.</p>
<p>The equivalent python command is given for all tests. These commands are useful
when you are writing a full python script, and want to test for yourself
whether the context is properly defined.</p>
<dl class="docutils">
<dt><em>%a</em></dt>
<dd>If the user clicked within the Locations Window, this is the name of the
category to which the current line belongs</dd>
<dt><em>%builder</em></dt>
<dd>Replaced by the default builder configured in GPS.
This can be e.g. <cite>gnatmake</cite> if your project contains only Ada code,
or <cite>gprbuild</cite> for non Ada or multi-language projects.
Note: this macro is only available in the commands defined in the Build
Manager and the Build Launcher dialogs.</dd>
<dt><em>%c</em></dt>
<dd><p class="first">This is the column number on which the user clicked.
Python equivalent:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">column</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><em>%d</em></dt>
<dd><p class="first">The current directory.
Python equivalent:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">directory</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><em>%dk</em></dt>
<dd>The krunched name of the current directory.</dd>
<dt><em>%e</em></dt>
<dd><p class="first">Name of the entity the user clicked on.
Python equivalent:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">entity</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><em>%E</em></dt>
<dd>The full path to the executable name corresponding to the target.</dd>
<dt><em>%ek</em></dt>
<dd>Krunched name of the entity the user clicked on.
This is the same as <cite>%e</cite>, except long names are shorted as in <cite>%fk</cite>.</dd>
<dt><em>%eL</em></dt>
<dd>Replaced by either an empty string, or <cite>-eL</cite>, depending on whether the <cite>Fast
Project Loading</cite> preference if set or not.  <cite>-eL</cite> is used by GNAT tools to
specify whether symbolink links should be followed or not when parsing
projects.  Note: this macro is only available in the commands defined in the
Build Manager and the Build Launcher dialogs.</dd>
<dt><em>%external</em></dt>
<dd>Replaced by the command line specified in the preference
<em>External Commands-&gt;Execute command</em>.</dd>
<dt><em>%f</em></dt>
<dd><p class="first">Base name of the currently selected file.
Python equivalent:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os.path</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span> <span class="p">(</span><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">file</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
</pre></div>
</div>
</dd>
<dt><em>%F</em></dt>
<dd><p class="first">Absolute name of the currently opened file.
Python equivalent:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">file</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><em>%fk</em></dt>
<dd>Krunched base name of the currently selected file.  This is the same as %f,
except that long names are shortened, and their middle letters are replaced
by &#8220;[...]&#8221;. This should be used in particular in menu labels, to keep the
menus narrow.</dd>
<dt><em>%fp</em></dt>
<dd>Base name of the currently selected file. If the file is not part of the
project tree, or no file is selected, generate an error on the Messages
window.  Note: this macro is only available in the commands defined in the
Build Manager and the Build Launcher dialogs.</dd>
<dt><em>%gnatmake</em></dt>
<dd>Replaced by the gnatmake executable configured in your project file.</dd>
<dt><em>%gprbuild</em></dt>
<dd>Replaced by the gprbuild command line configured in your project file.</dd>
<dt><em>%gprclean</em></dt>
<dd>Replaced by the default cleaner configured in GPS.  This can be e.g. <cite>gnat
clean</cite>, or <cite>gprclean</cite>.  Note: this macro is only available in the commands
defined in the Build Manager and the Build Launcher dialogs.</dd>
<dt><em>%i</em></dt>
<dd>If the user clicked within the Project View, this is the name of the parent
project, ie the one that is importing the one the user clicked on. Note that
with this definition of parent project, a given project might have multiple
parents. The one that is returned is read from the Project View itself.</dd>
<dt><em>%l</em></dt>
<dd><p class="first">This is the line number on which the user clicked.
Python equivalent:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">line</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><em>%o</em></dt>
<dd>The object directory of the current project.</dd>
<dt><em>%O</em></dt>
<dd>The object directory of the root project.</dd>
<dt><em>%p</em></dt>
<dd><p class="first">The current project. This is the name of the project, not the project file,
ie the <tt class="file docutils literal"><span class="pre">.gpr</span></tt> extension is not included in this name, and the casing is
the one found inside the project file, not the one of the file name itself.
If the current context is an editor, this is the name of the project to which
the source file belongs.  Python equivalent:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">project</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><em>%P</em></dt>
<dd><p class="first">The root project. This is the name of the project, not the project file.
Python equivalent:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">root</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><em>%Pb</em></dt>
<dd>The basename of the root project file.</dd>
<dt><em>%Pl</em></dt>
<dd>The name of the root project, all lower case.</dd>
<dt><em>%pp</em></dt>
<dd><p class="first">The current project file pathname. If a file is selected, this is the project
file to which the source file belongs.
Python equivalent:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">project</span><span class="p">()</span><span class="o">.</span><span class="n">file</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><em>%PP</em></dt>
<dd><p class="first">The root project pathname.
Python equivalent:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">root</span><span class="p">()</span><span class="o">.</span><span class="n">file</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><em>%pps</em></dt>
<dd><p class="first">This is similar to <cite>%pp</cite>, except it returns the project name prepended
with <cite>-P</cite>, or an empty string if there is no project file selected and the
current source file doesn&#8217;t belong to any project. This is mostly for use with
the GNAT command line tools. The project name is quoted if it contains spaces.
Python equivalent:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">project</span><span class="p">():</span>
   <span class="k">return</span> <span class="s">&quot;-P&quot;</span> <span class="o">&amp;</span> <span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">project</span><span class="p">()</span><span class="o">.</span><span class="n">file</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><em>%PPs</em></dt>
<dd>This is similar to <cite>%PP</cite>, except it returns the project name prepended
with <cite>-P</cite>, or an empty string if the root project is the default project.
This is mostly for use with the GNAT command line tools.</dd>
<dt><em>%(p|P)[r](d|s)[f]</em></dt>
<dd><p class="first">Substituted by the list of sources or directories of a given project. This
list is a list of space-separated, quoted names (all names are surrounded by
double quotes, for proper handling of spaces in directories or file names).</p>
<dl class="last docutils">
<dt><em>P</em></dt>
<dd>the root project.</dd>
<dt><em>p</em></dt>
<dd>the selected project, or the root project if there is no project selected.</dd>
<dt><em>r</em></dt>
<dd>recurse through the projects: sub projects will be listed as well as their
sub projects, etc...</dd>
<dt><em>d</em></dt>
<dd><p class="first">list the source directories.</p>
<p>Python equivalent:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">project</span><span class="p">()</span><span class="o">.</span><span class="n">source_dirs</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><em>s</em></dt>
<dd><p class="first">list the source files.</p>
<p>Python equivalent:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">project</span><span class="p">()</span><span class="o">.</span><span class="n">sources</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><em>f</em></dt>
<dd>output the list into a file and substitute the parameter with the name of
that file. This file is never deleted by GPS, it is your responsibility to
do so.</dd>
</dl>
</dd>
<dt><em>%s</em></dt>
<dd>This is the text selected by the user, if a single line was selected. When
multiple lines were selected, this returns the empty string</dd>
<dt><em>%S</em></dt>
<dd>This is either the text selected by the user, of the current entity if there
is no selection. If the entity is part of an expression (&#8220;A.B.C&#8221;), then the
whole expression is used instead of the entity name.</dd>
<dt><em>%switches(tool)</em></dt>
<dd><p class="first">Replaced by <cite>IDE&#8217;Default_Switches (tool)</cite>, in other words, if you
have a tool whose switches are defined via an xml file in GPS, they
are stored as <cite>Default_Switches (xxx)</cite> in the <cite>IDE</cite> package
and can be retrieved using this macro. The value returned is a list of
switches, or an empty list if not set.</p>
<p class="last">Note: This macro is only available in the commands defined in the Build
Manager and Build Launcher dialogs.</p>
</dd>
<dt><em>%T</em></dt>
<dd>Replaced by the subtarget being considered for building.  Depending on the
context, this can correspond to e.g. the base filename of a Main source, or
makefile targets.  Note: this macro is only available in the commands defined
in the Build Manager and the Build Launcher dialogs.</dd>
<dt><em>%TT</em></dt>
<dd>Same as <cite>%TT</cite>, but returns the full path to main sources rather than
the base filename.</dd>
<dt><em>%attr(Package&#8217;Name[,default])</em></dt>
<dd><p class="first">Replaced by the project attribute <cite>Package&#8217;Name</cite>, in other words, the
attribute <cite>Name</cite> from the package <cite>Package</cite>. <cite>Package&#8217;</cite> is
optional if <cite>Name</cite> is a top level attribute (e.g. <cite>Object_Dir</cite>).</p>
<p>If the attribute is not defined in the project, an optional <cite>default</cite>
value is returned, or an empty string if not.</p>
<p class="last">Note: This macro is only available in the commands defined in the Build
Manager and Build Launcher dialogs, and only supports single string
attributes, not lists.</p>
</dd>
<dt><em>%dirattr(Package&#8217;Name[,default])</em></dt>
<dd>Replaced by the directory part of an attribute. The attribute is specified
as in <cite>%attr</cite> above.</dd>
<dt><em>%baseattr(Package&#8217;Name[,default])</em></dt>
<dd>Replaced by the base name of an attribute. The attribute is specified
as in <cite>%attr</cite> above.</dd>
<dt><em>%vars</em></dt>
<dd>Replaced by a list of switches of the form <cite>&lt;variable&gt;=&lt;value&gt;</cite>, where
&lt;variable&gt; is the name of a scenario variable and &lt;value&gt; its current value,
as configured in the Scenario View. All the scenario variables defined in the
current project tree will be listed.  Alternatively, you can also use
<cite>%vars(-D)</cite> to generate a list of switches of the form
<cite>-D&lt;variable&gt;=&lt;value&gt;</cite>.  Note: this macro is only available in the commands
defined in the Build Manager and the Build Launcher dialogs.</dd>
<dt><em>%X</em></dt>
<dd>Replaced by a list of switches of the form <cite>-X&lt;variable&gt;=&lt;value&gt;</cite>, where
&lt;variable&gt; is the name of a scenario variable and &lt;value&gt; its current value,
as configured in the Scenario View. All the scenario variables defined in the
current project tree will be listed.  Note: this macro is only available in
the commands defined in the Build Manager and the Build Launcher dialogs.</dd>
<dt><em>%target</em></dt>
<dd>Replaced by <cite>&#8211;target=&lt;t&gt;</cite> where &lt;t&gt; is the build target detected by the
toolchain being used.</dd>
<dt><em>%%</em></dt>
<dd>Replaced by the % sign.</dd>
</dl>
<p id="index-144">Examples:</p>
<dl class="docutils">
<dt><em>%Ps</em></dt>
<dd>Replaced by a list of source files in the root project.</dd>
<dt><em>%prs</em></dt>
<dd>Replaced by a list of files in the current project, and all imported
sub projects, recursively.</dd>
<dt><em>%prdf</em></dt>
<dd>Replaced by the name of a file that contains a list of source
directories in the current project, and all imported sub projects,
recursively.</dd>
</dl>
<p>Another type of macros are expanded before commands are executed: These all
start with the <cite>$</cite> character, and represent parameters passed to the action by
its caller. Depending on the context, GPS will give zero, one or more arguments
to the action. This is in particular used when you define your own VCS system.
See also the shell function <cite>execute_action</cite>, which you can use yourself to
execute an action and pass it some arguments.</p>
<p>These arguments are the following</p>
<dl class="docutils">
<dt><em>$1, $2, ... $n</em></dt>
<dd>Where n is a number. These are each argument passed to the action</dd>
<dt><em>$1-, $2-, ... $n-</em></dt>
<dd>This represents a string concatenating the specified argument and all
arguments after it</dd>
<dt><em>$*</em></dt>
<dd>This represents a string concatenating all arguments passed to the action</dd>
<dt><em>$repeat</em></dt>
<dd><p class="first">This is the number of times the action has been repeated in a row. It will in
general be 1 (ie this is the first execution of the action), unless the user
has first executed the action <cite>&#8220;Repeat Next&#8221;</cite>, which allows automatic
repetition of an action.</p>
<p>By default, when the action &#8220;Repeat Next&#8221; is invoked by the user, it will
repeat the following action as many times as the user specified. However, in
some cases, either for efficiency reasons or simply for technical reasons,
you might want to handle yourself the repeat. This can be done with the
following action declaration:</p>
<div class="highlight-python"><pre>&lt;action name="my_action"&gt;
   &lt;shell lang="python"&gt;if $repeat==1: my_function($remaining + 1)&lt;/shell&gt;
&lt;/action&gt;

def my_function (count):
   """Perform an action count times"""
   ...</pre>
</div>
<p class="last">Basically, the technique here is to only perform something the first time the
action is called (hence the if statement), but pass your shell function the
number of times that it should repeat (hence the <cite>$remaining</cite> parameter).</p>
</dd>
<dt><em>$remaining</em></dt>
<dd>This is similar to $repeat, and indicates the number of times that the action
remains to be executed. This will generally be 0, unless the user has chosen
to automatically repeat the action a number of times.</dd>
</dl>
</div>
<div class="section" id="filtering-actions">
<span id="id10"></span><h3>16.5.4. Filtering actions<a class="headerlink" href="#filtering-actions" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-145"></span><span class="target" id="index-146"></span><p id="index-147">By default, an action will execute in any context in GPS. The user just selects
the menu or key, and GPS tries to execute the action.</p>
<p>It is possible to restrict when an action should be considered as valid. If the
current context is incorrect for the action, GPS will not attempt to run
anything, and will display an error message for the user.</p>
<p>Actions can be restricted in several ways:</p>
<ul>
<li><p class="first">Using macro arguments (<a class="reference internal" href="#macro-arguments"><em>Macro arguments</em></a>).
If you are using one of the macro arguments defined in the previous section,
anywhere in the chain of commands for that action, GPS will first check that
the information is available, and if not will not start running any of the
shell commands or external commands for that action.</p>
<p>For instance, if you have specified <cite>%F</cite> as a parameter to one of the
commands, GPS will check prior to running the action that there is a current
file. This can be either a currently selected file editor, or for instance
that the project view is selected, and a file node inside it is also
selected.</p>
<p>You do not have to specify anything else, this filtering is automatic</p>
<p>Note however that the current context might contain more information than you
expect. For instance, if you click on a file name in the Project View, then
the current context contains a file (thus satisfies <cite>%F</cite>), but also contains
a project (and thus satisfies <cite>%p</cite> and similar macros).</p>
</li>
<li><p class="first">Defining explicit filters
Explicit restrictions can be specified in the customization files. These are
specified through the <cite>&lt;filter&gt;</cite>, <cite>&lt;filter_and&gt;</cite> and <cite>&lt;filter_or&gt;</cite> tags, see
below.</p>
<p>These tags can be used to further restrict when the command is valid. For
instance, you can use them to specify that the command only applies to Ada
files, or only if a source editor is currently selected.</p>
</li>
</ul>
<div class="section" id="the-filters-tags">
<h4>16.5.4.1. The filters tags<a class="headerlink" href="#the-filters-tags" title="Permalink to this headline">¶</a></h4>
<p>Such filters can be defined in one of two places in the customization files:</p>
<ul class="simple">
<li>At the toplevel.
At the same level as other tags such as <cite>&lt;action&gt;</cite>, <cite>&lt;menu&gt;</cite> or
<cite>&lt;button&gt;</cite> tags, you can define named filters. These are general filters,
that can be referenced elsewhere without requiring code duplication.</li>
<li>As a child of the <cite>&lt;action&gt;</cite> tag.
Such filters are anonymous, although they provide exactly the same capabilities
as the ones above. These are mostly meant for simple filters, or filters that
you use only once.</li>
</ul>
<p>There are three different kinds of tags:</p>
<dl class="docutils">
<dt><em>&lt;filter&gt;</em></dt>
<dd>This defines a simple filter. This tag takes no child tag.</dd>
<dt><em>&lt;filter_and&gt;</em></dt>
<dd>All the children of this tag are composed together to form a compound filter.
They are evaluated in turn, and as soon as one of them fails, the whole filter
fails. Children of this tag can be of type <cite>&lt;filter&gt;</cite>, <cite>&lt;filter_and&gt;</cite>
and <cite>&lt;filter_or&gt;</cite>.</dd>
<dt><em>&lt;filter_or&gt;</em></dt>
<dd>All the children of this tag are composed together to form a compound filter.
They are evaluated in turn, and as soon as one of them succeeds, the whole
filter succeeds. Children of this tag can be of type <cite>&lt;filter&gt;</cite>,
<cite>&lt;filter_and&gt;</cite> and <cite>&lt;filter_or&gt;</cite>.</dd>
</dl>
<p>If several such tags are found following one another under an <cite>&lt;action&gt;</cite>
tag, they are combined through &#8220;or&#8221;, i.e. any of the filters may match for the
action to be executed.</p>
<p>The <cite>&lt;filter&gt;</cite>, <cite>&lt;filter_and&gt;</cite> and <cite>&lt;filter_or&gt;</cite> tags accept the
following set of common attributes:</p>
<dl class="docutils">
<dt><em>name       (optional)</em></dt>
<dd>This attribute is used to create named filters, that can be reused elsewhere
in actions or compound filters through the <cite>id</cite> attribute. The name can
take any form.</dd>
<dt><em>error      (optional)</em></dt>
<dd>This is the error message printed in the GPS console if the filter doesn&#8217;t
match, and thus the action cannot be executed. If you are composing filters
through <cite>&lt;filter_and&gt;</cite> and <cite>&lt;filter_or&gt;</cite>, only the error message of
the top-level filter will be printed.</dd>
</dl>
<p>In addition, the <cite>&lt;filter&gt;</cite> has the following specific attributes:</p>
<p><em>id         (optional)</em></p>
<blockquote>
<div><p>If this attribute is specified, all other attributes are ignored. This is used
to reference a named filter previously defined. Here is for instance how you
can make an action depend on a named filter:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;test_filter&gt;</span>
  <span class="nt">&lt;filter</span> <span class="na">name=</span><span class="s">&quot;Test filter&quot;</span> <span class="na">language=</span><span class="s">&quot;ada&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;Test action&quot;</span> <span class="nt">&gt;</span>
     <span class="nt">&lt;filter</span> <span class="na">id=</span><span class="s">&quot;Test filter&quot;</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;shell&gt;</span>pwd<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/test_filter&gt;</span>
</pre></div>
</div>
<p>A number of filters are predefined by GPS itself.</p>
<dl class="docutils">
<dt><em>Source editor</em></dt>
<dd>This filter will only match if the currently selected window in GPS is an
editor.</dd>
<dt><em>Explorer_Project_Node</em></dt>
<dd>Matches when clicking on a project node in the Project View</dd>
<dt><em>Explorer_Directory_Node</em></dt>
<dd>Matches when clicking on a directory node in the Project View</dd>
<dt><em>Explorer_File_Node</em></dt>
<dd>Matches when clicking on a file node in the Project View</dd>
<dt><em>Explorer_Entity_Node</em></dt>
<dd>Matches when clicking on an entity node in the Project View</dd>
<dt><em>File</em></dt>
<dd>Matches when the current context contains a file (for instance the focus is
on a source editor, or the focus is on the Project view and the currently
selected line contains file information).</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt><em>language   (optional)</em></dt>
<dd>This attribute specifies the name of the language that must be associated
with the current file to match. For instance, if you specify <cite>ada</cite>,
you must have an Ada file selected, or the action won&#8217;t execute. The language
for a file is found by GPS following several algorithms (file extensions, and
via the naming scheme defined in the project files).</dd>
<dt><em>shell_cmd  (optional)</em></dt>
<dd><p class="first">This attribute specifies a shell command to execute. The output value of this
command is used to find whether the filter matches: if it returns &#8220;1&#8221; or
&#8220;true&#8221;, the filter matches. In any other case, the filter fails.</p>
<p class="last">Macro arguments (%f, %p, ...) are fully supported in the text of the
command to execute.</p>
</dd>
<dt><em>shell_lang (optional)</em></dt>
<dd>This attribute specifies in which language the shell command above is written.
Its default value indicates that the command is written using the GPS shell.</dd>
<dt><em>module     (optional)</em></dt>
<dd><p class="first">This attribute specifies that the filter only matches if the current window
was setup by this specific GPS module. For instance, if you specify
&#8220;Source_Editor&#8221;, this filter will only match when the active window is a
source editor.</p>
<p>The list of module names can be obtained by typing <cite>lsmod</cite> in the shell
console at the bottom of the GPS window.</p>
<p class="last">This attribute is mostly useful when creating new contextual menus.</p>
</dd>
</dl>
<p>When several attributes are specified for a <cite>&lt;filter&gt;</cite> node (which is not
possible with <cite>id</cite>), they must all match for the action to be executed:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="c">&lt;!-- The following filter will only match if the currently selected</span>
<span class="c">     window is a text editor editing an Ada source file --&gt;</span>
<span class="nt">&lt;ada_editor&gt;</span>
  <span class="nt">&lt;filter_and</span> <span class="na">name=</span><span class="s">&quot;Source editor in Ada&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;filter</span> <span class="na">language=</span><span class="s">&quot;ada&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;filter</span> <span class="na">id=</span><span class="s">&quot;Source editor&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/filter_and&gt;</span>

  <span class="c">&lt;!-- The following action will only be executed for such an editor --&gt;</span>

  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;Test Ada action&quot;</span> <span class="nt">&gt;</span>
     <span class="nt">&lt;filter</span> <span class="na">id=</span><span class="s">&quot;Source editor in Ada&quot;</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;shell&gt;</span>pwd<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>

  <span class="c">&lt;!--  An action with an anonymous filter. It will be executed if the</span>
<span class="c">        selected file is in Ada, even if the file was selected through</span>
<span class="c">        the project view  --&gt;</span>

  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;Test for Ada files&quot;</span> <span class="nt">&gt;</span>
      <span class="nt">&lt;filter</span> <span class="na">language=</span><span class="s">&quot;ada&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;shell&gt;</span>pwd<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/ada_editor&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="adding-new-menus">
<span id="id11"></span><h3>16.5.5. Adding new menus<a class="headerlink" href="#adding-new-menus" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-148"></span><span class="target" id="index-149"></span><span class="target" id="index-150"></span><p id="index-151">These commands can be associated with menus, tool bar buttons and keys. All
of these use similar syntax.</p>
<p>Binding a menu to an action is done through the <cite>&lt;menu&gt;</cite> and
<cite>&lt;submenu&gt;</cite> tags.</p>
<p>The <cite>&lt;menu&gt;</cite> tag takes the following attributes:</p>
<dl class="docutils">
<dt><em>action  (mandatory)</em></dt>
<dd><p class="first">This attribute specifies which action to execute
when the menu is selected by the user. If no action by this name was defined,
no new menu is added. The action name can start with a &#8216;/&#8217;, in which case
it represents the absolute path to a menu to execute instead.</p>
<p>This attribute can be omitted only when no title is specified for the menu
to make it a separator (see below).</p>
<p class="last">If a filter is associated with the action through the <cite>&lt;filter&gt;</cite> tag,
then the menu will be greyed out when the filter doesn&#8217;t match. As a
result, users will not be able to click on it.</p>
</dd>
<dt><em>before  (optional)</em></dt>
<dd>It specifies the name of another menu item before
which the new menu should be inserted. The reference menu must have been
created before, otherwise the new menu is inserted at the end. This attribute
can be used to control where precisely the new menu should be made visible.</dd>
<dt><em>after   (optional)</em></dt>
<dd>This attribute is similar to <cite>before</cite>, but has a lower priority. If it
is specified, and there is no <cite>before</cite> attribute, it specifies a reference
menu after which the new menu should be inserted.</dd>
</dl>
<p>It should also have one XML child called <cite>&lt;title&gt;</cite> which specifies the
label of the menu. This is really a path to a menu, and thus you can define
submenus by specifying something like &#8220;/Parent1/Parent2/Menu&#8221; in the title
to automatically create the parent menus if they don&#8217;t exist yet.</p>
<p>You can define the accelerator keys for your menus, using underscores
in the titles. Thus, if you want an accelerator on the first letter in
a menu named <cite>File</cite>, set its title as <cite>_File</cite>.</p>
<p>The tag <cite>&lt;submenu&gt;</cite> accepts the following attributes:</p>
<dl class="docutils">
<dt><em>before  (optional)</em></dt>
<dd>See description above, same as for <cite>&lt;menu&gt;</cite></dd>
<dt><em>after   (optional)</em></dt>
<dd>See description above, same as for <cite>&lt;menu&gt;</cite></dd>
</dl>
<p>It accepts several children, among <cite>&lt;title&gt;</cite> (which must be specified
at most once), <cite>&lt;submenu&gt;</cite> (for nested menus), and <cite>&lt;menu&gt;</cite>.</p>
<p>Since <cite>&lt;submenu&gt;</cite> doesn&#8217;t accept the <cite>action</cite> attribute, you should
use <cite>&lt;menu&gt;</cite> for clickable items that should result in an action, and
<cite>&lt;submenu&gt;</cite> if you want to define several menus with the same path.</p>
<p>You can specify which menu the new item is added to in one of two ways:</p>
<ul class="simple">
<li>Specify a path in the <cite>title</cite> attribute of <cite>&lt;menu&gt;</cite></li>
<li>Put the <cite>&lt;menu&gt;</cite> as a child of a <cite>&lt;submenu&gt;</cite> node
This requires slightly more typing, but it allows you to specify the exact
location, at each level, of the parent menu (before or after an existing
menu).</li>
</ul>
<p>For example, this adds an item named <cite>mymenu</cite> to the standard
<cite>Edit</cite> menu:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;test&gt;</span>
  <span class="nt">&lt;submenu&gt;</span>
    <span class="nt">&lt;title&gt;</span>Edit<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;current file uses&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;title&gt;</span>mymenu<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/menu&gt;</span>
  <span class="nt">&lt;/submenu&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<p>The following has exactly the same effect:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;test&gt;</span>
  <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;current file uses&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Edit/mymenu<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/menu&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<p>The following adds a new item &#8220;stats&#8221; to the &#8220;unit testing&#8221; submenu
in &#8220;my_tools&#8221;:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;test&gt;</span>
  <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;execute my stats&quot;</span><span class="nt">&gt;</span>
     <span class="nt">&lt;title&gt;</span>/My_Tools/unit testing/stats<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/menu&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<p>The previous syntax is shorter, but less flexible than the following,
where we also force the My_Tools menu, if it doesn&#8217;t exist yet, to
appear after the File menu. This is not doable by using only <cite>&lt;menu&gt;</cite>
tags. We also insert several items in that new menu:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;test&gt;</span>
  <span class="nt">&lt;submenu</span> <span class="na">after=</span><span class="s">&quot;File&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>My_Tools<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;execute my stats&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;title&gt;</span>unit testing/stats<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/menu&gt;</span>
    <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;execute my stats2&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;title&gt;</span>unit testing/stats2<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/menu&gt;</span>
  <span class="nt">&lt;/submenu&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<p id="index-152">Adding an item with an empty title or no title at all inserts a
menu separator. For instance, the following example will insert a separator
followed by a File/Custom menu:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;menus&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;execute my stats&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;submenu&gt;</span>
     <span class="nt">&lt;title&gt;</span>File<span class="nt">&lt;/title&gt;</span>
     <span class="nt">&lt;menu&gt;&lt;title/&gt;&lt;/menu&gt;</span>
     <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;execute my stats&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;title&gt;</span>Custom<span class="nt">&lt;/title&gt;</span>
     <span class="nt">&lt;/menu&gt;</span>
  <span class="nt">&lt;/submenu&gt;</span>
<span class="nt">&lt;/menus&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-contextual-menus">
<span id="id12"></span><h3>16.5.6. Adding contextual menus<a class="headerlink" href="#adding-contextual-menus" title="Permalink to this headline">¶</a></h3>
<p id="index-153">The actions can also be used to contribute new entries in the contextual menus
everywhere in GPS. These menus are displayed when the user presses the right
mouse button, and should only show actions relevant to the current context.</p>
<p>Such contributions are done through the <cite>&lt;contextual&gt;</cite> tag, which takes the
following attributes:</p>
<dl class="docutils">
<dt><em>&#8220;action&#8221;  (mandatory)</em></dt>
<dd><p class="first">Name of the action to execute, and must be defined elsewhere in one of the
customization files.</p>
<p class="last">If this attribute is set to an empty string, a separator will be inserted
in the contextual menu instead. If you specify a reference item with one of
the &#8220;before&#8221; or &#8220;after&#8221; attribute, the separator will be visible only when
the reference item is visible.</p>
</dd>
<dt><em>&#8220;before&#8221; (optional, default=&#8221;&#8221;)</em></dt>
<dd><p class="first">If it is specified, this attribute should be the name of another contextual,
before which the new menu should appear. The name of predefined contextual
menus can be found by looking at the output of &#8220;Contextual.list&#8221; in the shell
console. The name of the contextual menus you define yourself is the value of
the <cite>&lt;title&gt;</cite> child.</p>
<p class="last">There is no guarantee that the new menu will appear just before the referenced
menu. In particular, it won&#8217;t be the case if the new menu is created before
the reference menu was created, or if another later contextual menu indicates
that it must be displayed before the same reference item.</p>
</dd>
<dt><em>&#8220;after&#8221; (optional, default=&#8221;&#8221;)</em></dt>
<dd><p class="first">Same as &#8220;before&#8221;, except it indicates the new menu should appear after the
reference item.</p>
<p class="last">If both &#8220;after&#8221; and &#8220;before&#8221; are specified, only the latter is taken into
account.</p>
</dd>
</dl>
<p>It accepts one child tag, <cite>&lt;Title&gt;</cite> which specifies the name of the
menu entry. If this child is not specified, the menu entry will use the name
of the action itself. The title is in fact the full path to the new menu entry.
Therefore, you can create submenus by using a title of the form
&#8220;Parent1/Parent2/Menu&#8221;.</p>
<p>Special characters can be used in the title, and will be automatically
expended based on the current context. These are exactly the ones described
in the section for macros arguments, <a class="reference internal" href="#macro-arguments"><em>Macro arguments</em></a>.</p>
<p>The new contextual menu will only be shown if the filters associated with the
action match the current context.</p>
<p>For instance, the following example inserts a new contextual menu which prints
the name of the current file in the GPS console. This contextual menu is only
displayed in source editors. This contextual menu entry is followed by a
separator line, visible when the menu is visible:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;print&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;print current file name&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;filter</span> <span class="na">module=</span><span class="s">&quot;Source_Editor&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;shell&gt;</span>echo %f<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>

  <span class="nt">&lt;contextual</span> <span class="na">action=</span><span class="s">&quot;print current file name&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;Title&gt;</span>Print Current File Name<span class="nt">&lt;/Title&gt;</span>
  <span class="nt">&lt;/contextual&gt;</span>
  <span class="nt">&lt;contextual</span> <span class="na">action=</span><span class="s">&quot;&quot;</span> <span class="na">after=</span><span class="s">&quot;Print Current File Name&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/print&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-tool-bar-buttons">
<span id="id13"></span><h3>16.5.7. Adding tool bar buttons<a class="headerlink" href="#adding-tool-bar-buttons" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-154"></span><span class="target" id="index-155"></span><p id="index-156">As an alternative to creating new menu items, you can create new buttons on the
tool bar, with a similar syntax, by using the <cite>&lt;button&gt;</cite> tag. As for the
<cite>&lt;menu&gt;</cite> tag, it requires an <cite>action</cite> attribute which specifies what should be
done when the button is pressed. The button is not created if no such action
was created.</p>
<span class="target" id="index-157"></span><span class="target" id="index-158"></span><span class="target" id="index-159"></span><p id="index-160">Within this tag, the tag <cite>&lt;pixmap&gt;</cite> can be used to indicate the location of an
image file (of the type <cite>jpeg, png, gif</cite> or <cite>xpm</cite>) to be used as icon for the
button. An empty <cite>&lt;button&gt;</cite> tag indicates a separator in the tool bar.</p>
<p>A title can also be specified with <cite>&lt;title&gt;</cite>. This will be visible only if the
user choses to see both text and icons (or text only) in the tool bar.  This
title also acts as a tooltip (popup help message) when the button is displayed
as an icon only.</p>
<p>The following example defines a new button:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;stats&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">action=</span><span class="s">&quot;execute my stats&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>stats<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;pixmap&gt;</span>/my_pixmaps/button.jpg<span class="nt">&lt;/pixmap&gt;</span>
  <span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/stats&gt;</span>
</pre></div>
</div>
<p>The <cite>&lt;button&gt;</cite> tag allows you to create a simple button that the user can press
to start an action. GPS also supports another type of button, a combo box, from
which the user can choose among a list of choices. Such a combo box can be
created with the <cite>&lt;entry&gt;</cite> tag.</p>
<p>This tag accepts the following arguments:</p>
<dl class="docutils">
<dt><em>id (mandatory)</em></dt>
<dd>This should be a unique id for this combo box, and will be used later on
to refer it, in particular from the scripting languages. It can be any
string</dd>
<dt><em>label (default is &#8220;&#8221;)</em></dt>
<dd>The text of a label to display on the left of the combo box. If this isn&#8217;t
specified, no text will be displayed</dd>
<dt><em>on-changed (default is &#8220;&#8221;)</em></dt>
<dd>The name of a GPS action to execute whenever the user selects a new value
in the combo box. This action is called with two parameters, the unique id
of the combo box and the newly selected text respectively.</dd>
</dl>
<p>It also accepts any number of <cite>&lt;choice&gt;</cite> tags, each of which defines
one of the values the user can choose from. These tags accepts one optional
attribute, &#8220;on-selected&#8221;, which is the name of a GPS action to call when
that particular value is selected:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;animal_changed&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;shell&gt;</span>echo A new animal was selected in combo $1: animal is $2<span class="nt">&lt;/shell&gt;</span>
<span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;gnu-selected&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;shell&gt;</span>echo Congratulations on choosing a Gnu<span class="nt">&lt;/shell&gt;</span>
<span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;entry</span> <span class="na">id=</span><span class="s">&quot;foo&quot;</span> <span class="na">label=</span><span class="s">&quot;Animal&quot;</span> <span class="na">on-changed=</span><span class="s">&quot;animal_changed&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;choice&gt;</span>Elephant<span class="nt">&lt;/choice&gt;</span>
   <span class="nt">&lt;choice</span> <span class="na">on-selected=</span><span class="s">&quot;gnu-selected&quot;</span><span class="nt">&gt;</span>Gnu<span class="nt">&lt;/choice&gt;</span>
<span class="nt">&lt;/entry&gt;</span>
</pre></div>
</div>
<p>A more convenient interface exists for Python, the GPS.Toolbar class, which
gives you the same flexibility as above, but also gives you dynamic control
over the entry, and allows placement of buttons at arbitrary positions in
the toolbar. See the python documentation.</p>
</div>
<div class="section" id="binding-actions-to-keys">
<span id="id14"></span><h3>16.5.8. Binding actions to keys<a class="headerlink" href="#binding-actions-to-keys" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-161"></span><p id="index-162">All the actions defined above can be bound to specific key shortcuts through
the <cite>&lt;key&gt;</cite> attribute. As usual, it requires one <cite>&lt;action&gt;</cite> attribute to
specify what to do when the key is pressed. The name of the action can start
with a &#8216;/&#8217; to indicate that a menu should be executed instead of a user-defined
action.</p>
<p>If the action is the empty string, then instead the key will no longer be bound
to any action.</p>
<p>This tag doesn&#8217;t contain any child tag. Instead, its text contents specified
the keyboard shortcut. The name of the key can be prefixed by <cite>control-</cite>,
<cite>alt-</cite>, <cite>shift-</cite> or any combination of these to specify the key modifiers to
apply.</p>
<p>You can also define multiple key bindings similar to Emacs&#8217;s by separating them
by a space. For instance, <cite>control-x control-k</cite> means that the user should
press <tt class="kbd docutils literal"><span class="pre">control-x</span></tt>, followed by a <tt class="kbd docutils literal"><span class="pre">control-k</span></tt> to activate the
corresponding action. This is only possible if the prefix key is not already
bound to an action. If it is, you should first unbound it by passing an empty
action to <cite>&lt;key&gt;</cite>.</p>
<p>Use an empty string to describe the key binding if you wish to deactivate a
preexisting binding. The second example below deactivates the standard
binding:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;keys&gt;</span>
  <span class="nt">&lt;key</span> <span class="na">action=</span><span class="s">&quot;expand alias&quot;</span><span class="nt">&gt;</span>control-o<span class="nt">&lt;/key&gt;</span>
  <span class="nt">&lt;key</span> <span class="na">action=</span><span class="s">&quot;Jump to matching delimiter&quot;</span> <span class="nt">/&gt;</span>

  <span class="c">&lt;!--  Bind a key to a menu --&gt;</span>
  <span class="nt">&lt;key</span> <span class="na">action=</span><span class="s">&quot;/Window/Close&quot;</span><span class="nt">&gt;</span>control-x control-w<span class="nt">&lt;/key&gt;</span>
<span class="nt">&lt;/key&gt;</span>
</pre></div>
</div>
<p>Multiple actions can be bound to the same key binding. They will all be
executed in turn, followed by any menu for which this key is an accelerator.</p>
<p>When GPS processes a <cite>&lt;key&gt;</cite> tag, it does the following:</p>
<ul class="simple">
<li>Removes all actions bound to that key.
This ensures that if you press the key, any action associated with it by
default in GPS or in some other XML file will no longer be executed, and
only the last one will be executed.</li>
<li>Adds the new key to the list of shortcuts that can execute the
action. Any existing shortcut on the action is preserved, and
therefore there are multiple possible shortcuts for this action.</li>
</ul>
</div>
<div class="section" id="preferences-support-in-custom-files">
<span id="id15"></span><h3>16.5.9. Preferences support in custom files<a class="headerlink" href="#preferences-support-in-custom-files" title="Permalink to this headline">¶</a></h3>
<div class="section" id="creating-new-preferences">
<h4>16.5.9.1. Creating new preferences<a class="headerlink" href="#creating-new-preferences" title="Permalink to this headline">¶</a></h4>
<p id="index-163">GPS has a number of predefined preferences to configure its behavior and its
appearance. They are all customizable through the Edit-&gt;Preferences menu.</p>
<p>However, you might wish to add your own kind of preferences for your extension
modules. This can easily be done through the usual GPS customization files.
Preferences are different from project attributes
(<a class="reference internal" href="#defining-project-attributes"><em>Defining project attributes</em></a>), in that the latter will vary depending on
which project is loaded by the user, whereas preferences are always set to the
same value no matter what project is loaded.</p>
<p>Such preferences are created with the <cite>&lt;preference&gt;</cite> tag, which takes a number
of attributes.</p>
<dl class="docutils">
<dt><em>name (mandatory)</em></dt>
<dd>This is the name of the preference, used when the preference is saved by
GPS in the <tt class="file docutils literal"><span class="pre">$HOME/.gps/preferences</span></tt> file, and to query the value of
a preference interactively through the <cite>GPS.Preference</cite> class in the
GPS shell or python. There are a few limitation to the form of these names:
they cannot contain space or underscore characters. You should replace the
latter with minus signs for instance.</dd>
<dt><em>page (optional, default is &#8220;General&#8221;)</em></dt>
<dd><p class="first">The name of the page in the preferences editor where the preference can
be edited. If this is the name of a non-existing page, GPS will automatically
create it. If this is the empty string (&#8220;&#8221;), the preference will not be
editable interactively. This could be used to save a value from one session
of GPS to the next, without allowing the user to alter it.</p>
<p class="last">Subpages are references by separating pages name with colons (&#8216;:&#8217;).</p>
</dd>
<dt><em>default (optional, default depends on the type of the preference)</em></dt>
<dd>The default value of the preference, when not set by the user. This is 0 for
integer preferences, the empty string for string preferences, True for boolean
values, and the first possible choice for choice preferences.</dd>
<dt><em>tip (optional, default is &#8220;&#8221;)</em></dt>
<dd>This is the text of the tooltip that appears in the preferences editor
dialog.</dd>
<dt><em>label (mandatory)</em></dt>
<dd>This is the name of the preference as it appears in the preferences editor
dialog</dd>
<dt><em>type (mandatory)</em></dt>
<dd><p class="first">This is the type of the preference, and should be one of:</p>
<dl class="last docutils">
<dt><em>&#8220;boolean&#8221;</em></dt>
<dd>The preference can be True or False.</dd>
<dt><em>&#8220;integer&#8221;</em></dt>
<dd>The preference is an integer. Two optional attributes can be specified for
<cite>&lt;preference&gt;</cite>, &#8220;minimum&#8221; and &#8220;maximum&#8221;, which define the range of
valid values for that integer. Default values are 0 and 10 respectively.</dd>
<dt><em>&#8220;string&#8221;</em></dt>
<dd>The preference is a string, which might contain any value</dd>
<dt><em>&#8220;color&#8221;</em></dt>
<dd>The preference is a color name, in the format of a named color such as
&#8220;yellow&#8221;, or a string similar to &#8220;#RRGGBB&#8221;, where RR is the red component,
GG is the green component, and BB is the blue component</dd>
<dt><em>&#8220;font&#8221;</em></dt>
<dd>The preference is a font</dd>
<dt><em>&#8220;choices&#8221;</em></dt>
<dd>The preference is a string, whose value is chosen among a static list of
possible values. Each possible value is defined in a <cite>&lt;choice&gt;</cite> child
of the <cite>&lt;preference&gt;</cite> node.</dd>
</dl>
</dd>
</dl>
<p>Here is an example that defines a few new preferences:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;custom&gt;</span>
   <span class="nt">&lt;preference</span> <span class="na">name=</span><span class="s">&quot;my-int&quot;</span>
               <span class="na">page=</span><span class="s">&quot;Editor&quot;</span>
               <span class="na">label=</span><span class="s">&quot;My Integer&quot;</span>
               <span class="na">default=</span><span class="s">&quot;30&quot;</span>
               <span class="na">minimum=</span><span class="s">&quot;20&quot;</span>
               <span class="na">maximum=</span><span class="s">&quot;35&quot;</span>
               <span class="na">page=</span><span class="s">&quot;Manu&quot;</span>
               <span class="na">type=</span><span class="s">&quot;integer&quot;</span> <span class="nt">/&gt;</span>

   <span class="nt">&lt;preference</span> <span class="na">name=</span><span class="s">&quot;my-enum&quot;</span>
               <span class="na">page=</span><span class="s">&quot;Editor:Fonts &amp;amp; Colors&quot;</span>
               <span class="na">label=</span><span class="s">&quot;My Enum&quot;</span>
               <span class="na">default=</span><span class="s">&quot;1&quot;</span>
               <span class="na">type=</span><span class="s">&quot;choices&quot;</span> <span class="nt">&gt;</span>
     <span class="nt">&lt;choice&gt;</span>Choice1<span class="nt">&lt;/choice&gt;</span>
     <span class="nt">&lt;choice&gt;</span>Choice2<span class="nt">&lt;/choice&gt;</span>  <span class="c">&lt;!--  The default choice --&gt;</span>
     <span class="nt">&lt;choice&gt;</span>Choice3<span class="nt">&lt;/choice&gt;</span>
   <span class="nt">&lt;/preference&gt;</span>
<span class="nt">&lt;/custom&gt;</span>
</pre></div>
</div>
<p>The values of the above preferences can be queries in the scripting languages:</p>
<ul>
<li><p class="first">GPS shell:</p>
<div class="highlight-python"><pre>Preference "my-enum"
Preference.get %1</pre>
</div>
</li>
<li><p class="first">Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">val</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Preference</span> <span class="p">(</span><span class="s">&quot;my-enum&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span> <span class="p">()</span>
<span class="n">val2</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Preference</span> <span class="p">(</span><span class="s">&quot;my-int&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span> <span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="setting-preferences-values">
<h4>16.5.9.2. Setting preferences values<a class="headerlink" href="#setting-preferences-values" title="Permalink to this headline">¶</a></h4>
<p id="index-164">You can force specific default values for the preferences in the customization
files through the <cite>&lt;pref&gt;</cite> tag. This is the same tag that is used by
GPS itself when it saves the preferences edited through the preferences
dialog.</p>
<p>This tag requires on attribute:</p>
<dl class="docutils">
<dt><em>name</em></dt>
<dd>This is the name of the preference of which you are setting a default value.
Such names are predefined when the preference is registered in GPS, and can
be found by looking at the <tt class="file docutils literal"><span class="pre">$HOME/.gps/preferences</span></tt> file for each user,
or by looking at one of the predefined GPS themes.</dd>
</dl>
<p>It accepts no child tag, but the value of the <cite>&lt;pref&gt;</cite> tag defines the default
value of the preference, which will be used unless the user has overridden it
in his own preferences file.</p>
<p>Any setting that you have defined in the customization files will be overridden
by the user&#8217;s preferences file itself, unless the user was still using the
default value of that preference.</p>
<p>This <cite>&lt;pref&gt;</cite> tag is mostly intended for use through the themes
(<a class="reference internal" href="#creating-themes"><em>Creating themes</em></a>).</p>
</div>
</div>
<div class="section" id="creating-themes">
<span id="id16"></span><h3>16.5.10. Creating themes<a class="headerlink" href="#creating-themes" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-165"></span><p id="index-166">You can create your own themes and share them between users. You can then
selectively chose which themes they want to activate through the preferences
dialog (<a class="reference internal" href="#gps-themes"><em>GPS Themes</em></a>).</p>
<p>Creating new themes is done in the customization files through
the <cite>&lt;theme&gt;</cite> tag.</p>
<p>This tag accepts a number of attributes:</p>
<dl class="docutils">
<dt><em>name (mandatory)</em></dt>
<dd>This is the name of the theme, as it will appear in the preferences dialog</dd>
<dt><em>description (optional)</em></dt>
<dd>This text should explain what the text does. It appears in the preferences
dialog when the user selects that theme.</dd>
<dt><em>category (optional, default is General)</em></dt>
<dd>This is the name of the category in which the theme should be presented in
the preferences dialog. Categories are currently only used to organize themes
graphically. New categories are created automatically if you chose one that
doesn&#8217;t exist yet.</dd>
</dl>
<p>This tag accepts any other customization tag that can be put in the
customization files. This includes setting preferences (<cite>&lt;pref&gt;</cite>,
defining key bindings (<cite>&lt;key</cite>), defining menus (<cite>&lt;menu&gt;</cite>), ...</p>
<p>If the same theme is defined in multiple locations (multiple times in the
same customization file or in different files), their effects will be
cumulated. The first definition of the theme seen by GPS will set the
description and category for this theme.</p>
<p>All the children tags of the theme will be executed when the theme is activated
through the preferences dialog. Although there is no strict ordering in which
order the children will be executed, the global order is the same as for the
customization files themselves: first the predefined themes of GPS, then the
ones defined in customization files found through the <cite>GPS_CUSTOM_PATH</cite>
directories, and finally the ones defined in files found in the user&#8217;s
own GPS directory:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;my-plug-in&gt;</span>
   <span class="nt">&lt;theme</span> <span class="na">name=</span><span class="s">&quot;my theme&quot;</span> <span class="na">description=</span><span class="s">&quot;Create a new menu&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;my action&quot;</span><span class="nt">&gt;&lt;title&gt;</span>/Edit/My Theme Menu<span class="nt">&lt;/title&gt;&lt;/menu&gt;</span>
   <span class="nt">&lt;/theme&gt;</span>
<span class="nt">&lt;/my-plug-in&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-new-search-patterns">
<span id="id17"></span><h3>16.5.11. Defining new search patterns<a class="headerlink" href="#defining-new-search-patterns" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-167"></span><p id="index-168">The search dialog contains a number of predefined search patterns for Ada, C
and C++. These are generally complex regular expressions, presented in the
dialog with a more descriptive name. This includes for instance
&#8220;Ada assignment&#8221;, which will match all such assignments.</p>
<p>You can define your own search patterns in the customization files. This is
done through the <cite>&lt;vsearch-pattern&gt;</cite> tag. This tag can have a number of
children tags:</p>
<dl class="docutils">
<dt><em>&lt;name&gt;</em></dt>
<dd>This tag is the string that is displayed in the search dialog to
represent the new pattern. This is the text that the user will
effectively see, instead of the often hard to understand regular
expression.</dd>
<dt><em>&lt;regexp&gt;</em></dt>
<dd><p class="first">This tag provides the regular expression to use when the pattern has
been selected by the user. Be careful that you must protect reserved
XML characters such as &#8216;&lt;&#8217; and replace them by their equivalent
expansion (&#8220;&amp;lt;&#8221; for this character).</p>
<p class="last">This accepts one optional attribute, named <cite>case-sensitive</cite>. This
attribute accepts one of two possible values (&#8220;true&#8221; or &#8220;false&#8221;) which
indicates whether the search should distinguish lower case and upper
case letters. Its default value is &#8220;false&#8221;.</p>
</dd>
<dt><em>&lt;string&gt;</em></dt>
<dd><p class="first">This tag provides a constant string that should be searched.
Only one of <cite>&lt;regexp&gt;</cite> and <cite>&lt;string&gt;</cite> should be provided. If
both exists, the first <cite>&lt;regexp&gt;</cite> child found is used. If there is
none, the first <cite>&lt;string&gt;</cite> child is used.</p>
<p class="last">The tag accepts the same optional attribute <cite>case-sensitive</cite> as
above</p>
</dd>
</dl>
<p>Here is a small example on how the &#8220;Ada assignment&#8221; pattern was
defined:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;search&gt;</span>
  <span class="nt">&lt;vsearch-pattern&gt;</span>
    <span class="nt">&lt;name&gt;</span>Ada: assignment<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;regexp</span> <span class="na">case-sensitive=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>\\b(\\w+)\\s*:=<span class="nt">&lt;/regexp&gt;</span>
  <span class="nt">&lt;/vsearch-pattern&gt;</span>
<span class="nt">&lt;/search&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-support-for-new-languages">
<span id="id18"></span><h3>16.5.12. Adding support for new languages<a class="headerlink" href="#adding-support-for-new-languages" title="Permalink to this headline">¶</a></h3>
<p id="index-169">You can define new languages in a custom file by using the <cite>Language</cite>
tag. Defining languages gives GPS the ability to highlight the syntax of a
file, explore a file (using e.g. the project view), find files
associated with a given language, ...</p>
<p>As described previously for menu items, any file in the <tt class="file docutils literal"><span class="pre">plug-ins</span></tt>
directory will be loaded by GPS at start up. Therefore, you can either
define new languages in a separate file, or reuse a file where you already
define actions and menus.</p>
<p>The following tags are available in a <cite>Language</cite> section:</p>
<dl class="docutils">
<dt><em>Name</em></dt>
<dd>A short string describing the name of the language.</dd>
<dt><em>Parent</em></dt>
<dd>If set to the name of an existing language (e.g. <cite>Ada</cite>, <cite>C++</cite>) or
another custom language, this language will inherit by default all its
properties from this language. Any field explicitly defined for this language
will override the inherited settings.</dd>
<dt><em>Spec_Suffix</em></dt>
<dd>A string describing the suffix of spec/definition files for this language.
If the language does not have the notion of spec or definition file, you
can ignore this value, and consider using the <cite>Extension</cite> tag instead.
This tag must be unique.</dd>
<dt><em>Body_Suffix</em></dt>
<dd>A string describing the suffix of body/implementation files for this language.
This tag works in coordination with the <cite>Spec_Suffix</cite>, so that the user
can choose to easily go from one file to the other.
This tag must be unique.</dd>
<dt><em>LI_Suffix</em></dt>
<dd>A string describing the suffix of library information files for this language.
If the language does not support library information files, you can omit this
value.</dd>
<dt><em>Extension</em></dt>
<dd>A string describing one of the valid extensions for this language. There can
be several such children. The extension must start with a &#8216;.&#8217; character</dd>
<dt><em>Keywords</em></dt>
<dd><p class="first">A V7 style regular expression for recognizing and highlighting keywords.
Multiple <cite>Keywords</cite> tags can be specified, and will be concatenated
into a single regular expression. If the regular expression needs to match
characters other than letters and underscore, you must also edit the
<cite>Wordchars</cite> node. If a parent language has been specified for the
current language definition it is possible to append to the parent Keywords
by setting the <cite>mode</cite> attribute to <cite>append</cite>, the default value is
<cite>override</cite> meaning that the keywords definition will replace the
parent&#8217;s one.</p>
<p class="last">The full grammar of the regular expression can be found in the spec of the
file <tt class="file docutils literal"><span class="pre">g-regpat.ads</span></tt> in the GNAT run time.</p>
</dd>
<dt><em>Wordchars</em></dt>
<dd>Most languages have keywords that only contain letters, digits and underscore
characters. However, if you want to also include other special characters
(for instance &#8216;&lt;&#8217; and &#8216;&gt;&#8217; in XML), you need to use this tag to let GPS
know. The value of this node is a string made of all the special word
characters. You do not need to include letters, digits or underscores.</dd>
<dt><em>Engine</em></dt>
<dd><p class="first">The name of a dynamic library providing one or several of the functions
described below.</p>
<p>The name can be a full pathname, or a short name. E.g. under most Unix systems
if you specify <cite>custom</cite>, GPS will look for <cite>libcustom.so</cite> in
the <cite>LD_LIBRARY_PATH</cite> run time search path. You can also specify
explicitly e.g. <cite>libcustom.so</cite> or <cite>/usr/lib/libcustom.so</cite>.</p>
<p>For each of the following five items, GPS will look for the corresponding
symbol in <cite>Engine</cite> and if found, will call this symbol when needed.
Otherwise, it will default to the static behavior, as defined by the other
language-related items describing a language.</p>
<p class="last">You will find the required specification for the C and Ada languages to
implement the following functions in the directory
<tt class="file docutils literal"><span class="pre">&lt;prefix&gt;/share/examples/gps/language</span></tt> of your GPS installation.
<tt class="file docutils literal"><span class="pre">language_custom.ads</span></tt> is the Ada spec file; <tt class="file docutils literal"><span class="pre">language_custom.h</span></tt>
is the C spec file; <tt class="file docutils literal"><span class="pre">gpr_custom.ad?</span></tt> are example files showing a
possible Ada implementation of the function <cite>Comment_Line</cite> for the GPS
project files (<tt class="file docutils literal"><span class="pre">.gpr</span></tt> files), or any other Ada-like language;
<tt class="file docutils literal"><span class="pre">gprcustom.c</span></tt> is the C version of gpr_custom.adb.</p>
</dd>
<dt><em>Comment_Line</em></dt>
<dd>Name of a symbol in the specified shared library corresponding to a
function that will comment or uncomment a line (used to implement the menu
<cite>Edit-&gt;Un/Comment Lines</cite>).</dd>
<dt><em>Parse_Constructs</em></dt>
<dd><p class="first">Name of a symbol in the specified shared library corresponding to a
function that will parse constructs of a given buffer.</p>
<p class="last">This procedure is used by GPS to implement several capabilities such as
listing constructs in the project view, highlighting the current block of
code, going to the next or previous procedure, ...</p>
</dd>
<dt><em>Format_Buffer</em></dt>
<dd><p class="first">Name of a symbol in the specified shared library corresponding to a
function that will indent and format a given buffer.</p>
<p class="last">This procedure is used to implement the auto indentation when hitting the
<tt class="kbd docutils literal"><span class="pre">enter</span></tt> key, or when using the format key on the current selection or
the current line.</p>
</dd>
<dt><em>Parse_Entities</em></dt>
<dd>Name of a symbol in the specified shared library corresponding to a
function that will parse entities (e.g. comments, keywords, ...) of a given
buffer. This procedure is used to highlight the syntax of a file, and
overrides the <cite>Context</cite> node described below.</dd>
<dt><em>Context</em></dt>
<dd><p class="first">Describes the context used to highlight the syntax of a file.</p>
<dl class="last docutils">
<dt><em>Comment_Start</em></dt>
<dd>A string defining the beginning of a multiple-line comment.</dd>
<dt><em>Comment_End</em></dt>
<dd>A string defining the end of a multiple-line comment.</dd>
<dt><em>New_Line_Comment_Start</em></dt>
<dd>A regular expression defining the beginning of a single line comment
(ended at the next end of line). This regular expression may contain
multiple possible line starts, such as <cite>;|#</cite> for comments starting
after a semicolon or after the hash sign. If a parent language has been
specified for the current language definition it is possible to append
to the parent New_Line_Comment_Start by setting the <cite>mode</cite> attribute to
<cite>append</cite>, the default value is <cite>override</cite> meaning that the
New_Line_Comment_Start definition will replace the parent&#8217;s one.</dd>
<dt><em>String_Delimiter</em></dt>
<dd>A character defining the string delimiter.</dd>
<dt><em>Quote_Character</em></dt>
<dd>A character defining the quote character, used for e.g. canceling the
meaning of a string delimiter (<cite>\</cite> in C).</dd>
<dt><em>Constant_Character</em></dt>
<dd>A character defining the beginning of a character literal.</dd>
<dt><em>Can_Indent</em></dt>
<dd>A boolean indicating whether indentation should be enabled for this
language. The indentation mechanism used will be the same for all languages:
the number of spaces at the beginning of the current line is used when
indenting the next line.</dd>
<dt><em>Syntax_Highlighting</em></dt>
<dd>A boolean indicating whether the syntax should be highlighted/colorized.</dd>
<dt><em>Case_Sensitive</em></dt>
<dd>A boolean indicating whether the language (and in particular the identifiers
and keywords) is case sensitive.</dd>
</dl>
</dd>
<dt><em>Categories</em></dt>
<dd><p class="first">Optional node to describe the categories supported by the project view
for the current language. This node contains a list of <cite>Category</cite> nodes,
each describing the characteristics of a given category, with the following
nodes:</p>
<dl class="last docutils">
<dt><em>Name</em></dt>
<dd>Name of the category, which can be either one of the following predefined
categories: package, namespace, procedure, function, task, method,
constructor, destructor, protected, entry, class, structure, union, type,
subtype, variable, local_variable, representation_clause, with, use,
include, loop_statement, case_statement, if_statement, select_statement,
accept_statement, declare_block, simple_block, exception_handler, or any
arbitrary name, which will create a new category.</dd>
<dt><em>Pattern</em></dt>
<dd>Regular expression used to detect a language category.
As for the <cite>Keywords</cite> node, multiple <cite>Pattern</cite> tags can be
specified and will be concatenated into a single regular expression.</dd>
<dt><em>Index</em></dt>
<dd>Index in the pattern used to extract the name of the entity contained in
this category.</dd>
<dt><em>End_Index</em></dt>
<dd>Optional attribute that indicates the index in the pattern used to start
the next search. Default value is the end of the pattern.</dd>
<dt><em>Icon</em></dt>
<dd>Name of a stock icon that should be used for that category
(<a class="reference internal" href="#adding-stock-icons"><em>Adding stock icons</em></a>). This attribute is currently ignored, and is
reserved for future uses.</dd>
</dl>
</dd>
<dt><em>Project_Field</em></dt>
<dd><p class="first">This tag describes the tools that are used to support this
language. The name of these tools is stored in the project files, and
therefore only a limited number of tools can be specified. Note that this
tag is currently only used by the project properties and wizard, and is
not taken into account by other components.</p>
<p>This node has two attributes:</p>
<dl class="docutils">
<dt><em>Name</em></dt>
<dd>Name of the attribute in the project file. Currently, only
<cite>&#8220;compiler_command&#8221;</cite> can be specified.</dd>
<dt><em>Index</em></dt>
<dd><p class="first">If present, this attributes indicates the index to use for the
attribute in the project file. The line defining this attribute
would therefore look like:</p>
<div class="highlight-ada"><div class="highlight"><pre><span class="kr">for</span> <span class="n">Name</span> <span class="p">(</span><span class="s">&quot;Index&quot;</span><span class="p">)</span> <span class="kn">use</span> <span class="s">&quot;value&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>e.g:</p>
<div class="highlight-ada"><div class="highlight"><pre><span class="kr">for</span> <span class="n">Compiler_Command</span> <span class="p">(</span><span class="s">&quot;my_language&quot;</span><span class="p">)</span> <span class="kn">use</span> <span class="s">&quot;my_compiler&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p class="last">The value of the index should be either the empty string or the
name of the language.</p>
</dd>
</dl>
<p class="last">The value of this tag is the string to use in the project properties
editor when editing this project field.</p>
</dd>
</dl>
<p>Here is an example of a possible language definition for the GPS project
files:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;Custom&gt;</span>
  <span class="nt">&lt;Language&gt;</span>
    <span class="nt">&lt;Name&gt;</span>Project File<span class="nt">&lt;/Name&gt;</span>
    <span class="nt">&lt;Spec_Suffix&gt;</span>.gpr<span class="nt">&lt;/Spec_Suffix&gt;</span>
    <span class="nt">&lt;Keywords&gt;</span>^(case|e(nd|xte(nds|rnal))|for|is|<span class="nt">&lt;/Keywords&gt;</span>
    <span class="nt">&lt;Keywords&gt;</span>limited|null|others|<span class="nt">&lt;/Keywords&gt;</span>
    <span class="nt">&lt;Keywords&gt;</span>p(ackage|roject)|renames|type|use|w(hen|ith))\\b<span class="nt">&lt;/Keywords&gt;</span>

    <span class="nt">&lt;Context&gt;</span>
      <span class="nt">&lt;New_Line_Comment_Start&gt;</span>--<span class="nt">&lt;/New_Line_Comment_Start&gt;</span>
      <span class="nt">&lt;String_Delimiter&gt;</span><span class="ni">&amp;quot;</span><span class="nt">&lt;/String_Delimiter&gt;</span>
      <span class="nt">&lt;Constant_Character&gt;</span><span class="ni">&amp;apos;</span><span class="nt">&lt;/Constant_Character&gt;</span>
      <span class="nt">&lt;Can_Indent&gt;</span>True<span class="nt">&lt;/Can_Indent&gt;</span>
      <span class="nt">&lt;Syntax_Highlighting&gt;</span>True<span class="nt">&lt;/Syntax_Highlighting&gt;</span>
      <span class="nt">&lt;Case_Sensitive&gt;</span>False<span class="nt">&lt;/Case_Sensitive&gt;</span>
    <span class="nt">&lt;/Context&gt;</span>

    <span class="nt">&lt;Categories&gt;</span>
      <span class="nt">&lt;Category&gt;</span>
        <span class="nt">&lt;Name&gt;</span>package<span class="nt">&lt;/Name&gt;</span>
        <span class="nt">&lt;Pattern&gt;</span>^[ \\t]*package[ \\t]+((\\w|\\.)+)<span class="nt">&lt;/Pattern&gt;</span>
        <span class="nt">&lt;Index&gt;</span>1<span class="nt">&lt;/Index&gt;</span>
      <span class="nt">&lt;/Category&gt;</span>
      <span class="nt">&lt;Category&gt;</span>
        <span class="nt">&lt;Name&gt;</span>type<span class="nt">&lt;/Name&gt;</span>
        <span class="nt">&lt;Pattern&gt;</span>^[ \\t]*type[ \\t]+(\\w+)<span class="nt">&lt;/Pattern&gt;</span>
        <span class="nt">&lt;Index&gt;</span>1<span class="nt">&lt;/Index&gt;</span>
      <span class="nt">&lt;/Category&gt;</span>
    <span class="nt">&lt;/Categories&gt;</span>

    <span class="nt">&lt;Engine&gt;</span>gpr<span class="nt">&lt;/Engine&gt;</span>
    <span class="nt">&lt;Comment_Line&gt;</span>gpr_comment_line<span class="nt">&lt;/Comment_Line&gt;</span>
  <span class="nt">&lt;/Language&gt;</span>
<span class="nt">&lt;/Custom&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-text-aliases">
<span id="id19"></span><h3>16.5.13. Defining text aliases<a class="headerlink" href="#defining-text-aliases" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-170"></span><p id="index-171">GPS provides a mechanism known as <strong>aliases</strong>. These are defined
through the menu <cite>Edit-&gt;Aliases</cite>.</p>
<p>Each alias has a name, which is generally a short string of characters.
When you type them in any textual entry in GPS (generally a source editor, but
also entry fields for instance in the file selector), and then press the special
activation key (by default <tt class="kbd docutils literal"><span class="pre">control-o</span></tt>, controlled by a
preference), this name is removed from the source editor, and replaced
by the text you have associated with it.</p>
<p>Alias names may be composed of any character except newlines, but must start
with a letter. GPS will jump to the start of each word before the current
cursor position, and if the characters between this word start and the
cursor position is an alias name (the comparison is case insensitive), this
alias is expanded.</p>
<img alt="_images/aliases.jpg" id="index-172" src="_images/aliases.jpg" />
<p>The alias editor is divided into three main parts: on the left side, the list
of currently defined aliases is shown. Clicking on any of them will display the
replacement text for this alias. If you click again the selected alias, GPS
displays a text entry which you can use to rename an existing alias. Alias
names must start with a letter. A check button at the bottom selects whether
the read-only aliases (i.e. system-wide aliases) should be displayed.</p>
<p>The second part is the expansion text for the alias, at the bottom right
corner. This replacement text can used multiple lines, and contain some special
text that act as a special replacement. These special texts are highlighted in
a different color. You can insert these special entities either by typing them,
or by right-clicking in the editor, and select the entity in the contextual
menu.</p>
<p>The following special entities are currently defined:</p>
<dl class="docutils">
<dt><em>%_</em></dt>
<dd>This is the position where the cursor should be put once the
replacement text has been inserted in the editor.</dd>
<dt><em>%(name)</em></dt>
<dd>This is the name of a parameter. <em>name</em> can be any string you want,
excluding closing parenthesis. See below for more information on
parameters.</dd>
<dt><em>%D</em></dt>
<dd>This is the current date, in ISO format. The year is displayed first,
then the month and the day</dd>
<dt><em>%H</em></dt>
<dd>This is the current time (hour, minutes and seconds)</dd>
<dt><em>%l</em></dt>
<dd>If the expansion of the alias is done in a source editor, this is the
line on which the cursor is when pressing <tt class="kbd docutils literal"><span class="pre">control-o</span></tt>.</dd>
<dt><em>%c</em></dt>
<dd>This is similar to <em>%l</em>, except it returns the current column.</dd>
<dt><em>%f</em></dt>
<dd>If the expansion is done in a source editor, this is the name of the
current file (its base name only, this doesn&#8217;t include the directory)</dd>
<dt><em>%d</em></dt>
<dd>If the expansion is done in a source editor, this is the directory in
which the current file is</dd>
<dt><em>%p</em></dt>
<dd>If the expansion is done in a source editor, this is the base name of
the project file to which the file belongs.</dd>
<dt><em>%P</em></dt>
<dd>If the expansion is done in a source editor, this is the full path
name to the project file (directory and base name).</dd>
<dt><em>%O</em></dt>
<dd>Used for recursive aliases expansion. This special character will expand the
text seen before it in the current alias, after replacement of the parameters
and possibly other recursive expansions. This is similar to pressing
<tt class="kbd docutils literal"><span class="pre">control-o</span></tt> (or any key you have defined for alias expansion) in the
expanded form of the alias.</dd>
<dt><em>%%</em></dt>
<dd><p class="first">Inserts a percent sign as part of the expanded text</p>
<p class="last">You cannot expand an alias recursively when already expanding that alias. For
instance, if the alias expansion for <em>procedure</em> contains <em>procedure%O</em>,
the inner procedure will not be expanded.</p>
</dd>
</dl>
<p>The indentation as set in the expansion of the alias is preserved when the
alias is expanded. All the lines will be indented the same amount to the right
as the alias name. You can override this default behavior by selecting the
check button <cite>Indent source editor after expansion</cite>.  In this case, GPS will
replace the name of the alias by its expansion, and then automatically
recompute the position of each line with its internal indentation engine, as if
the text had been inserted manually.</p>
<p>The third part of the aliases editor, at the top right corner, lists the
parameters for the currently selected alias. Any time you insert a <em>%(name)</em>
string in the expansion text, GPS automatically detects there is a new
parameter reference (or an old reference has changed name or was removed); the
list of parameters is automatically updated to show the current list.</p>
<p>Each parameters has three attributes:</p>
<dl class="docutils">
<dt><em>name</em></dt>
<dd>This is the name you use in the expansion text of the alias in the
<em>%(name)</em> special entity.</dd>
<dt><em>Environment</em></dt>
<dd>This specifies whether the default value of the parameter comes from
the list of environment variables set before GPS was started.</dd>
<dt><em>default value</em></dt>
<dd>Instead of getting the default value from the environment variable,
you can also specify a fixed text.
Clicking on the initial value of the currently selected variable opens
a text entry which you can use to edit this default value.</dd>
</dl>
<p>When an alias that contains parameters is expanded, GPS will first
display a dialog to ask for the value of the parameters. You can
interactively enter this value, which replaces all the <em>%(name)</em>
entities in the expansion text.</p>
</div>
<div class="section" id="aliases-files">
<h3>16.5.14. Aliases files<a class="headerlink" href="#aliases-files" title="Permalink to this headline">¶</a></h3>
<p>The customization files described earlier can also contain aliases definition.
This can be used for instance to create project or system wide aliases. All the
customization files will be parsed to look for aliases definition.</p>
<p>All these customization files are considered as read-only by GPS, and therefore
cannot be edited through the graphical interface. It is possible to override
some of the aliases in your own custom files.</p>
<p>There is one specific files, which must contain only aliases definition. This
is the file <tt class="file docutils literal"><span class="pre">$HOME/.gps/aliases</span></tt>. Whenever you edit aliases graphically,
or create new ones, they are stored in this file, which is the only one that
GPS will ever modify automatically.</p>
<p>The system files are loaded first, and aliases defined there can be overridden
by the user-defined file.</p>
<p>These files are standard XML customization files.  The specific XML tag to use
is <em>&lt;alias&gt;</em>, one per new alias.  The following example contains a standalone
customization file, but you might wish to merge the <em>&lt;alias&gt;</em> tag in any other
customization file.</p>
<p>The following tags are available:</p>
<dl class="docutils">
<dt><em>alias</em></dt>
<dd>This indicates the start of a new alias. It has one mandatory
attribute, <cite>name</cite>, which the text to type in the source editor
before pressing <tt class="kbd docutils literal"><span class="pre">control-o</span></tt>.
It has one optional attribute, <cite>indent</cite>, which, if set to <em>true</em>,
indicate that GPS should recompute the indentation of the newly inserted
paragraph after the expansion.</dd>
<dt><em>param</em></dt>
<dd><p class="first">These are children of the <cite>alias</cite> node. There is one per parameter of the
alias. They have one mandatory attribute, <cite>name</cite>, which is the name to type
between <em>%(name)</em> in the alias expansion text.</p>
<p>They have one optional attribute, <cite>environment</cite>, which indicates the default
value must be read from the environment variables if it is set to true.</p>
<p class="last">These tags contain text, which is the default value for the parameter.</p>
</dd>
<dt><em>text</em></dt>
<dd>This is a child of the <cite>alias</cite> node, whose value is the
replacement text for the alias.</dd>
</dl>
<p>Here is an example of an alias file:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;Aliases&gt;</span>
  <span class="nt">&lt;alias</span> <span class="na">name=</span><span class="s">&quot;proc&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;p&quot;</span> <span class="nt">&gt;</span>Proc1<span class="nt">&lt;/param&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">environment=</span><span class="s">&quot;true&quot;</span> <span class="na">name=</span><span class="s">&quot;env&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;text&gt;</span>procedure %(p) is
%(env)%_
end %(p);<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;/alias&gt;</span>
<span class="nt">&lt;/Aliases&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-project-attributes">
<span id="id20"></span><h3>16.5.15. Defining project attributes<a class="headerlink" href="#defining-project-attributes" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-173"></span><p id="index-174">The project files are required by GPS, and are used to store various pieces of
information related to the current set of source files. This includes how to
find the source files, how the files should be compiled, or manipulated through
various tools, ....</p>
<p>However, the default set of attributes that are usable in a project file is
limited to the attributes needed by the tool packaged with GPS or GNAT.</p>
<p>If you are delivering your own tools, you might want to store similar
information in the project files themselves, since these are a very convenient
place to associate some specific settings with a given set of source files.</p>
<p>GPS lets manipulate the contents of projects through XML customization files
and script commands. You can therefore add you own typed attributes into the
projects, so that they are saved automatically when the user saves the project,
and reloaded automatically the next time GPS is started.</p>
<div class="section" id="declaring-the-new-attributes">
<h4>16.5.15.1. Declaring the new attributes<a class="headerlink" href="#declaring-the-new-attributes" title="Permalink to this headline">¶</a></h4>
<p>New project attributes can be declared in two ways: either using the advanced
XML tags below, or using the <cite>&lt;tool&gt;</cite> tag (<a class="reference internal" href="#defining-tool-switches"><em>Defining tool switches</em></a>).</p>
<p>The customization files support the <cite>&lt;project_attribute&gt;</cite> tag, which is used to
declare all the new attributes that GPS should expect in a project.  Attributes
that have not been declared explictly will not be accessible through the GPS
scripting languagues, and will generate warnings in the Messages window.</p>
<p>Project attributes are typed: they can either have a single value, or have a
set of such values (a list). The values can in turn be a free-form string, a
file name, a directory name, or a value extracted from a list of preset values.</p>
<p>Attributes that have been declared in these customization files will also be
graphically editable through the project properties dialog, or the project
wizard. Therefore, you should specify when an attribute is defined how it
should be presented to the GPS user.</p>
<p>The <cite>&lt;project_attribute&gt;</cite> tag accepts the following attributes:</p>
<ul>
<li><p class="first"><cite>package</cite> (a string, default value: &#8220;&#8221;)</p>
<p>This is the package in the project file in which the attribute is stored.
Common practice suggests that one such package should be used for each tool.
These packages provide namespaces, so that attributes with the same name, but
for different tools, do not conflict with each other.</p>
</li>
<li><p class="first"><cite>name</cite> (a string, mandatory)</p>
<p>This is the name of the attribute. This should be a string with no space, and
that represents a valid Ada identifier (typically, it should start with a
letter and be followed by a set of letters, digits or underscore characters).
This is an internal name that is used when saving the attribute in a project
file.</p>
</li>
<li><p class="first"><cite>editor_page</cite> (a string, default value: &#8220;General&#8221;)</p>
<p>This is the name of the page in the Project Properties editor dialog in which
the attribute is presented. If no such page already exists, a new one will be
created as needed. If the page already exists, the attribute will be appended
at its bottom.</p>
</li>
<li><p class="first"><cite>editor_section</cite> (a string, default value: &#8220;&#8221;)</p>
<p>This is the name of the section, inside editor page, in which the attribute
is displayed. These sections are surrounded by frames, the title of which is
given by the <cite>editor_section</cite> attribute.  If this attribute is not specified,
the attribute is put in an untitled section.</p>
</li>
<li><p class="first"><cite>label</cite> (a string, default value: the name of the attribute)</p>
<p>If this attribute is set to a value other than the empty string <cite>&#8220;&#8221;</cite>, a
textual label is displayed to the left of the attribute in the graphical
editor. This should be used to identify the attribute. However, it can be
left to the empty string if the attribute is in a named section of its own,
since the title of the section might be a good enough indication.</p>
</li>
<li><p class="first"><cite>description</cite> (a string, default value: &#8220;&#8221;)</p>
<p>This is the help message that describes the role of the attribute. It is
displayed in a tooltip if the user leaves the mouse on top of the attribute
for a while.</p>
</li>
<li><p class="first"><cite>list</cite> (a boolean, default value: &#8220;false&#8221;)</p>
<p>If this is set to <cite>&#8220;true&#8221;</cite>, the project attribute will in fact contains a
list of values, as opposed to a single value. This is used for instance for
the list of source directories in standard projects.</p>
</li>
<li><p class="first"><cite>ordered</cite> (a boolean, default value: &#8220;false&#8221;)</p>
<p>This is only relevant if the project attribute contains a list of values.
This indicates whether the order of the values is relevant.  In most cases,
it will not matter. However, for instance, the order of source directories
matters, since this also indicates where the source files will be searched,
stopping at the first match.</p>
</li>
<li><p class="first"><cite>omit_if_default</cite> (a boolean, default value: &#8220;true&#8221;)</p>
<p>This indicates whether the project attribute should be set explicitly in the
project if the user has left it to its default value. This can be used to
keep the project files a simple as possible, if all the tools that will use
this project attribute know about the default value. If this isn&#8217;t the case,
set <cite>omit_if_default</cite> to &#8220;false&#8221; to force the generation of the project
attribute.</p>
</li>
<li><p class="first"><cite>base_name_only</cite> (a boolean, default value: &#8220;false&#8221;)</p>
<p>If the attribute contains a file name or a directory name, this indicates
whether the full path should be stored, or only the base name. In most cases,
the full path should be used. However, since GPS automatically looks for
source files in the list of directories, for instance, the list of source
files should only contain base names. This also increases the portability of
project files.</p>
</li>
<li><p class="first"><cite>case_sensitive_index</cite> (a string (&#8220;true&#8221;, &#8220;false&#8221; or &#8220;file&#8221;), default: &#8220;false&#8221;)</p>
<p>This XML attribute is only relevant for project attributes that are indexed
on another one (see below for more information on indexed attributes). It
indicates whether two indexes that differ only by their casing should be
considered the same. For instance, if the index is the name of one of the
languages supported by GPS, the index is case insensitive since &#8220;Ada&#8221; is the
same as &#8220;C&#8221;.</p>
<p>As a special case, the value &#8220;file&#8221; can be passed to indicate that the case
sensitivity is the same as on the filesystem of the local host. This should
be used when the index is the name of a file.</p>
</li>
<li><p class="first"><cite>hide_in</cite> (a string, default value: &#8220;&#8221;)</p>
<p>This XML attribute defines the various context in which this attribute should
not be editable graphically. Currently, GPS provides three such contexts
(&#8220;wizard&#8221;, &#8220;library_wizard&#8221; and &#8220;properties&#8221;, corresponding to the project
creation wizards and the project properties editor). If any of those context
is specified in hide_in, then the widget to edit this attribute will not be
shown. The goal is to keep the graphical interface simple.</p>
</li>
<li><p class="first"><cite>disable_if_not_set</cite> (a boolean, default value: &#8220;false&#8221;)</p>
<p>If this attribute is set to &#8220;true&#8221;, the editor for this attribute will be
greyed out if the attribute is not explicitly set in the project. In most
cases, this is not needed, since the default value of the attribute can be
used to leave the editor active at all time. However, when the value of the
attribute is automatically computed depending on other attributes, the
default value cannot be easily specified in the XML file, and in this case it
might be easier to grey out the editor. An extra check box is displayed next
to the attribute so that the user can choose to activate the editor and add
the attribute to the project.</p>
</li>
<li><p class="first"><cite>disable</cite> (a space-separated list of attribute names, default: &#8220;&#8221;)</p>
<p>This is a list of attribute whose editor should be greyed out if the current
attribute is specified. This only works if both the current attribute and the
referenced attributes have their <cite>disable_if_not_set</cite> attribute set to
&#8220;true&#8221;.  This can be used to have mutually exclusive attributes present in
the editor</p>
</li>
</ul>
</div>
<div class="section" id="declaring-the-type-of-the-new-attributes">
<h4>16.5.15.2. Declaring the type of the new attributes<a class="headerlink" href="#declaring-the-type-of-the-new-attributes" title="Permalink to this headline">¶</a></h4>
<p>The type of the project attribute is specified through one or several
child tags of <cite>&lt;project_attribute&gt;</cite>. The following tags are
recognized.</p>
<blockquote>
<div></div></blockquote>
<ul id="index-175">
<li><p class="first"><cite>&lt;string&gt;</cite></p>
<p>This tag indicates that the attribute is made of one (or more if it is
a list) strings. This
tag accepts the following XML attributes:</p>
<ul>
<li><p class="first"><cite>default</cite> (a string, default value: &#8220;&#8221;)</p>
<p>This gives the default value to be used for the string (and therefore
the project attribute), in case the user hasn&#8217;t overridden it.</p>
<p>If the attribute&#8217;s type is a file or a directory, the default value will be
normalized (ie an absolute path will be generated from it, based on the
project&#8217;s location, where <cite>&#8221;.&#8221;</cite> will represent the project&#8217;s directory).
As a special case, if default is surrounded by parenthesis, no normalization
takes place, so that you can later on test whether the user is still using
the default value or not).</p>
<p>A special case if when <cite>default</cite> is set to &#8220;project source files&#8221;. In this
case, this is automatically replaced by the known list of source files for
the project. This doesn&#8217;t work from the project wizard, since the list of
source files hasn&#8217;t been computed at that stage.</p>
</li>
<li><p class="first"><cite>type</cite> (one of &#8220;&#8221; (default), &#8220;file&#8221;, &#8220;directory&#8221; or &#8220;unit&#8221;)</p>
<p>This indicates what the string represents. In the first case, any
value can be used. In the second case, it should represent a file
name, although no check is done to make sure the file actually exists
on the disk. But GPS will be able to do some special marshalling with
the file name. The third case indicates that GPS should expect a
directory. The fourth case indicates the GPS should expect the name of
one of the project&#8217;s units.</p>
</li>
<li><p class="first"><cite>filter</cite> (one of &#8220;none&#8221;, &#8220;project&#8221;, &#8220;extending_project&#8221;)</p>
<p>This attribute is ignored for all types except <cite>&#8220;file&#8221;</cite>. In this case, it
further specifies what kind of files can be used in this attribute. If the
filter is <cite>&#8220;none&#8221;</cite>, then any file anywhere on the system is valid.  If the
filter is <cite>&#8220;project&#8221;</cite>, then only files from the selected project can be
specified. If the filter is <cite>&#8220;extended_project&#8221;</cite>, then only the files from
the project extended by the current project can be specified. The attribute
will not be shown if the current project is not an extending project.</p>
</li>
<li><p class="first"><cite>allow_empty</cite> (one of &#8220;True&#8221; or &#8220;False, default &#8220;True&#8221;)</p>
<p>This attribute indicates whether the value for this attribute can be an
empty string. If not, the user must specify a value or an error message
will be displayed in the project properties editor and project wizard.</p>
</li>
</ul>
</li>
<li id="index-176"><p class="first"><cite>&lt;choice&gt;</cite></p>
<p>This tag can be repeated several times. It indicates one of the valid values
for the attribute, and can be used to provide a static list of such values.
If it is combined with a <cite>&lt;string&gt;</cite> tag, this indicates that the attribute
can be any string, although a set of possible values is provided to the user
for ease of use.  This tag accepts one optional attribute, <cite>&#8220;default&#8221;</cite>, which
is a boolean. It indicates whether this value is the default to use for the
project attribute.</p>
<p>If several <cite>&lt;choice&gt;</cite> tags are used, it is possible that several of them are
part of the default value if the project attribute is a list, as opposed to a
single value.</p>
</li>
<li id="index-177"><p class="first"><cite>&lt;shell&gt;</cite></p>
<p>This tag is a GPS scripting command to execute to get a list of valid values
for the attribute. The command should return a list. As for the <cite>&lt;choice&gt;</cite>
tag, the <cite>&lt;shell&gt;</cite> tag can be combined with a <cite>&lt;string&gt;</cite> tag to indicate that
the list of values returned by the scripting command is only a set of
possible values, but that the project attribute can in fact take any value.</p>
<p>The <cite>&lt;shell&gt;</cite> tag accepts two attributes:</p>
<ul>
<li><p class="first"><cite>lang</cite> (a string, default value: &#8220;shell&#8221;)</p>
<p>The scripting language in which the command is written. Currently, the only
other possible value is &#8220;python&#8221;.</p>
</li>
<li><p class="first"><cite>default</cite> (a string, default value: &#8220;&#8221;)</p>
<p>The default value that the project attribute takes if the user hasn&#8217;t
overridden it.</p>
</li>
</ul>
</li>
</ul>
<span class="target" id="index-178"></span><span class="target" id="index-179"></span><span class="target" id="index-180"></span><p id="index-181">In some cases, the type of the project attribute, or at least its default
value, depends on what the attribute applies to. The project file support this
in the form of indexed project attribute. This is for instance used to specify
what should be the name of the executable generated when compiling each of the
main files in the project (ie the executable name for <cite>gps.adb</cite> should be
<cite>gps.exe</cite>, the one for <cite>main.c</cite> should be <cite>myapp.exe</cite>, and so on).</p>
<p>Such attributes can also be declared through XML files. In such cases, the
<cite>&lt;project_attribute&gt;</cite> tag should have one <cite>&lt;index&gt;</cite> child, and zero or more
<cite>&lt;specialized_index&gt;</cite> children.  Each of these two tags in turn take one of the
already mentioned <cite>&lt;string&gt;</cite>, <cite>&lt;choice&gt;</cite> or <cite>&lt;shell&gt;</cite> tag.</p>
<p>The <cite>&lt;index&gt;</cite> tag indicates what other project attribute is used to index the
current one. In the example given above for the executable names, the index is
the attribute that contains the list of main files for the project.</p>
<p>It accepts the following XML attributes:</p>
<ul>
<li><p class="first"><cite>attribute</cite> (a string, mandatory)</p>
<p>The name of the other attribute. This other attribute must be declared
elsewhere in the customization files, and must be a list of values, not a
single value.</p>
</li>
<li><p class="first"><cite>package</cite> (a string, default value: &#8220;&#8221;)</p>
<p>The package in which the index project attribute is defined. This is
used to uniquely identify homonym attributes.</p>
</li>
</ul>
<p>The <cite>&lt;specialized_index&gt;</cite> is used to override the default type of the attribute
for specific values of the index. For instance, the project files contains an
attribute that specify what the name of the compiler is for each language. It
is indexed on the project attribute that list the languages used for the source
files of the project. Its default value depends on the language (&#8220;gnatmake&#8221; for
Ada, &#8220;gcc&#8221; for C, and so on). This attribute accepts requires one XML
attribute:</p>
<ul>
<li><p class="first"><cite>value</cite> (a string, mandatory)</p>
<p>This is the value of the attribute for which the type is overriden.</p>
</li>
</ul>
<p>Note that almost all the standard project attributes are defined through an XML
file, <tt class="file docutils literal"><span class="pre">projects.xml</span></tt>, which is part of the GPS installation. Check this
file to get advanced examples on how to declare project attributes.</p>
</div>
<div class="section" id="examples">
<h4>16.5.15.3. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h4>
<p>The following example declares three attributes, with a single string as their
value. This string represents a file or a directory in the last two cases. You
can simply copy this into a <tt class="file docutils literal"><span class="pre">.xml</span></tt> file in your
<tt class="file docutils literal"><span class="pre">$HOME/.gps/plug-ins</span></tt> directory, as usual:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;custom&gt;</span>
  <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;Single1&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests single&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Single&quot;</span>
      <span class="na">description=</span><span class="s">&quot;Any string&quot;</span><span class="nt">&gt;</span>

     <span class="nt">&lt;string</span> <span class="na">default=</span><span class="s">&quot;Default value&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>

  <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;File1&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests single&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Single&quot;</span>
      <span class="na">description=</span><span class="s">&quot;Any file&quot;</span> <span class="nt">&gt;</span>

      <span class="nt">&lt;string</span> <span class="na">type=</span><span class="s">&quot;file&quot;</span> <span class="na">default=</span><span class="s">&quot;/my/file&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>

  <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;Directory1&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests single&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Single&quot;</span>
      <span class="na">description=</span><span class="s">&quot;Any directory&quot;</span> <span class="nt">&gt;</span>

      <span class="nt">&lt;string</span> <span class="na">type=</span><span class="s">&quot;directory&quot;</span> <span class="na">default=</span><span class="s">&quot;/my/directory/&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>
<span class="nt">&lt;/custom&gt;</span>
</pre></div>
</div>
<p>The following example declares an attribute whose value is a
string. However, a list of predefined possible values is also
provided, as an help for interactive edition for the user. If the
<cite>&lt;string&gt;</cite> tag wasn&#8217;t given, the attribute&#8217;s value would have two
be one of the three possible choices:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;custom&gt;</span>
  <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;Static2&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests single&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Single&quot;</span>
      <span class="na">description=</span><span class="s">&quot;Choice from static list (or any string)&quot;</span> <span class="nt">&gt;</span>

      <span class="nt">&lt;choice&gt;</span>Choice1<span class="nt">&lt;/choice&gt;</span>
      <span class="nt">&lt;choice</span> <span class="na">default=</span><span class="s">&quot;true&quot;</span> <span class="nt">&gt;</span>Choice2<span class="nt">&lt;/choice&gt;</span>
      <span class="nt">&lt;choice&gt;</span>Choice3<span class="nt">&lt;/choice&gt;</span>
      <span class="nt">&lt;string</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>
<span class="nt">&lt;/custom&gt;</span>
</pre></div>
</div>
<p>The following example declares an attribute whose value is one of the
languages currently supported by GPS. Since this list of languages is
only know when GPS is executed, a script command is used to query this
list:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;custom&gt;</span>
 <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;Dynamic1&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests single&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Single&quot;</span>
      <span class="na">description=</span><span class="s">&quot;Choice from dynamic list&quot;</span> <span class="nt">&gt;</span>

      <span class="nt">&lt;shell</span> <span class="na">default=</span><span class="s">&quot;C&quot;</span> <span class="nt">&gt;</span>supported_languages<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>
<span class="nt">&lt;/custom&gt;</span>
</pre></div>
</div>
<p>The following example declares an attribute whose value is a set of
file names. The order of files in this list matters to the tools that
are using this project attribute:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;custom&gt;</span>
 <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;File_List1&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests list&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Lists&quot;</span>
      <span class="na">list=</span><span class="s">&quot;true&quot;</span>
      <span class="na">ordered=</span><span class="s">&quot;true&quot;</span>
      <span class="na">description=</span><span class="s">&quot;List of any file&quot;</span> <span class="nt">&gt;</span>

      <span class="nt">&lt;string</span> <span class="na">type=</span><span class="s">&quot;file&quot;</span> <span class="na">default=</span><span class="s">&quot;Default file&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>
<span class="nt">&lt;/custom&gt;</span>
</pre></div>
</div>
<p>The following example declares an attribute whose value is a set of
predefined possible values. By default, two such values are selected,
unless the user overrides this default setting:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;custom&gt;</span>
  <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;Static_List1&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests list&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Lists&quot;</span>
      <span class="na">list=</span><span class="s">&quot;true&quot;</span>
      <span class="na">description=</span><span class="s">&quot;Any set of values from a static list&quot;</span> <span class="nt">&gt;</span>

      <span class="nt">&lt;choice&gt;</span>Choice1<span class="nt">&lt;/choice&gt;</span>
      <span class="nt">&lt;choice</span> <span class="na">default=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>Choice2<span class="nt">&lt;/choice&gt;</span>
      <span class="nt">&lt;choice</span> <span class="na">default=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>Choice3<span class="nt">&lt;/choice&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>
<span class="nt">&lt;/custom&gt;</span>
</pre></div>
</div>
<p>The following example declares an attribute whose value is a
string. However, the value is specific to each language (this could
for instance be used for the name of the compiler to use for a given
language). This is an indexed project attribute. It has two default
values, one for Ada, one for C. All other languages have no default
value:</p>
<div class="highlight-xml"><pre>&lt;?xml version="1.0" ?&gt;
&lt;custom&gt;
  &lt;project_attribute
      name="Compiler_Name"
      package="Test"
      editor_page="Tests indexed"
      editor_section="Single"
      &lt;index attribute="languages" package=""&gt;
         &lt;string default="" /&gt;
      &lt;/index&gt;
      &lt;specialized_index value="Ada" &gt;
         &lt;string default="gnatmake" /&gt;
      &lt;/specialized_index&gt;
      &lt;specialized_index value="C" &gt;
         &lt;string default="gcc" /&gt;
      &lt;/specialized_index&gt;
  &lt;/project_attribute&gt;
&lt;/custom&gt;</pre>
</div>
</div>
<div class="section" id="accessing-the-project-attributes">
<h4>16.5.15.4. Accessing the project attributes<a class="headerlink" href="#accessing-the-project-attributes" title="Permalink to this headline">¶</a></h4>
<p>The new attributes that were defined are accessible from the GPS scripting
languages, like all the standard attributes, <a class="reference internal" href="#querying-project-switches"><em>Querying project switches</em></a>.</p>
<p>You can for instance access the Compiler_Name attribute we created above with a
python command similar to:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">root</span><span class="p">()</span><span class="o">.</span><span class="n">get_attribute_as_string</span> <span class="p">(</span><span class="s">&quot;Compiler_Name&quot;</span><span class="p">,</span> <span class="s">&quot;Test&quot;</span><span class="p">,</span> <span class="s">&quot;Ada&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also access the list of main files for the project, for
instance, by calling:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">root</span><span class="p">()</span><span class="o">.</span><span class="n">get_attribute_as_list</span> <span class="p">(</span><span class="s">&quot;main&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="adding-casing-exceptions">
<span id="id21"></span><h3>16.5.16. Adding casing exceptions<a class="headerlink" href="#adding-casing-exceptions" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-182"></span><p>A set of case exceptions can be declared in this file. Each case
exception is put inside the tag <cite>&lt;word&gt;</cite> or <cite>&lt;substring&gt;</cite>. These
exceptions are used by GPS to set identifiers or keywords case when
editing case insensitive languages (except if corresponding case is
set to Unchanged). <a class="reference internal" href="#the-preferences-dialog"><em>The Preferences Dialog</em></a>:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;exceptions&gt;</span>
  <span class="nt">&lt;case_exceptions&gt;</span>
     <span class="nt">&lt;word&gt;</span>GNAT<span class="nt">&lt;/word&gt;</span>
     <span class="nt">&lt;word&gt;</span>OS_Lib<span class="nt">&lt;/word&gt;</span>
     <span class="nt">&lt;substring&gt;</span>IO<span class="nt">&lt;/substring&gt;</span>
  <span class="nt">&lt;/case_exceptions&gt;</span>
<span class="nt">&lt;/exceptions&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-documentation">
<span id="id22"></span><h3>16.5.17. Adding documentation<a class="headerlink" href="#adding-documentation" title="Permalink to this headline">¶</a></h3>
<p id="index-184">New documentation can be added in GPS in various ways. This is useful if you
want to point to your own project documentation for instance.</p>
<p>The first possibility is to create a new menu, through a <cite>&lt;menu&gt;</cite> tag in an XML
file, associated with an action that either spawn an external web browser or
calls the internal <cite>GPS.Help.browse()</cite> shell command.</p>
<p>However, this will not show the documentation in the <cite>Help-&gt;Contents</cite> menu,
which you also might want to do.</p>
<p>To have both results, you should use the <cite>&lt;documentation_file&gt;</cite> tag in an XML
file. These tags are generally found in the <tt class="file docutils literal"><span class="pre">gps_index.xml</span></tt> files, as
documented in <a class="reference internal" href="help.html#adding-new-help-files"><em>Adding New Help Files</em></a>, but you can in fact add them in any
of your customization files.</p>
<p>The documentation files you display can contain the usual type of html links.
In addition, GPS will treat specially links starting with &#8216;%&#8217;, and consider
them as script commands to execute instead of file to display. The following
example show how to insert a link that will in effect open a file in GPS when
clicked by the user:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;%shell:Editor.editor g-os_lib.ads&quot;</span><span class="nt">&gt;</span>Open runtime file<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
<p>The first word after &#8216;%&#8217; is the name of the language, and the command to
execute is found after the &#8216;:&#8217; character.</p>
<p>The <cite>&lt;documentation_file&gt;</cite> accepts a number of child nodes:</p>
<dl class="docutils">
<dt><em>name</em></dt>
<dd><p class="first">This is the name of the file. It can be either an absolute file name,
or a file name relative to one of the directories in <cite>GPS_DOC_PATH</cite>.
If this child is omitted, you must specify a <cite>&lt;shell&gt;</cite> child.</p>
<p>This name can contain a reference to a specific anchor in the html
file, using the standard HTML syntax:</p>
<div class="last highlight-xml"><div class="highlight"><pre><span class="nt">&lt;name&gt;</span>file#anchor<span class="nt">&lt;/name&gt;</span>
</pre></div>
</div>
</dd>
<dt><em>shell</em></dt>
<dd>This child specifies the name of a shell command to execute to get the
name of the HTML file. This command can for instance create the HTML file
dynamically, or download it locally using some special mechanism.
This child accepts one attribute, <cite>&#8220;lang&#8221;</cite>, which is the name of the
language in which the command is written</dd>
<dt><em>descr</em></dt>
<dd>This is the description for this help file. It appears in a tool tip
for the menu item.</dd>
<dt><em>category</em></dt>
<dd>This is used in the <cite>Help-&gt;Contents</cite> menu to organize all the
documentation files.</dd>
<dt><em>menu</em></dt>
<dd><p class="first">This is the full path to the menu. It behaves like a UNIX path, except
it reference the various menus, starting from the menu bar itself. The
first character of this path must be <cite>&#8220;/&#8221;</cite>. The last part of the
path is the name of the new menu item. If not set, no menu is
displayed for this file, although it will still appear in the
<cite>Help-&gt;Contents</cite> menu</p>
<p>The <cite>&lt;menu&gt;</cite> child tag accepts two attributes.</p>
<dl class="last docutils">
<dt><em>before (optional, default=&#8221;&#8221;)</em></dt>
<dd>The name of the menu before which the new entry should be inserted. If the
new menu is inserted in some submenus, this tag controls the deeper
nesting.  Parent menus are created as needed, but if you wish to control
their specific order, you should create them first with a <cite>&lt;menu&gt;</cite> tag.</dd>
<dt><em>after (optional, default=&#8221;&#8221;)</em></dt>
<dd>The name of the menu after which the new entry should be inserted.</dd>
</dl>
</dd>
</dl>
<p>The following example shows how to create a new entry &#8220;item&#8221; in the Help
menu, that will display <tt class="file docutils literal"><span class="pre">file.html</span></tt>. The latter is searched in the
<cite>GPS_DOC_PATH</cite> list of directories:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;index&gt;</span>
   <span class="nt">&lt;documentation_file&gt;</span>
      <span class="nt">&lt;name&gt;</span>file.html<span class="nt">&lt;/name&gt;</span>
      <span class="nt">&lt;descr&gt;</span>Tooltip text<span class="nt">&lt;/descr&gt;</span>
      <span class="nt">&lt;category&gt;</span>name<span class="nt">&lt;/category&gt;</span>
      <span class="nt">&lt;menu&gt;</span>/Help/item<span class="nt">&lt;/menu&gt;</span>
   <span class="nt">&lt;/documentation_file&gt;</span>
<span class="nt">&lt;/index&gt;</span>
</pre></div>
</div>
<p id="index-185">As mentioned above, HTML files are looked for through the <cite>GPS_DOC_PATH</cite>
environment variable. However, you can also use the <cite>&lt;doc_path&gt;</cite> XML
node to defined additional directories to be searched.</p>
<p>Such a directory is relative to the installation directory of GPS:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;GPS&gt;</span>
   <span class="nt">&lt;doc_path&gt;</span>doc/application/<span class="nt">&lt;/doc_path&gt;</span>
<span class="nt">&lt;/GPS&gt;</span>
</pre></div>
</div>
<p>will add the directory <tt class="file docutils literal"><span class="pre">&lt;prefix&gt;/doc/application</span></tt> to the search path
for the documentation.</p>
<p>Such a directory can also be added through Python, as in:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">HTML</span><span class="o">.</span><span class="n">add_doc_directory</span> <span class="p">(</span><span class="s">&#39;doc/application&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-stock-icons">
<span id="id23"></span><h3>16.5.18. Adding stock icons<a class="headerlink" href="#adding-stock-icons" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-186"></span><p id="index-187">XML files can be used to define &#8216;stock icons&#8217;. Stock icons are pictures that
are identified by their label, and which are used through GPS in various
places, such as buttons, menus, toolbars, and so on.</p>
<p>The stock icons must be declared using the tag <cite>&lt;icon&gt;</cite>, within the global tag
<cite>&lt;stock&gt;</cite>. The attribute <cite>id</cite> indicates the label used to identify the stock
icon, and the attribute <cite>file</cite> points to the file which contains the actual
picture, either in absolute format, or relative to the directory which contains
the XML file.</p>
<p>If the stock icon is to be used in a toolbar, use the attribute <cite>label</cite> to
specify the text to display in the toolbar, under the button, when the toolbar
is configured to show text.</p>
<p>For icons that are intended to be displayed at multiple sizes, you can specify
multiple files corresponding to these multiple sizes. This is done by adding
children to the main icon node, with the tag <cite>alternate</cite>, containing a <cite>file</cite>
attribute and a <cite>size</cite> attribute which correspond to the size for which this
alternate source should be used.</p>
<p>Possible sizes are:</p>
<dl class="docutils">
<dt><em>1</em></dt>
<dd>Menu item (ideal size: 16x16 pixels)</dd>
<dt><em>2</em></dt>
<dd>Button in a small toolbar (ideal size: 18x18 pixels)</dd>
<dt><em>3</em></dt>
<dd>Button in a large toolbar (ideal size: 24x24 pixels)</dd>
<dt><em>4</em></dt>
<dd>Image for a standard button (ideal size: 20x20 pixels)</dd>
<dt><em>5</em></dt>
<dd>Image used during drag-and-drop operation (ideal size: 32x32 pixels)</dd>
<dt><em>6</em></dt>
<dd>Main image in a dialog (ideal size: 48x48 pixels)</dd>
</dl>
<p>Here is an example:</p>
<div class="highlight-xml"><pre>&lt;?xml version="1.0"?&gt;
&lt;my_visual_preferences&gt;
  &lt;stock&gt;
    &lt;icon id="myproject-my-picture" file="icons/my-picture.png" /&gt;

    &lt;icon id="myproject-multipurpose-image"
           label="do something"
           file="icons/icon_default.png"&gt;
       &lt;alternate file"icons/icon_16.png" size="menu" /&gt;
       &lt;alternate file"icons/icon_24.png" size="large_toolbar" /&gt;
       &lt;alternate file"icons/icon_20.png" size="button" /&gt;
    &lt;/icon&gt;

  &lt;/stock&gt;
&lt;/my_visual_preferences&gt;</pre>
</div>
<p>Note: as shown in the example above, it is a good practice to prefix the label
by a unique name (e.g. <cite>myproject-</cite>), in order to make sure that
predefined stock icons will not get overridden by your icons.</p>
</div>
<div class="section" id="remote-programming-customization">
<span id="id24"></span><h3>16.5.19. Remote programming customization<a class="headerlink" href="#remote-programming-customization" title="Permalink to this headline">¶</a></h3>
<p id="index-188">The configuration of the remote programming functionality has two
separate parts: the tools configuration (remote connection tools,
shells, and rsync parameters) and the servers configuration.</p>
<p>The first part (see <a class="reference internal" href="#defining-a-remote-connection-tool"><em>Defining a remote connection tool</em></a>,
<a class="reference internal" href="#defining-a-shell"><em>Defining a shell</em></a> and <a class="reference internal" href="#configuring-rsync-usage"><em>Configuring rsync usage</em></a>) is handled by a
pre-installed file in the plug-ins directory called <tt class="file docutils literal"><span class="pre">protocols.xml</span></tt>.</p>
<p>The second part (see <a class="reference internal" href="#defining-a-remote-server"><em>Defining a remote server</em></a> and
<a class="reference internal" href="#defining-a-remote-path-translation"><em>Defining a remote path translation</em></a>), when configured via the user
interface (see <a class="reference internal" href="remote.html#setup-the-remote-servers"><em>Setup the remote servers</em></a>), will create a remote.xml file
in the user&#8217;s gps directory. System-wide servers can be also installed.</p>
<div class="section" id="defining-a-remote-connection-tool">
<span id="id25"></span><h4>16.5.19.1. Defining a remote connection tool<a class="headerlink" href="#defining-a-remote-connection-tool" title="Permalink to this headline">¶</a></h4>
<p id="index-189">Several remote access tools are already defined in GPS: ssh, rsh,
telnet and plink. It is possible to add other tools, using the node
<cite>remote_connection_config</cite>.</p>
<p>The attributes for this node are:</p>
<dl class="docutils">
<dt><em>name (string) (mandatory)</em></dt>
<dd>The name of the tool. This name does not necessarilly correspond to
the command used to launch the tool.</dd>
</dl>
<p>The following children are defined:</p>
<dl class="docutils">
<dt><em>start_command (mandatory)</em></dt>
<dd><p class="first">The command used to launch the tool.
This tag supports the <cite>use_pipes</cite> attribute. This attribute selects on
Windows the way GPS will launch the remote tools, and can take the following
values:</p>
<dl class="docutils">
<dt><em>true</em></dt>
<dd>use pipes to launch the tool.</dd>
<dt><em>false (default)</em></dt>
<dd>use a tty emulation, which is a bit slower but allow
password prompts retrieval with some tools.</dd>
</dl>
<p class="last">Note that this argument has effects only on Windows platforms.</p>
</dd>
<dt><em>start_command_common_args (optional)</em></dt>
<dd><p class="first">The arguments that are provided to the tool. This string can contain the
following replacement macros:</p>
<dl class="docutils">
<dt><em>%C</em></dt>
<dd>is replaced by the command executed on the remote host (e.g. the shell
command)</dd>
<dt><em>%h</em></dt>
<dd>is replaced by the remote host name</dd>
<dt><em>%U</em></dt>
<dd>is replaced by the start_command_user_args, if a user is specified</dd>
<dt><em>%u</em></dt>
<dd>is replaced by the user name</dd>
</dl>
<p class="last">Note that if neither %u nor %U is found, and a user is specified in the remote
connection configuration, then the start_command_user_args is placed at the
beginning of the arguments.</p>
</dd>
<dt><em>start_command_user_args (optional)</em></dt>
<dd>The arguments used to define a specific user during connection. %u is replaced
by the user name</dd>
<dt><em>send_interrupt (optional)</em></dt>
<dd>The characters sequence to send to the remote tool to interrupt the remote
application. If unset, then an Interrupt signal is sent directly to the remote
tool.</dd>
<dt><em>user_prompt_ptrn (optional)</em></dt>
<dd>A regular expression, used to catch user name prompts from the
connection tool. If undefined, a default regular expression is used.</dd>
<dt><em>password_prompt_ptrn (optional)</em></dt>
<dd><p class="first last" id="index-190">A regular expression, used to catch password prompts from the
connection tool. If undefined, a default regular expression is used.</p>
</dd>
<dt><em>passphrase_prompt_ptrn (optional)</em></dt>
<dd>A regular expression, used to catch passphrase prompts from the
connection tool. If undefined, a default regular expression is used.</dd>
<dt><em>extra_ptrn (optional)</em></dt>
<dd>Complex child. Used to catch extra prompts from the connection tool,
other than password, passphrase or usename prompts. This tag has an
attribute <cite>auto_answer</cite> telling if GPS automatically answers to
this prompt, or ask the user. If auto_answer is <cite>true</cite>, then this
tag needs an <cite>answer</cite> child, whose value is used for the answer. If
auto_answer is <cite>false</cite>, then this tag needs a <cite>question</cite> child,
whose value is used as question to the end user.</dd>
</dl>
</div>
<div class="section" id="defining-a-shell">
<span id="id26"></span><h4>16.5.19.2. Defining a shell<a class="headerlink" href="#defining-a-shell" title="Permalink to this headline">¶</a></h4>
<p id="index-191">Several shells are already defined in GPS: sh, bash, csh, tcsh and
cmd.exe (Windows). It is possible to add other shells, using the node
<cite>remote_shell_config</cite>.</p>
<p>The attributes for this node are:</p>
<dl class="docutils">
<dt><em>name (string) (mandatory)</em></dt>
<dd>The name of the shell. This name does not necessarilly correspond to
the command used to launch the shell.</dd>
</dl>
<p>The following children are defined:</p>
<dl class="docutils">
<dt><em>start_command (mandatory)</em></dt>
<dd>The command used to launch the shell. If arguments are required, they
should be put here, separated with spaces.</dd>
<dt><em>generic_prompt (optional)</em></dt>
<dd>The regular expression used to identify a prompt after the initial
connection. If not set, a default value is used.</dd>
<dt><em>gps_prompt (mandatory)</em></dt>
<dd>The regular expression used to identify a prompt after the initial
setup is performed. If not set, a default value is used.</dd>
<dt><em>filesystem (mandatory)</em></dt>
<dd>Takes the following values: <cite>unix</cite> or <cite>windows</cite>. This is the
filesystem used by the shell.</dd>
<dt><em>init_commands (optional)</em></dt>
<dd>Complex child. Each <cite>cmd</cite> child contains a command used to
initialise a new session.</dd>
<dt><em>exit_commands (optional)</em></dt>
<dd>Complex child. Each <cite>cmd</cite> child contains a command used to
exit a session.</dd>
<dt><em>no_echo_command (optional)</em></dt>
<dd>Command used to suppress the echo of the remote shell.</dd>
<dt><em>cd_command (mandatory)</em></dt>
<dd>Command used to go to a directory. <cite>%d</cite> is replaced by the
directory&#8217;s full name.</dd>
<dt><em>get_status_command (mandatory)</em></dt>
<dd>Command used to retrieve the status of the last command launched.</dd>
<dt><em>get_status_ptrn (mandatory)</em></dt>
<dd>Regular expression used to retrieve the status returned by
<cite>get_status_command</cite>. A pair of parenthesis is required, and
identifies the status.</dd>
</dl>
</div>
<div class="section" id="configuring-rsync-usage">
<span id="id27"></span><h4>16.5.19.3. Configuring rsync usage<a class="headerlink" href="#configuring-rsync-usage" title="Permalink to this headline">¶</a></h4>
<p id="index-192">GPS has native support for the rsync tool, for paths synchronization
during remote programming operations.</p>
<p>By default, GPS will use &#8211;rsh=ssh option if ssh is the main
connection tool for the concerned server. It will also define the -L
switch when transfering files to a Windows local host.</p>
<p>It is possible to define additional arguments to rsync using the
<cite>rsync_configuration</cite> tag.</p>
<p>This tag accepts the child tagged <cite>arguments</cite>, and containing
additional arguments to pass to rsync.</p>
</div>
<div class="section" id="defining-a-remote-server">
<span id="id28"></span><h4>16.5.19.4. Defining a remote server<a class="headerlink" href="#defining-a-remote-server" title="Permalink to this headline">¶</a></h4>
<span class="target" id="index-193"></span><p id="index-194">Remote servers can be defined via the user interface, as described in
<a class="reference internal" href="remote.html#setup-the-remote-servers"><em>Setup the remote servers</em></a>. This user interface will create a
remote.xml file in the user&#8217;s gps directory, which in turn can be
installed in any plug-ins directory to set the values
system-wide. This file will define for each server the node
<cite>remote_machine_descriptor</cite>.</p>
<p>The attributes for this node are:</p>
<dl class="docutils">
<dt><em>nickname (mandatory)</em></dt>
<dd>Identifies uniquely the server in GPS.</dd>
<dt><em>network_name (mandatory)</em></dt>
<dd>The server&#8217;s network name or IP address.</dd>
<dt><em>remote_access (mandatory)</em></dt>
<dd>The tool&#8217;s name used to access the server. Shall point to one of the
tools defined in <a class="reference internal" href="#defining-a-remote-connection-tool"><em>Defining a remote connection tool</em></a>.</dd>
<dt><em>remote_shell (mandatory)</em></dt>
<dd>The shell&#8217;s name used to access the server. Shall point to one of the
shells defined in <a class="reference internal" href="#defining-a-shell"><em>Defining a shell</em></a>.</dd>
<dt><em>remote_sync (mandatory)</em></dt>
<dd>The remote file synchronisation tool used to synchronize files between
the local host and the server. Only <cite>rsync</cite> is recognized currently.</dd>
<dt><em>debug_console (optional)</em></dt>
<dd>Can take the value <cite>True</cite> or <cite>False</cite>. Tells if a debug console
should be displayed during connection with a remote host. False by default.</dd>
</dl>
<p>The children for this node are:</p>
<dl class="docutils">
<dt><em>extra_init_commands (optional)</em></dt>
<dd>Complex child. Can contain <cite>cmd</cite> children whose values are used
to set server specific initialization commands.</dd>
<dt><em>max_nb_connections (optional)</em></dt>
<dd>Positive number representing the maximum number of simultaneous
connections GPS can launch.</dd>
<dt><em>timeout (optional)</em></dt>
<dd>Positive number representing a timeout value (in ms) used for every
action performed on the remote host.</dd>
</dl>
</div>
<div class="section" id="defining-a-remote-path-translation">
<span id="id29"></span><h4>16.5.19.5. Defining a remote path translation<a class="headerlink" href="#defining-a-remote-path-translation" title="Permalink to this headline">¶</a></h4>
<span class="target" id="index-195"></span><span class="target" id="index-196"></span><p id="index-197">Remote path translation can also be defined via the user interface, as
described in <a class="reference internal" href="remote.html#setup-the-remote-servers"><em>Setup the remote servers</em></a>. The remote paths
translation are defined with the node <cite>remote_path_config</cite>.</p>
<p>The attributes for this node are:</p>
<dl class="docutils">
<dt><em>server_name (mandatory)</em></dt>
<dd>The server name concerned by the paths translation.</dd>
</dl>
<p>The <cite>remote_path_config</cite> node contains <cite>mirror_path</cite>
children.</p>
<p>The attributes for the node <cite>mirror_path</cite> are:</p>
<dl class="docutils">
<dt><em>local_path (mandatory)</em></dt>
<dd>The absolute local path, expressed using the local filesystem
standards.</dd>
<dt><em>remote_path (mandatory)</em></dt>
<dd>The absolute remote path, expressed using the remote filesystem
standards.</dd>
<dt><em>sync (mandatory)</em></dt>
<dd>Specify the synchronization mechanism used for the paths (see
<a class="reference internal" href="remote.html#paths-settings"><em>Paths settings</em></a>). Possible values are <cite>NEVER</cite>, <cite>ONCE_TO_LOCAL</cite>,
<cite>ONCE_TO_REMOTE</cite> and <cite>ALWAYS</cite>.</dd>
</dl>
</div>
</div>
<div class="section" id="customizing-build-targets-and-models">
<span id="id30"></span><h3>16.5.20. Customizing build Targets and Models<a class="headerlink" href="#customizing-build-targets-and-models" title="Permalink to this headline">¶</a></h3>
<p>The information displayed in <a class="reference internal" href="compilation.html#the-target-configuration-dialog"><em>The Target Configuration Dialog</em></a> and in
the Mode selection can be customized through XML.</p>
<div class="section" id="defining-new-target-models">
<span id="id31"></span><h4>16.5.20.1. Defining new Target Models<a class="headerlink" href="#defining-new-target-models" title="Permalink to this headline">¶</a></h4>
<p id="index-198">Models are defined in a <cite>target-model</cite> node which has one attributes,
<cite>name</cite>, which contains the name of the model, and which supports the
following sub-nodes:</p>
<dl class="docutils">
<dt><em>&lt;icon&gt;</em></dt>
<dd>The stock name of the icon to associate by default with targets of this
model.</dd>
<dt><em>&lt;description&gt;</em></dt>
<dd>A one-line description of what the Model supports</dd>
<dt><em>&lt;server&gt;</em></dt>
<dd>Optional, defaulting to <cite>Build_Server</cite>. Indicates the server used for
launching Targets of this model. <a class="reference internal" href="remote.html#remote-operations"><em>Remote operations</em></a>.</dd>
<dt><em>&lt;is-run&gt;</em></dt>
<dd>Optional, defaulting to <cite>False</cite>. A boolean indicating whether this
target corresponds to the launching of an executable rather than a build.
Targets with such a model are launched through an interactive console in
GPS, and their output is not parsed for errors.</dd>
<dt><em>&lt;uses-shell&gt;</em></dt>
<dd>Optional, defaulting to <cite>False</cite>. A boolean indicating whether Targets
of this model should be launched via the shell pointed to by the SHELL
environment variable.</dd>
<dt><em>&lt;command-line&gt;</em></dt>
<dd>Contains a number of <cite>&lt;arg&gt;</cite> nodes, each containing an argument of the
default command line for this model, starting with the executable.</dd>
</dl>
<dl class="docutils">
<dt><em>&lt;switches command=&#8221;executable_name&#8221;&gt;</em></dt>
<dd><p class="first">The graphical description of the switches.
(<a class="reference internal" href="#defining-tool-switches"><em>Defining tool switches</em></a>):</p>
<div class="last highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
   <span class="nt">&lt;my_model&gt;</span>
   <span class="nt">&lt;target-model</span> <span class="na">name=</span><span class="s">&quot;gprclean&quot;</span> <span class="na">category=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;description&gt;</span>Clean compilation artefacts with gprclean<span class="nt">&lt;/description&gt;</span>
      <span class="nt">&lt;command-line&gt;</span>
         <span class="nt">&lt;arg&gt;</span>gprclean<span class="nt">&lt;/arg&gt;</span>
         <span class="nt">&lt;arg&gt;</span>-P%PP<span class="nt">&lt;/arg&gt;</span>
         <span class="nt">&lt;arg&gt;</span>%X<span class="nt">&lt;/arg&gt;</span>
      <span class="nt">&lt;/command-line&gt;</span>
      <span class="nt">&lt;icon&gt;</span>gps-clean<span class="nt">&lt;/icon&gt;</span>
      <span class="nt">&lt;switches</span> <span class="na">command=</span><span class="s">&quot;%(tool_name)s&quot;</span> <span class="na">columns=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;check</span> <span class="na">label=</span><span class="s">&quot;Clean recursively&quot;</span> <span class="na">switch=</span><span class="s">&quot;-r&quot;</span>
                <span class="na">tip=</span><span class="s">&quot;Clean all projects recursively&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/switches&gt;</span>
   <span class="nt">&lt;/target-model&gt;</span>
<span class="nt">&lt;/my_model&gt;</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="defining-new-targets">
<span id="id32"></span><h4>16.5.20.2. Defining new Targets<a class="headerlink" href="#defining-new-targets" title="Permalink to this headline">¶</a></h4>
<p id="index-199">Targets are defined in a <cite>target</cite> node which has three attributes:</p>
<dl class="docutils">
<dt><em>name</em></dt>
<dd>Contains the name of the Target. It must be a unique name.
Underscores are interpreted as menu mnemonics. To represent an actual
underscore, use a double underscore.</dd>
<dt><em>category</em></dt>
<dd>The category which contains the Target, for purposes of ordering the
tree in the Target Configuration Dialog, and for ordering in the Build
menu.Underscores are interpreted as menu mnemonics. To represent an actual
underscore, use a double underscore.
If <cite>category</cite> begins and ends with an underscore, the menu for the
Target is placed in the toplevel Build menu.</dd>
<dt><em>messages_category</em></dt>
<dd>The name of the category to be used to organize messages in Locations
window.</dd>
<dt><em>model</em></dt>
<dd>The name of the Model of which this Target inherits initially.</dd>
<dt><em>&lt;icon&gt;</em></dt>
<dd>The stock name of the icon to associate by default with the Target.</dd>
<dt><em>&lt;in-toolbar&gt;</em></dt>
<dd>Optional, defaulting to <cite>False</cite>. A boolean indicating whether the
Target should have an associated icon in the Toolbar.</dd>
<dt><em>&lt;in-menu&gt;</em></dt>
<dd>Optional, defaulting to <cite>True</cite>. A boolean indicating whether the
Target should have an associated entry in the Build menu.</dd>
<dt><em>&lt;in-contextual-menus-for-projects&gt;</em></dt>
<dd>Optional, defaulting to <cite>False</cite>. A boolean indicating whether the
Target should have an associated entry in the contextual menu for projects.</dd>
<dt><em>&lt;in-contextual-menus-for-files&gt;</em></dt>
<dd>Optional, defaulting to <cite>False</cite>. A boolean indicating whether the
Target should have an associated entry in the contextual menu for files.</dd>
<dt><em>&lt;visible&gt;</em></dt>
<dd>Optional, defaulting to <cite>True</cite>. A boolean indicating whether the
Target should initially be visible in GPS.</dd>
<dt><em>&lt;read-only&gt;</em></dt>
<dd>Optional, defaulting to <cite>False</cite>. A boolean indicating whether the
Target can be removed by the user.</dd>
<dt><em>&lt;target-type&gt;</em></dt>
<dd>Optional, defaulting to an empty string. A string indicating whether the
Target represents a simple target (if empty), or a
family of Targets. The name represents a parameter passed to the
<cite>compute_build_targets</cite> hook. If set to <cite>main</cite>, a new subtarget
will be create for each Main source defined in the project.</dd>
<dt><em>&lt;launch-mode&gt;</em></dt>
<dd>Optional, defaulting to <cite>MANUALLY</cite>. Indicates how the Target should be
launched. Possible values are <cite>MANUALLY</cite>, <cite>MANUALLY_WITH_DIALOG</cite>,
<cite>MANUALLY_WITH_NO_DIALOG</cite>, and <cite>ON_FILE_SAVE</cite>.</dd>
<dt><em>&lt;server&gt;</em></dt>
<dd>Optional, defaulting to <cite>Build_Server</cite>. Indicates the server used for
launching Target. <a class="reference internal" href="remote.html#remote-operations"><em>Remote operations</em></a>.</dd>
<dt><em>&lt;command-line&gt;</em></dt>
<dd><p class="first">Contains a number of <cite>&lt;arg&gt;</cite> nodes, each containing an argument of the
default command line for this Target, starting with the executable:</p>
<div class="last highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;my_target&gt;</span>
   <span class="nt">&lt;target</span> <span class="na">model=</span><span class="s">&quot;gprclean&quot;</span> <span class="na">category=</span><span class="s">&quot;C_lean&quot;</span> <span class="na">name=</span><span class="s">&quot;Clean _All&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;in-toolbar&gt;</span>TRUE<span class="nt">&lt;/in-toolbar&gt;</span>
       <span class="nt">&lt;icon&gt;</span>gps-clean<span class="nt">&lt;/icon&gt;</span>
       <span class="nt">&lt;launch-mode&gt;</span>MANUALLY_WITH_DIALOG<span class="nt">&lt;/launch-mode&gt;</span>
       <span class="nt">&lt;read-only&gt;</span>TRUE<span class="nt">&lt;/read-only&gt;</span>
       <span class="nt">&lt;command-line&gt;</span>
          <span class="nt">&lt;arg&gt;</span>%gprclean<span class="nt">&lt;/arg&gt;</span>
          <span class="nt">&lt;arg&gt;</span>-r<span class="nt">&lt;/arg&gt;</span>
          <span class="nt">&lt;arg&gt;</span>%eL<span class="nt">&lt;/arg&gt;</span>
          <span class="nt">&lt;arg&gt;</span>-P%PP<span class="nt">&lt;/arg&gt;</span>
          <span class="nt">&lt;arg&gt;</span>%X<span class="nt">&lt;/arg&gt;</span>
       <span class="nt">&lt;/command-line&gt;</span>
  <span class="nt">&lt;/target&gt;</span>
<span class="nt">&lt;/my_target&gt;</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="defining-new-modes">
<span id="id33"></span><h4>16.5.20.3. Defining new Modes<a class="headerlink" href="#defining-new-modes" title="Permalink to this headline">¶</a></h4>
<p id="index-200">Modes are defined in a <cite>builder-mode</cite> node which has one attributes,
<cite>name</cite>, which contains the name of the model, and which supports the
following sub-nodes:</p>
<dl class="docutils">
<dt><em>&lt;description&gt;</em></dt>
<dd>A one-line description of what the Mode does</dd>
<dt><em>&lt;subdir&gt;</em></dt>
<dd>Optional. The base name of the subdirectory to create for this Mode.
The macro argument <cite>%subdir</cite> in the <cite>extra-args</cite> nodes will be
substituted with this.</dd>
<dt><em>&lt;supported-model&gt;</em></dt>
<dd>The name of a model supported by this Mode. There can be multiple
<cite>supported-model</cite> nodes, each corresponding to a supported Model.
Optionally, you can specify a <cite>filter</cite> attribute for this node,
corresponding to the switches that are relevant for this mode. By default,
all switches will be taken into account.
The <cite>extra-args</cite> of the Mode that match <cite>filter</cite> will be passed
to commands of the supported Models.</dd>
<dt><em>&lt;extra-args&gt;</em></dt>
<dd><p class="first">Contains a list of <cite>&lt;arg&gt;</cite> nodes, each containing one extra argument
to append to the command line when launching Targets while this Mode is
active.
Macros are supported in the <cite>&lt;arg&gt;</cite> nodes:</p>
<div class="last highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;my_mode&gt;</span>
 <span class="nt">&lt;builder-mode</span> <span class="na">name=</span><span class="s">&quot;optimization&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;description&gt;</span>Build with code optimization activated<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;subdir&gt;</span>optimized_objects<span class="nt">&lt;/subdir&gt;</span>
  <span class="nt">&lt;supported-model&gt;</span>builder<span class="nt">&lt;/supported-model&gt;</span>
  <span class="nt">&lt;supported-model&gt;</span>gnatmake<span class="nt">&lt;/supported-model&gt;</span>
  <span class="nt">&lt;supported-model</span> <span class="na">filter=</span><span class="s">&quot;--subdirs=&quot;</span><span class="nt">&gt;</span>gprclean<span class="nt">&lt;/supported-model&gt;</span>
  <span class="nt">&lt;extra-args&gt;</span>
     <span class="nt">&lt;arg&gt;</span>--subdirs=%subdir<span class="nt">&lt;/arg&gt;</span>
     <span class="nt">&lt;arg&gt;</span>-cargs<span class="nt">&lt;/arg&gt;</span>
     <span class="nt">&lt;arg&gt;</span>-O2<span class="nt">&lt;/arg&gt;</span>
  <span class="nt">&lt;/extra-args&gt;</span>
 <span class="nt">&lt;/builder-mode&gt;</span>
<span class="nt">&lt;/my_mode&gt;</span>
</pre></div>
</div>
</dd>
</dl>
</div>
</div>
<div class="section" id="toolchains-customization">
<span id="id34"></span><h3>16.5.21. Toolchains customization<a class="headerlink" href="#toolchains-customization" title="Permalink to this headline">¶</a></h3>
<p>The list of toolchains and their values presented in the project editor
(<a class="reference internal" href="projects.html#the-project-wizard"><em>The Project Wizard</em></a>) can be customized through XML. The GPS default
list is contained in <cite>toolchains.xml</cite>. You can add your own toolchain
by providing an xml description following the below described structure:</p>
<dl class="docutils">
<dt><em>&lt;toolchain_default&gt;</em></dt>
<dd>Contains the default names for the different tools used by all toolchains.
The final name used will be <cite>toolchain_name-default_name</cite>.</dd>
<dt><em>&lt;toolchain name=&#8221;name&#8221;&gt;</em></dt>
<dd>Defines a toolchain using name &#8220;name&#8221;. This toolchain can override the
default values defined in the toolchain_default above.</dd>
</dl>
<p>Each of the above tags can have the following chilren</p>
<dl class="docutils">
<dt><em>&lt;gnat_driver&gt;</em></dt>
<dd>Defines the gnat driver to use.</dd>
<dt><em>&lt;gnat_list&gt;</em></dt>
<dd>Defines the gnat list tool to use.</dd>
<dt><em>&lt;debugger&gt;</em></dt>
<dd>Defines the debugger to use.</dd>
<dt><em>&lt;cpp_filt&gt;</em></dt>
<dd>Not used by GPS.</dd>
<dt><em>&lt;compiler lang=&#8221;lang&#8221;&gt;</em></dt>
<dd>Defines the compiler to use to compile language &#8220;lang&#8221;</dd>
</dl>
<p>The toolchain_default values can either be overriden or nullified by just
providing the same tab with an empty value in a toolchain definition.</p>
</div>
</div>
<div class="section" id="adding-support-for-new-tools">
<span id="id35"></span><h2>16.6. Adding support for new tools<a class="headerlink" href="#adding-support-for-new-tools" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-201"></span><p id="index-202">GPS has built-in support for external tools. This feature can be used to
support a wide variety of tools (in particular, to specify different
compilers). Regular enhancements are done in this area, so if you are
planning to use the external tool support in GPS, check for the latest GPS
version available.</p>
<p>Typically, the following things need to be achieved to successfully use a
tool:</p>
<ul class="simple">
<li>Specify its command line switches</li>
<li>Pass it the appropriate arguments depending on the current context, or
on user input</li>
<li>Spawn the tool</li>
<li>Optionally parse its result and act accordingly</li>
</ul>
<p>Each of these points is discussed in further sections. In all these cases, most
of the work can be done statically through XML customization files.  These
files have the same format as other XML customization files
(<a class="reference internal" href="#customizing-through-xml-and-python-files"><em>Customizing through XML and Python files</em></a>), and the tool descriptions
are found in <cite>&lt;tool&gt;</cite> tags.</p>
<p>This tag accepts the following attributes:</p>
<dl class="docutils">
<dt><em>name (mandatory)</em></dt>
<dd>This is the name of the tool. This is purely descriptive, and will appear
throughout the GPS interface whenever this tool is referenced. This includes
for instances the tabs of the switches editor.</dd>
<dt><em>package (Default value is ide)</em></dt>
<dd><p class="first">This optional attribute specifies which package should be used in the project
to store information about this tool, in particular its switches. Most of
the time the default value should be used, unless you are working with one of
the predefined packages.</p>
<p>See also <a class="reference internal" href="#defining-project-attributes"><em>Defining project attributes</em></a>, for more information on defining
your own project attributes. Using the &#8220;package&#8221;, &#8220;attribute&#8221; or &#8220;index&#8221;
XML attributes of &lt;tool&gt; will implicitly create new project attributes as
needed.</p>
<p class="last">If this attribute is set to &#8220;ide&#8221;, then the switches cannot be set for a
specific file, only at the project level. Support for file-specific switches
currently requires modification of the GPS sources themselves.</p>
</dd>
<dt><em>attribute (Default value is default_switches)</em></dt>
<dd>This optional attribute specifies the name of the attribute in the project
which is used to store the switches for that tool.</dd>
<dt><em>index (Default value is the tool name)</em></dt>
<dd>This optional attribute specifies what index is used in the project. This is
mostly for internal use by GPS, and describes what index of the project
attribute is used to store the switches for that tool.</dd>
<dt><em>override (Default value is &#8216;false&#8217;)</em></dt>
<dd>This optional attribute specifies whether the tool definition can be
redefined.  The accepted values are &#8216;true&#8217; or &#8216;false&#8217;. If override is not
set, and the tool is defined several times, then a Warning will be displayed.</dd>
</dl>
<p>This tag accepts the following children, described in separate sections:</p>
<dl class="docutils">
<dt><em>&lt;switches&gt;</em></dt>
<dd>(<a class="reference internal" href="#defining-tool-switches"><em>Defining tool switches</em></a>)</dd>
<dt><em>&lt;language&gt;</em></dt>
<dd>(<a class="reference internal" href="#defining-supported-languages"><em>Defining supported languages</em></a>)</dd>
<dt><em>&lt;initial-cmd-line&gt;</em></dt>
<dd>(<a class="reference internal" href="#defining-default-command-line"><em>Defining default command line</em></a>)</dd>
</dl>
<div class="section" id="defining-supported-languages">
<span id="id36"></span><h3>16.6.1. Defining supported languages<a class="headerlink" href="#defining-supported-languages" title="Permalink to this headline">¶</a></h3>
<p id="index-203">This is the language to which the tool applies.  There can be from no to any
number of such nodes for one <cite>&lt;tool&gt;</cite> tag.</p>
<p>If no language is specified, the tool applies to all languages. In particular,
the switches editor page will be displayed for all languages, no matter what
languages they support.</p>
<p>If at least one language is specified, the switches editor page will only be
displayed if that language is supported by the project:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;my_tool&gt;</span>
  <span class="nt">&lt;tool</span> <span class="na">name=</span><span class="s">&quot;My Tool&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;language&gt;</span>Ada<span class="nt">&lt;/language&gt;</span>
    <span class="nt">&lt;language&gt;</span>C<span class="nt">&lt;/language&gt;</span>
  <span class="nt">&lt;/tool&gt;</span>
<span class="nt">&lt;/my_tool&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-default-command-line">
<span id="id37"></span><h3>16.6.2. Defining default command line<a class="headerlink" href="#defining-default-command-line" title="Permalink to this headline">¶</a></h3>
<p id="index-204">It is possible to define the command line that should be used for a tool when
the user is using the default project, or hasn&#8217;t overridden this command line
in the project.</p>
<p>This is done through the <cite>&lt;initial-cmd-line&gt;</cite> tag, as a child of the
<cite>&lt;tool&gt;</cite> tag. Its value is the command line that would be passed to the
tool. This command line is parsed as usual, e.g. quotes are taken into account
to avoid splitting switches each time a space is encountered:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;my_tool&gt;</span>
  <span class="nt">&lt;tool</span> <span class="na">name=</span><span class="s">&quot;My tool&quot;</span> <span class="nt">&gt;</span>
     <span class="nt">&lt;initial-cmd-line&gt;</span>-a -b -c<span class="nt">&lt;/initial-cmd-line&gt;</span>
  <span class="nt">&lt;/tool&gt;</span>
<span class="nt">&lt;/my_tool&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-tool-switches">
<span id="id38"></span><h3>16.6.3. Defining tool switches<a class="headerlink" href="#defining-tool-switches" title="Permalink to this headline">¶</a></h3>
<p id="index-205">The user has to be able to specify which switches to use with the tool.  If the
tool is simply called through custom menus, you might want to hard code some or
all of the switches. However, in the general case it is better to use the
project properties editor, so that project-specific switches can be specified.</p>
<p>This is what GPS does by default for Ada, C and C++. You can find in the GPS
installation directory how the switches for these languages are defined in an
XML file. These provide extended examples of the use of customization files.</p>
<p>The switches editor in the project properties editor provides a powerful
interface to the command line, where the user can edit the command line both as
text and through GUI widgets.</p>
<p>The switches are declared through the <cite>&lt;switches&gt;</cite> tag in the customization
file, which must be a child of a <cite>&lt;tool&gt;</cite> tag as described above.</p>
<p>This <cite>&lt;switches&gt;</cite> tag accepts the following attributes:</p>
<dl class="docutils">
<dt><em>lines (default value is 1)</em></dt>
<dd>The switches in the project properties editor are organized into boxes,
each surrounded by a frame, optionally with a title. This attribute specifies
the number of rows of such frames.</dd>
<dt><em>columns (default value is 1)</em></dt>
<dd>This attribute specifies the number of columns of frames in the project
properties page.</dd>
<dt><em>separator (default value is &#8220;&#8221;)</em></dt>
<dd>This attribute specifies the default character that should go between a switch
and its value, to distinguishes cases like &#8220;-a 1&#8221;, &#8220;-a1&#8221; and &#8220;-a=1&#8221;. This can
be overridden separately for each switch. Note that if you want the separator
to be a space, you must use the value <cite>&#8220;&amp;#32;&#8221;</cite> rather than <cite>&#8221; &#8220;</cite>,
since XML parser must normalize the latter to the empty string when reading
the XML file.</dd>
<dt><em>use_scrolled_window (Default value is false)</em></dt>
<dd>This optional attribute specifies if the boxes of the project editor are
placed into scrolled window. This is particularily useful if the number of
displayed switches if important.</dd>
<dt><em>show_command_line (Default value is true)</em></dt>
<dd>If this attribute is set to &#8220;false&#8221;, the command line will not be displayed
in the project properties editor. This can be used for instance if you only
want users to edit it through the buttons and other widgets, and not directly.</dd>
<dt><em>switch_char (Default value is &#8220;-&#8221;)</em></dt>
<dd>This is the leading character of command line arguments that indicate they
are considered as switches. Arguments not starting with this character will
be kept as is, and cannot have graphical widgets associated with them</dd>
<dt><em>sections (Default value is empty)</em></dt>
<dd>This is a space separated list of switches delimiting a section (such as
&#8220;-bargs -cargs -largs&#8221;). A section of switches is a set of switches that
need to be grouped together and preceded by a specific switch. Sections are
always placed at the end of the command line, after regular switches.</dd>
</dl>
<p>This <cite>&lt;switches&gt;</cite> tag can have any number of child tag, among the
following. They can be repeated multiple times if you need several check boxes.
For consistency, most of these child tags accept attributes among the
following:</p>
<dl class="docutils">
<dt><em>line (default value is 1)</em></dt>
<dd>This indicates the row of the frame that should contain the switch. See the
description of <cite>lines</cite> above.</dd>
<dt><em>column (default value is 1)</em></dt>
<dd>This indicates the column of the frame that should contain the switch. See the
description of <cite>columns</cite> above.</dd>
<dt><em>label (mandatory)</em></dt>
<dd>This is the label which is displayed in the graphical interface</dd>
<dt><em>switch (mandatory)</em></dt>
<dd>This is the text that should be put on the command line if that switch is
selected. Depending on its type, a variant of the text might be put instead,
see the description of <cite>combo</cite> and <cite>spin</cite> below.
This switch shouldn&#8217;t contain any space.</dd>
<dt><em>switch-off (default value is empty)</em></dt>
<dd>This attribute is used for <cite>&lt;check&gt;</cite> tags, and indicates the switch
used for deactivating the concerned feature. This is useful for features that
are on by default on certain occasions, but can be individually deactivated.</dd>
<dt><em>section (default value is empty)</em></dt>
<dd>This is the switch section delimiter (such as &#8220;-cargs&#8221;). See the &#8216;sections&#8217;
attribute of the tag &#8216;switches&#8217; for more information.</dd>
<dt><em>tip (default value is empty)</em></dt>
<dd>This is the tooltip which describes that switch more extensively. It is
displayed in a small popup window if the user leaves the mouse on top of
the widget. Note that tags accepting the tip attribute also accept a single
child <cite>&lt;tip&gt;</cite> whose value will contain the text to be displayed. The
advantage of the latter is that the text formatting is then kept.</dd>
<dt><em>before (default value is &#8220;false&#8221;)</em></dt>
<dd>This attribute is used to indicate that a switch needs to be always inserted
at the begining of the command line.</dd>
<dt><em>min (default value is 1)</em></dt>
<dd>This attribute is used for <cite>&lt;spin&gt;</cite> tags, and indicates the minimum
value authorized for that switch.</dd>
<dt><em>max (default value is 1)</em></dt>
<dd>This attribute is used for <cite>&lt;spin&gt;</cite> tags, and indicates the maximum
value authorized for that switch.</dd>
<dt><em>default (default value is 1)</em></dt>
<dd>This attribute is used for <cite>&lt;check&gt;</cite> and <cite>&lt;spin&gt;</cite> tags. See the
description below.</dd>
<dt><em>noswitch (default is empty)</em></dt>
<dd>This attribute is only valid for <cite>&lt;combo&gt;</cite> tags, and described below.</dd>
<dt><em>nodigit (default is empty)</em></dt>
<dd>This attribute is only valid for <cite>&lt;combo&gt;</cite> tags, and described below.</dd>
<dt><em>value (mandatory)</em></dt>
<dd>This attribute is only valid for <cite>&lt;combo-entry&gt;</cite> tags.</dd>
<dt><em>separator (default is the value given to `&lt;switches&gt;`</em></dt>
<dd>This attribute specifies the separator to use between the switch and its
value.  See the description of this attribute for <cite>&lt;switches&gt;</cite>.</dd>
</dl>
<p>Here are the valid children for <cite>&lt;switches&gt;</cite>:</p>
<dl class="docutils">
<dt><em>&lt;title&gt;</em></dt>
<dd><p class="first" id="index-206">This tag, which accepts the <cite>line</cite> and <cite>column</cite> attributes, is used
to give a name to a specific frame.
The value of the tag is the title itself. You do not have to specify
a name, and this can be left to an empty value.</p>
<p>Extra attributes for <cite>&lt;title&gt;</cite> are:</p>
<dl class="last docutils">
<dt><em>line-span (default value is 1)</em></dt>
<dd>This indicates how many rows the frame should span. If this is set to 0,
then the frame is hidden from the user. See for instance the Ada or C
switches editor.</dd>
<dt><em>column-span (default value is 1)</em></dt>
<dd>This indicates how many columns the frame should span. If this is set to 0,
then the frame is hidden from the user. See for instance the Ada or C
switches editor.</dd>
</dl>
</dd>
<dt><em>&lt;check&gt;</em></dt>
<dd><p class="first" id="index-207">This tag accepts the <cite>line</cite>, <cite>column</cite>, <cite>label</cite>, <cite>switch</cite>, <cite>switch-off</cite>,
<cite>section</cite>, <cite>default</cite>, <cite>before</cite> and <cite>tip</cite> attributes.</p>
<p>This tag doesn&#8217;t have any value. An optional <cite>&lt;tip&gt;</cite> child can be present.</p>
<p class="last">It creates a toggle button. When the latter is active, the text defined in
the switch attribute is added as is to the command line. The switch can be
also activated by default (<cite>default</cite> attribute is &#8220;on&#8221; or &#8220;true&#8221;). In this
case, deactivating the switch will add <cite>switch-off</cite> to the command line.</p>
</dd>
<dt><em>&lt;spin&gt;</em></dt>
<dd><p class="first" id="index-208">This tag accepts the <cite>line</cite>, <cite>column</cite>, <cite>label</cite>, <cite>switch</cite>, <cite>section</cite>, <cite>tip</cite>,
<cite>min</cite>, <cite>max</cite>, <cite>separator</cite> and <cite>default</cite> attributes.</p>
<p>This tag doesn&#8217;t have any value. An optional <cite>&lt;tip&gt;</cite> child can be present.</p>
<p class="last">This switch will add the contents of the <cite>switch</cite> attribute followed by the
current numeric value of the widget to the command line. This is typically
used to indicate indentation length for instance.  If the current value of
the widget is equal to the <cite>default</cite> attribute, then nothing is added to the
command line.</p>
</dd>
<dt><em>&lt;radio&gt;</em></dt>
<dd><p class="first" id="index-209">This tag accepts the <cite>line</cite> and <cite>column</cite> attributes. It groups any number of
children, each of which is associated with its own switch. However, only one
of the children can be selected at any given time.</p>
<p>The children must have the tag <cite>radio-entry</cite>. This tag accepts the attributes
<cite>label</cite>, <cite>switch</cite>, <cite>section</cite>, <cite>before</cite> and <cite>tip</cite>. As a special case, the
switch attribute can have an empty value (&#8220;&#8221;) to indicate this is the default
switch to use in this group of radio buttons.</p>
<p class="last">This tag doesn&#8217;t have any value. An optional <cite>&lt;tip&gt;</cite> child can also be
present.</p>
</dd>
<dt><em>&lt;field&gt;</em></dt>
<dd><p class="first" id="index-210">This tag accepts the <cite>line</cite>, <cite>column</cite>, <cite>label</cite>, <cite>switch</cite>, <cite>section</cite>,
<cite>separator</cite>, <cite>before</cite> and <cite>tip</cite> attributes.</p>
<p>This tag doesn&#8217;t have any value. An optional <cite>&lt;tip&gt;</cite> child can be present.</p>
<p>This tag describes a text edition field, which can contain any text the user
types. This text will be prefixed by the value of the <cite>switch</cite> attribute, and
the separator (by default nothing). If no text is entered in the field by the
user, nothing is put on the command line.</p>
<p>This tag accepts two extra attributes:</p>
<dl class="last docutils">
<dt><em>as-directory  (optional)</em></dt>
<dd><p class="first last" id="index-211">If this attribute is specified and set to &#8220;true&#8221;, then an extra &#8220;Browse&#8221;
button is displayed, so that the user can easily select a directory.</p>
</dd>
<dt><em>as-file (optional)</em></dt>
<dd><p class="first last" id="index-212">This attribute is similar to <cite>as-directory</cite>, but opens a dialog to
select a file instead of a directory. If both attributes are set to &#8220;true&#8221;,
the user will select a file.</p>
</dd>
</dl>
</dd>
<dt><em>&lt;combo&gt;</em></dt>
<dd><span class="target" id="index-213"></span><p class="first" id="index-214">This tag accepts the <cite>line</cite>, <cite>column</cite>, <cite>label</cite>, <cite>switch</cite>, <cite>section</cite>,
<cite>before</cite>, <cite>tip</cite>, <cite>noswitch</cite>, <cite>separator</cite> and <cite>nodigit</cite> attributes.</p>
<p>The tag <cite>&lt;combo&gt;</cite> accepts any number of <cite>combo-entry</cite> children tags,
each of which accepts the <cite>label</cite> and <cite>value</cite> attribute. An optional
<cite>&lt;tip&gt;</cite> child can also be present.</p>
<p>The text inserted in the command line is the text from the <cite>switch</cite>
attribute, concatenated with the text of the <cite>value</cite> attribute for the
currently selected entry. If the value of the current entry is the same
as that of the <cite>nodigit</cite> attribute, then only the text of the
<cite>switch</cite> attribute is put on the command line. This is in fact necessary
to interpret the gcc switch &#8220;-O&#8221; as &#8220;-O1&#8221;.</p>
<p class="last">If the value of the current entry is that of the <cite>noswitch</cite> attribute,
then nothing is put in the command line.</p>
</dd>
<dt><em>&lt;popup&gt;</em></dt>
<dd><p class="first" id="index-215">This tag accepts the <cite>line</cite>, <cite>column</cite>, <cite>label</cite>, <cite>lines</cite> and <cite>columns</cite>
attributes. This displays a simply button that, when clicked, displays a
dialog with some extra switches. This dialog, just as the switches editor
itself, is organizes into lines and columns of frames, the number of which is
provided by the <cite>lines</cite> and <cite>columns</cite> attributes.</p>
<p class="last">This tag accepts any number of children, which are the same as the
<cite>&lt;switches&gt;</cite> attribute itself.</p>
</dd>
<dt><em>&lt;dependency&gt;</em></dt>
<dd><p class="first" id="index-216">This tag is used to describe a relationship between two switches. It is used
for instance when the &#8220;Debug Information&#8221; switch is selected for &#8220;Make&#8221;, which
forces it for the Ada compiler as well.</p>
<p>It has its own set of attributes:</p>
<dl class="last docutils">
<dt><em>master-page master-switch master-section</em></dt>
<dd>These two attributes define the switch that possibly forces a specific
setting on the slave switch. In our example, they would have the values
&#8220;Make&#8221; and &#8220;-g&#8221;.
The switch referenced by these attributes must be of type <cite>&lt;check&gt;</cite>
or <cite>&lt;field&gt;</cite>. If it is part of a section, then &#8216;master-section&#8217; needs
to be defined. If the check button is selected, it forces the
selection of the slave check button. Likewise, if the field is set to
any value, it forces the selection of the slave.</dd>
<dt><em>slave-page slave-switch slave-section</em></dt>
<dd>These two attributes define the switch which is acted upon by the master
switch. In our example, they would have the values &#8220;Ada&#8221; and &#8220;-g&#8221;.
The switch referenced by these attributes must be of type <cite>&lt;check&gt;</cite>.</dd>
<dt><em>master-status slave-status</em></dt>
<dd>These two switches indicate which state of the master switch forces which
state of the slave-status. In our example, they would have the values
&#8220;on&#8221; and &#8220;on&#8221;, so that when the make debug information is activated, the
compiler debug information is also activated. However, if the make debug
information is not activated, no specific setup is forced for the compiler
debug information.
if master-status is &#8220;off&#8221; and the master switch is a field, then the
status of the slave will be changed when no value is set in the field.</dd>
</dl>
</dd>
<dt><em>&lt;default-value-dependency&gt;</em></dt>
<dd><p class="first" id="index-217">This tag is used to describe a relationship between two switches. It is
slightly different from the &lt;dependency&gt; tag in that the relationship concerns
only the default activation states. It is used for instance when the &#8220;-gnatwa&#8221;
switch is selected for the &#8220;Ada&#8221; Compiler, which imply that the default values
for &#8220;-gnatwc&#8221;, &#8220;-gnatwd&#8221;, etc. become activated by default. They can however
still be deactivated with respectively &#8220;-gnatwC&#8221; and &#8220;-gnatwD&#8221;.</p>
<p>It has its own set of attributes:</p>
<dl class="last docutils">
<dt><em>master-switch</em></dt>
<dd>This is the switch that triggers the dependency. If <cite>master-switch</cite> is
present in the command line, then the switch&#8217;s default status of
<cite>slave-switch</cite> is modified accordingly.</dd>
<dt><em>slave-switch</em></dt>
<dd>This is the switch whose default value depends on <cite>master-switch</cite>. This
needs to be a switch already defined in a <cite>&lt;switch&gt;</cite> tag. It can match
its &#8216;switch&#8217; or &#8216;switch-off&#8217; attributes. In the latter case, the
slave-switch default value is deactivated if master-switch is present.</dd>
</dl>
</dd>
<dt><em>&lt;expansion&gt;</em></dt>
<dd><span class="target" id="index-218"></span><p class="first" id="index-219">This tag is used to describe how switches can be grouped together on the
command line to keep it shorter. It is also used to define aliases between
switches.</p>
<p>It is easier to explain it through an example. Specifying the GNAT switch
&#8220;-gnatyy&#8221; is equivalent to specifying &#8220;-gnaty3abcefhiklmnprst&#8221;. This is in
fact a style check switch, with a number of default values. But it is also
equivalent to decomposing it into several switches, as in &#8220;-gnatya&#8221;,
&#8220;-gnatyb&#8221;, ...; With this information, GPS will try to keep the
command line length as short as possible, to keep it readable.</p>
<p>Both these aspects are defined in a unique <cite>&lt;expansion&gt;</cite> tag, which
accepts two attributes: <cite>switch</cite> is mandatory, and <cite>alias</cite> is
optional. Alias contains the text &#8220;-gnatyabcefhiklmnprst&#8221; in our example.</p>
<p>There are two possible uses for this tag:</p>
<ul class="simple">
<li>If the &#8220;alias&#8221; attribute is not specified, then the &#8220;switch&#8221; attribute
indicates that all switches starting with that prefix should be grouped.
For instance, if you pass &#8220;-gnatw&#8221; as the value for the &#8220;switch&#8221; attribute,
then a command line with &#8220;-gnatwa -gnatw.b&#8221; will in fact result in
&#8220;-gnatwa.b&#8221;.</li>
<li>If the &#8220;alias&#8221; attribute is specified, then the &#8220;switch&#8221; attribute is
considered as a shorter way of writting &#8220;alias&#8221;. For instance, if &#8220;switch&#8221;
is &#8220;-gnatyy&#8221; and &#8220;alias&#8221; is &#8220;-gnaty3abcefhiklmnprst&#8221;, then the user can
simply type &#8220;-gnatyy&#8221; to mean the whole set of options.</li>
</ul>
<p>The same &#8220;switch&#8221; attribute can be used in two expansion nodes if you want
to combine the behavior.</p>
<p class="last">For historical reasons, this tag accepts <cite>&lt;entry&gt;</cite> children, but these
are no longer used.</p>
</dd>
</dl>
</div>
<div class="section" id="executing-external-tools">
<span id="id39"></span><h3>16.6.4. Executing external tools<a class="headerlink" href="#executing-external-tools" title="Permalink to this headline">¶</a></h3>
<p>The user has now specified the default switches he wants to use for the
external tool. Spawning the external tool can be done either from a menu
item, or as a result of a key press.</p>
<p>Both cases are described in an XML customization file, as described previously,
and both are setup to execute what GPS calls an action, i.e. a set of commands
defined by the <cite>&lt;action&gt;</cite> tag.</p>
<div class="section" id="chaining-commands">
<span id="id40"></span><h4>16.6.4.1. Chaining commands<a class="headerlink" href="#chaining-commands" title="Permalink to this headline">¶</a></h4>
<p>This action tag, as described previously, executes one or more commands, which
can either be internal GPS commands (written in any of the scripting language
supported by GPS), or external commands provided by executables found on the
PATH.</p>
<p>The command line for each of these commands can either be hard-coded in the
customization file, or be the result of previous commands executed as part of
the same action. As GPS executes each command from the action in turn, it saves
its output on a stack as needed. If a command line contains a special construct
<cite>%1</cite>, <cite>%2</cite>... then these constructs will be replaced by the result of
respectively the last command executed, the previous from last command, and so
on. They are replaced by the returned value of the command, not by any output
it might have done to some of the consoles in GPS.</p>
<p>Every time you execute a new command, it pushes the previous %1, %2...
parameters one step further on the stack, so that they become respectively %2,
%3... and the output of that command becomes %1.</p>
<p>The result value of the previous commands is substituted exactly as is.
However, if the output is surrounded by quotes, they are ignored when a
substitution takes place, so you need to put them back if they are needed. The
reason for this behavior is so that for scripting languages that systematically
protect their output with quotes (simple or double), these quotes are sometimes
in the way when calling external commands:</p>
<div class="highlight-xml"><pre>&lt;?xml version="1.0" ?&gt;
&lt;quotes&gt;
  &lt;action name="test quotes"&gt;
    &lt;shell lang="python"&gt;'-a -b -c'&lt;/shell&gt;
    &lt;external&gt; echo with quotes: "%1"&lt;/external&gt;
    &lt;external&gt; echo without quotes: %2&lt;/external/&gt;
  &lt;/action&gt;
&lt;/quotes&gt;</pre>
</div>
<p>If one of the commands in the action raises an error, the execution of the
action is stopped immediately, and no further command is performed.</p>
</div>
<div class="section" id="saving-open-windows">
<span id="id41"></span><h4>16.6.4.2. Saving open windows<a class="headerlink" href="#saving-open-windows" title="Permalink to this headline">¶</a></h4>
<p id="index-220">Before launching the external tool, you might want to force GPS to save all
open files, the project...; This is done using the same command GPS itself
uses before starting a compilation. This command is called <cite>MDI.save_all</cite>,
and takes one optional boolean argument which specifies whether an interactive
dialog should be displayed for the user.</p>
<p>Since this command aborts when the user presses cancel, you can
simply put it in its own <cite>&lt;shell&gt;</cite> command, as in:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;save_children&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;test save children&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell&gt;</span>MDI.save_all 0<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;external&gt;</span>echo Run unless Cancel was pressed<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/save_children&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="querying-project-switches">
<span id="id42"></span><h4>16.6.4.3. Querying project switches<a class="headerlink" href="#querying-project-switches" title="Permalink to this headline">¶</a></h4>
<span class="target" id="index-221"></span><span class="target" id="index-222"></span><span class="target" id="index-223"></span><p id="index-224">Some GPS shell commands can be used to query the default switches set by the
user in the project file. These are <cite>get_tool_switches_as_string</cite>,
<cite>get_tool_switches_as_list</cite>, or, more generally, <cite>get_attribute_as_string</cite> and
<cite>get_attribute_as_list</cite>. The first two require a unique parameter which is the
name of the tool as specified in the <cite>&lt;tool&gt;</cite> tag. This name is case-sensitive.
The last two commands are more general and can be used to query the status of
any attribute from the project. See their description by typing the following
in the GPS shell console window:</p>
<div class="highlight-xml"><div class="highlight"><pre>help Project.get_attribute_as_string
help Project.get_attribute_as_list
</pre></div>
</div>
<p>The following is a short example on how to query the switches for the tool
&#8220;Find&#8221; from the project, <a class="reference internal" href="#tool-example"><em>Tool example</em></a>. It first creates an object
representing the current project, then passes this object as the first
argument of the <cite>get_tool_switches_as_string</cite> command. The last external
command is a simple output of these switches:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;find_switches&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;Get switches for Find&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell&gt;</span>Project %p<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;shell&gt;</span>Project.get_tool_switches_as_string %1 Find <span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;external&gt;</span>echo %1<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/find_switches&gt;</span>
</pre></div>
</div>
<p>The following example shows how something similar can be done from Python, in
a simpler manner. For a change, this function queries the Ada compiler
switches for the current project, and prints them out in the messages
window. The:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;query_switches&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;Query compiler switches&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;python&quot;</span><span class="nt">&gt;</span>GPS.Project(&quot;%p&quot;).get_attribute_as_list
      (package=&quot;compiler&quot;,
       attribute=&quot;default_switches&quot;,
       index=&quot;ada&quot;)<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;external&gt;</span>echo compiler switches= %1<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/query_switches&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="querying-switches-interactively">
<span id="id43"></span><h4>16.6.4.4. Querying switches interactively<a class="headerlink" href="#querying-switches-interactively" title="Permalink to this headline">¶</a></h4>
<span class="target" id="index-225"></span><p id="index-226">Another solution to query the arguments for the tool is to ask the user
interactively.  The scripting languages provides a number of solutions for
these.</p>
<p>They generally have their own native way to read input, possibly by creating a
dialog.</p>
<p>In addition, the simplest solution is to use the predefined GPS commands for
this. These are the two functions:</p>
<dl class="docutils">
<dt><em>yes_no_dialog</em></dt>
<dd>This function takes a single argument, which is a question to display. Two
buttons are then available to the user, &#8220;Yes&#8221; and &#8220;No&#8221;. The result of this
function is the button the user has selected, as a boolean value.</dd>
<dt><em>input_dialog</em></dt>
<dd><p class="first">This function is more general. It takes a minimum of two arguments, with no
upper limit. The first argument is a message describing what input is expected
from the user. The second, third and following arguments each correspond to
an entry line in the dialog, to query one specific value (as a string). The
result of this function is a list of strings, each corresponding to these
arguments.</p>
<p class="last">From the GPS shell, it is only convenient to query one value at a time, since
it doesn&#8217;t have support for lists, and would return a concatenation of the
values. However, this function is especially useful with other scripting
languages.</p>
</dd>
</dl>
<p>The following is a short example that queries the name of a directory and a
file name, and displays each in the Messages window:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;query_file&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;query file and dir&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;python&quot;</span><span class="nt">&gt;</span>list=GPS.MDI.input_dialog \\
      (&quot;Please enter directory and file name&quot;, &quot;Directory&quot;, &quot;File&quot;)<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;python&quot;</span><span class="nt">&gt;</span>print (&quot;Dir=&quot; + list[0], &quot;File=&quot; + list[1])<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/query_file&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="redirecting-the-command-output">
<span id="id44"></span><h4>16.6.4.5. Redirecting the command output<a class="headerlink" href="#redirecting-the-command-output" title="Permalink to this headline">¶</a></h4>
<p id="index-227">The output of external commands is send by default to the GPS console window.
In addition, finer control can be exercised using the <cite>output</cite> attribute
of the <cite>&lt;external&gt;</cite> and <cite>&lt;shell&gt;</cite> tags.</p>
<p>This attribute is a string that may take any value. Two values have specific
meanings:</p>
<dl class="docutils">
<dt><em>&#8220;none&#8221;</em></dt>
<dd>The output of the command, as well as the text of the command itself, will not
be shown to the user at all.</dd>
<dt><em>&#8220;&#8221;</em></dt>
<dd>The output of the command is sent to the GPS console window, entitled
&#8220;Messages&#8221;.</dd>
<dt><em>other values</em></dt>
<dd>A new window is created, with the title given by the attribute. If such
a window already exists, it is cleared up before any of the command in the
chain is executed. The output of the command, as well
as the text of the command itself, are sent to this new window.</dd>
</dl>
<p>This attribute can also be specified at the <cite>&lt;action&gt;</cite> tag level, in which
case it defines the default value for all <cite>&lt;shell&gt;</cite> and <cite>&lt;external&gt;</cite>
tags underneath. If it isn&#8217;t specified for the action itself, its default value
will always be the empty string, i.e. output is sent to the GPS console:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;ls&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;ls current directory&quot;</span> <span class="na">output=</span><span class="s">&quot;default output&quot;</span> <span class="nt">&gt;</span>
     <span class="nt">&lt;shell</span> <span class="na">output=</span><span class="s">&quot;Current directory&quot;</span> <span class="nt">&gt;</span>pwd<span class="nt">&lt;/shell&gt;</span>
     <span class="nt">&lt;external</span> <span class="na">output=</span><span class="s">&quot;Current directory contents&quot;</span> <span class="nt">&gt;</span>/bin/ls<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/ls&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="processing-the-tool-output">
<span id="id45"></span><h4>16.6.4.6. Processing the tool output<a class="headerlink" href="#processing-the-tool-output" title="Permalink to this headline">¶</a></h4>
<p>The output of the tool has now either been hidden or made visible to the user
in one or more windows.</p>
<p>There are several additional things that can be done with this output, for
further integration of the tool in GPS.</p>
<ul>
<li><p class="first">Parsing error messages
.. index:: Locations.parse</p>
<p>External tools can usually display error messages for the user that
are associated with specific files and locations in these files. This is for
instance the way the GPS builder itself analyzes the output of <cite>make</cite>.</p>
<p>This can be done for your own tools using the shell command
<cite>Locations.parse</cite>. This command takes several arguments, so that you
can specify your own regular expression to find the file name, line number and
so on in the error message. By default, it is configured to work
seamlessly with error message of the forms:</p>
<div class="highlight-xml"><div class="highlight"><pre>file:line: message
file:line:column: message
</pre></div>
</div>
<p>Please refer to the online help for this command to get more information (by
e.g. typing <cite>help Locations.parse</cite> in the GPS Shell).</p>
<p>Here is a small example on how to run a make command and send the errors to
the location window afterward.</p>
<p>For languages that support it, it is also recommended that you quote the
argument with triple quotes, so that any special character (newlines, quotes,
...) in the output of the tool are not specially interpreted by GPS. Note
also that you should leave a space at the end, in case the output itself ends
with a quote:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;make&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;make example&quot;</span> <span class="nt">&gt;</span>
     <span class="nt">&lt;external&gt;</span>make<span class="nt">&lt;/external&gt;</span>
     <span class="nt">&lt;on-failure&gt;</span>
        <span class="nt">&lt;shell&gt;</span>Locations.parse &quot;&quot;&quot;%1 &quot;&quot;&quot; make_example<span class="nt">&lt;/shell&gt;</span>
     <span class="nt">&lt;/on-failure&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/make&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Auto-correcting errors
.. index:: Codefix.parse</p>
<p>GPS has support for automatically correcting errors for some of the languages.
You can get access to this auto-fixing feature through the <cite>Codefix.parse</cite>
shell command, which takes the same arguments as for <cite>Locations.parse</cite>.</p>
<p>This will automatically add pixmaps to the relevant entries in the location
window, and therefore <cite>Locations.parse</cite> should be called first prior to
calling this command.</p>
<p>Errors can also be fixed automatically by calling the methods of the
<cite>Codefix</cite> class. Several codefix sessions can be active at the same time,
each of which is associated with a specific category. The list of currently
active sessions can be retrieved through the <cite>Codefix.sessions()</cite> command.</p>
<span class="target" id="index-228"></span><span class="target" id="index-229"></span><p id="index-230">If support for python is enabled, you can also manipulate the fixable errors
for a given session.  To do so, you must first get a handle on that section,
as shown in the example below. You can then get the list of fixable errors
through the <cite>errors</cite> command.</p>
<p>Each error is of the class <cite>CodefixError</cite>, which has one important method
<cite>fix</cite> which allows you to perform an automatic fixing for that error. The
list of possible fixes is retrieved through <cite>possible_fixes</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Codefix</span><span class="o">.</span><span class="n">sessions</span> <span class="p">()</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Codefix</span> <span class="p">(</span><span class="s">&quot;category&quot;</span><span class="p">)</span>
<span class="n">errors</span>  <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">errors</span> <span class="p">()</span>
<span class="k">print</span> <span class="n">errors</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">possible_fixes</span> <span class="p">()</span>
<span class="n">errors</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span> <span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="section" id="customization-examples">
<span id="id46"></span><h2>16.7. Customization examples<a class="headerlink" href="#customization-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="menu-example">
<span id="id47"></span><h3>16.7.1. Menu example<a class="headerlink" href="#menu-example" title="Permalink to this headline">¶</a></h3>
<p>This section provides a full example of a customization file.  It creates a
top-level menu named <cite>custom menu</cite>.  This menu contains a menu item named <cite>item
1</cite>, which is associated to the external command <cite>external-command 1</cite>, a sub
menu named <cite>other menu</cite>, etc...:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;menu-example&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;action1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;external&gt;</span>external-command 1<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>

  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;action2&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell&gt;</span>edit %f<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>

  <span class="nt">&lt;submenu&gt;</span>
    <span class="nt">&lt;title&gt;</span>custom menu<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;action1&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;title&gt;</span>item 1<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/menu&gt;</span>

    <span class="nt">&lt;submenu&gt;</span>
      <span class="nt">&lt;title&gt;</span>other menu<span class="nt">&lt;/title&gt;</span>
      <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;action2&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title&gt;</span>item 2<span class="nt">&lt;/title&gt;</span>
      <span class="nt">&lt;/menu&gt;</span>
    <span class="nt">&lt;/submenu&gt;</span>
  <span class="nt">&lt;/submenu&gt;</span>
<span class="nt">&lt;/menu-example&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="tool-example">
<span id="id48"></span><h3>16.7.2. Tool example<a class="headerlink" href="#tool-example" title="Permalink to this headline">¶</a></h3>
<p>This section provides an example that defines a new tool. This is only a short
example, since Ada, C and C++ support themselves are provided through such a
file, available in the GPS installation.</p>
<p>This example adds support for the &#8220;find&#8221; Unix utility, with a few switches. All
these switches are editable through the project properties editor.</p>
<p>It also adds a new action and menu. The action associated with this menu gets
the default switches from the currently selected project, and then ask the user
interactively for the name of the file to search:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;toolexample&gt;</span>
  <span class="nt">&lt;tool</span> <span class="na">name=</span><span class="s">&quot;Find&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;switches</span> <span class="na">columns=</span><span class="s">&quot;2&quot;</span> <span class="nt">&gt;</span>
      <span class="nt">&lt;title</span> <span class="na">column=</span><span class="s">&quot;1&quot;</span> <span class="nt">&gt;</span>Filters<span class="nt">&lt;/title&gt;</span>
      <span class="nt">&lt;title</span> <span class="na">column=</span><span class="s">&quot;2&quot;</span> <span class="nt">&gt;</span>Actions<span class="nt">&lt;/title&gt;</span>

      <span class="nt">&lt;spin</span> <span class="na">label=</span><span class="s">&quot;Modified less than n days ago&quot;</span> <span class="na">switch=</span><span class="s">&quot;-mtime-&quot;</span>
            <span class="na">min=</span><span class="s">&quot;0&quot;</span> <span class="na">max=</span><span class="s">&quot;365&quot;</span> <span class="na">default=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;check</span> <span class="na">label=</span><span class="s">&quot;Follow symbolic links&quot;</span> <span class="na">switch=</span><span class="s">&quot;-follow&quot;</span> <span class="nt">/&gt;</span>

      <span class="nt">&lt;check</span> <span class="na">label=</span><span class="s">&quot;Print matching files&quot;</span> <span class="na">switch=</span><span class="s">&quot;-print&quot;</span> <span class="na">column=</span><span class="s">&quot;2&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/switches&gt;</span>
  <span class="nt">&lt;/tool&gt;</span>

  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;action find&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell&gt;</span>Project %p<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;shell&gt;</span>Project.get_tool_switches_as_string %1 Find <span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;shell&gt;</span>MDI.input_dialog &quot;Name of file to search&quot; Filename<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;external&gt;</span>find . -name %1 %2<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>

  <span class="nt">&lt;Submenu&gt;</span>
    <span class="nt">&lt;Title&gt;</span>External<span class="nt">&lt;/Title&gt;</span>
     <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;action find&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;Title&gt;</span>Launch find<span class="nt">&lt;/Title&gt;</span>
    <span class="nt">&lt;/menu&gt;</span>
  <span class="nt">&lt;/Submenu&gt;</span>
<span class="nt">&lt;/toolexample&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="scripting-gps">
<span id="id49"></span><h2>16.8. Scripting GPS<a class="headerlink" href="#scripting-gps" title="Permalink to this headline">¶</a></h2>
<div class="section" id="scripts">
<span id="index-231"></span><span id="id50"></span><h3>16.8.1. Scripts<a class="headerlink" href="#scripts" title="Permalink to this headline">¶</a></h3>
<p>Scripts are small programs that interact with GPS and allow you to perform
complex tasks repetitively and easily. GPS includes support for two scripting
languages currently, although additional languages might be added in the
future. These two languages are described in the following section.</p>
<p>Support for scripting is currently work in progress in GPS. As a result, not
many commands are currently exported by GPS, although their number is
increasing daily. These commands are similar to what is available to people who
extend GPS directly in Ada, but with a strong advantage: they do not require
any recompilation of the GPS core, and can be tested and executed
interactively.</p>
<p>The goal of such scripts is to be able to help automate processes such as
builds, automatic generation of graphs, ...</p>
<p>These languages all have a separate console associated with them, which you can
open from the <cite>Tools</cite> menu. In each of these console, GPS will display a
prompt, at which you can type interactive commands. These console provide
completion of the command names through the <tt class="kbd docutils literal"><span class="pre">tab</span></tt> key.</p>
<p>For instance, in the GPS shell console you can start typing:</p>
<div class="highlight-xml"><div class="highlight"><pre>GPS&gt; File
</pre></div>
</div>
<p>then press the <tt class="kbd docutils literal"><span class="pre">tab</span></tt> key, which will list all the functions whose name
starts with &#8220;File&#8221;.</p>
<p>A similar feature is available in the python console, which also provides
completion for all the standard python commands and modules.</p>
<p>All the scripting languages share the same set of commands exported by GPS,
thanks to an abstract interface defined in the GPS core. As a result, GPS
modules do not have to be modified when new scripting languages are added.</p>
<p id="index-232">Scripts can be executed immediately upon startup of GPS by using the command
line switch <cite>&#8211;load</cite>. Specifying the following command line:</p>
<div class="highlight-xml"><div class="highlight"><pre>gps --load=shell:mytest.gps
</pre></div>
</div>
<p>will force the gps script <tt class="file docutils literal"><span class="pre">mytest.gps</span></tt> to be executed immediately, before
GPS starts reacting to user&#8217;s requests. This is useful if you want to do some
special initializations of the environment. It can also be used as a command
line interface to GPS, if you script&#8217;s last command is to exit GPS.</p>
<p id="index-233">In-line commands can also be given directly on the command line through
<cite>&#8211;eval</cite> command line switch.</p>
<p>For instance, if you want to analyze an entity in the entity browser from the
command line, you would pass the following command switches:</p>
<div class="highlight-xml"><div class="highlight"><pre>gps --eval=shell:&#39;Entity entity_name file_name; Entity.show %1&#39;
</pre></div>
</div>
<p>See the section <a class="reference internal" href="#customizing-through-xml-and-python-files"><em>Customizing through XML and Python files</em></a> on how to bind
key shortcuts to shell commands.</p>
</div>
<div class="section" id="scripts-and-gps-actions">
<span id="id51"></span><h3>16.8.2. Scripts and GPS actions<a class="headerlink" href="#scripts-and-gps-actions" title="Permalink to this headline">¶</a></h3>
<p id="index-234">There is a strong relationship between GPS actions, as defined in the
customization files (<a class="reference internal" href="#defining-actions"><em>Defining Actions</em></a>), and scripting languages</p>
<p>Actions can be bound to menus and keys through the customization files or
the <cite>Edit-&gt;Key shortcuts</cite> dialog.</p>
<p>These actions can execute any script command, <a class="reference internal" href="#defining-actions"><em>Defining Actions</em></a>. This is
done through the <cite>&lt;shell&gt;</cite> XML tag.</p>
<p>But the opposite is also true. From a script, you can execute any action
registered in GPS. This can for instance be used to split windows, highlight
lines in the editor, ... when no equivalent shell function exists. This can
also be used to execute external commands, if the scripting language doesn&#8217;t
support this in an easy manner.</p>
<p>Such calls are made through a call to <cite>execute_action</cite>, as in the
following example:</p>
<div class="highlight-xml"><div class="highlight"><pre>execute_action &quot;Split horizontally&quot;

GPS.execute_action (action=&quot;Split horizontally&quot;)
</pre></div>
</div>
<p>The list of actions known to GPS can be found through the <cite>Edit-&gt;Key shortcuts</cite>
dialog. Action names are case sensitive.</p>
<p>Some of the shell commands take subprograms as parameters. If you are using the
GPS shell, this means you have to pass the name of a GPS action. If you are
using Python, this means that you pass a subprogram,
<a class="reference internal" href="#subprogram-parameters"><em>Subprogram parameters</em></a>.</p>
</div>
<div class="section" id="the-gps-shell">
<span id="id52"></span><h3>16.8.3. The GPS Shell<a class="headerlink" href="#the-gps-shell" title="Permalink to this headline">¶</a></h3>
<p id="index-235">The GPS shell is a very simple-minded, line-oriented language. It is accessible
through the <cite>Shell</cite> window at the bottom of the GPS window. It is similar to a
Unix shell, or a command window on Windows systems.</p>
<p>Type <cite>help</cite> at the prompt to get the list of available commands, or <cite>help</cite>
followed by the name of a command to get more information on that specific
command.</p>
<p>The following example shows how to get some information on a source entity, and
find all references to this entity in the application. It searches for the
entity &#8220;entity_name&#8221;, which has at least one reference anywhere in the file
&#8220;file_name.adb&#8221;. After the first command, GPS returns an identifier for this
entity, which can be used for all commands that need an entity as a parameter,
as is the case for the second command. When run, the second command will
automatically display all matching references in the location window:</p>
<div class="highlight-python"><pre>GPS&gt; Entity my_entity file_name.adb
&lt;Entity_0x09055790&gt;
GPS&gt; Entity.find_all_refs &lt;Entity_0x09055790&gt;</pre>
</div>
<p>Since the GPS shell is very simple, it doesn&#8217;t provide any reference counting
for the result types. As a result, all the values returned by a command, such
as <cite>&lt;Entity_0x09055790&gt;</cite> in the example above, are kept in memory.</p>
<p id="index-236">The GPS shell provides the command <cite>clear_cache</cite> which removes all such values
from the memory. After this command is run, you can no longer use references
obtained from previous commands, although of course you can run these commands
again to get a new reference.</p>
<p>The return value of the 9 previous commands can easily be recalled by passing
<cite>%1</cite>, <cite>%2</cite>, ... on the command line. For instance, the previous example could
be rewritten as:</p>
<div class="highlight-python"><pre>GPS&gt; Entity my_entity file_name.adb
&lt;Entity_0x09055790&gt;
GPS&gt; Entity.find_all_refs %1</pre>
</div>
<p>These return values will be modified also for internal commands sent by GPS, so
you should really only use this when you emit multiple commands at the same
time, and don&#8217;t do any other action in GPS. This is mostly useful when used for
command-line scripts (see <cite>&#8211;eval</cite> and <cite>&#8211;load</cite>), or for custom files,
<a class="reference internal" href="#customizing-through-xml-and-python-files"><em>Customizing through XML and Python files</em></a>.</p>
<p>Arguments to commands can, but need not, be quoted. If they don&#8217;t contain any
space, double-quote (&#8216;&#8221;&#8217;) or newline characters, you do not need to quote them.
Otherwise, you should surround them with double-quotes, and protect any
double-quote part of the argument by preceding it with a backslash.</p>
<p>There is another way to quote a command: use three double-quotes characters in
a row. Any character loses its special meaning until the next three
double-quotes characters set. This is useful if you do not know in advance the
contents of the string you are quoting:</p>
<div class="highlight-python"><pre>Locations.parse """%1 """ category_name</pre>
</div>
</div>
<div class="section" id="the-python-interpreter">
<span id="id53"></span><h3>16.8.4. The Python Interpreter<a class="headerlink" href="#the-python-interpreter" title="Permalink to this headline">¶</a></h3>
<p id="index-237">Python is an interpreted object-oriented language, created by Guido Van Rossum.
It is similar in its capabilities to languages such as Perl, Tcl or Lisp. This
section is not a tutorial on python programming. See <a class="reference external" href="http://docs.python.org/">http://docs.python.org/</a> to access the documentation for the current version
of python.</p>
<p>If python support has been enabled, the python shell is accessible through the
<cite>Python</cite> window at the bottom of the GPS window. You can also display it by
using the menu <tt class="file docutils literal"><span class="pre">Tools-&gt;Consoles-&gt;Python</span></tt>.</p>
<p>The full documentation on what GPS makes visible through python is available
through the <cite>/Help/Python extensions</cite>.</p>
<p>The same example that was used to show the GPS shell follows, now using python.
As you can notice, the name of the commands is similar, although they are not
run exactly in the same way. Specifically, GPS benefits from the
object-oriented aspects of python to create classes and instances of these
classes.</p>
<p>In the first line, a new instance of the class Entity is created through the
<cite>create_entity</cite> function. Various methods can then be applied to that instance,
including <cite>find_all_refs</cite>, which lists all references to that entity in the
location window:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">=</span><span class="n">GPS</span><span class="o">.</span><span class="n">Entity</span> <span class="p">(</span><span class="s">&quot;entity_name&quot;</span><span class="p">,</span> <span class="n">GPS</span><span class="o">.</span><span class="n">File</span> <span class="p">(</span><span class="s">&quot;file_name.adb&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">find_all_refs</span><span class="p">()</span>
</pre></div>
</div>
<p>The screen representation of the classes exported by GPS to python has
been modified, so that most GPS functions will return an instance of a
class, but still display their output in a user-readable manner.</p>
<p>Python has extensive introspection capabilities. Continuing the
previous example, you can find what class <cite>e</cite> is an instance of
with the following command:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">Help on instance of Entity:</span>

<span class="go">&lt;GPS.Entity instance&gt;</span>
</pre></div>
</div>
<p>It is also possible to find all attributes and methods that can be
applied to <cite>e</cite>, as in the following example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">[&#39;__doc__&#39;, &#39;__gps_data__&#39;, &#39;__module__&#39;, &#39;called_by&#39;, &#39;calls&#39;,</span>
<span class="go">&#39;find_all_refs&#39;]</span>
</pre></div>
</div>
<p>Note that the list of methods may vary depending on what modules were
loaded in GPS, since each module can add its own methods to any class.</p>
<p>In addition, the list of all existing modules and objects currently known
in the interpreter can be found with the following command:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span> <span class="p">()</span>
<span class="go">[&#39;GPS&#39;, &#39;GPSStdout&#39;, &#39;__builtins__&#39;, &#39;__doc__&#39;, &#39;__name__&#39;, &#39;e&#39;, &#39;sys&#39;]</span>
</pre></div>
</div>
<p>You can also load and execute python scripts with the <cite>execfile</cite> command,
as in the following example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">execfile</span> <span class="p">(</span><span class="s">&quot;test.py&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Python supports named parameters. Most functions exported by GPS define names
for their parameters, so that you can use this Python feature, and make your
scripts more readable. A notable exception to this rule are the functions that
take a variable number of parameters.  Using named parameters allows you to
specify the parameters in any order you wish, e.g:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">=</span><span class="n">GPS</span><span class="o">.</span><span class="n">Entity</span> <span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">GPS</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s">&quot;file.adb&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="python-modules">
<h3>16.8.5. Python modules<a class="headerlink" href="#python-modules" title="Permalink to this headline">¶</a></h3>
<p>On startup, GPS will automatically import (with python&#8217;s <cite>import</cite> command) all
the files with the extension <tt class="file docutils literal"><span class="pre">.py</span></tt> found in the directory
<tt class="file docutils literal"><span class="pre">$HOME/.gps/plug-ins</span></tt>, the directory <tt class="file docutils literal"><span class="pre">$prefix/share/gps/plug-ins</span></tt>
or in the directories pointed to by <tt class="file docutils literal"><span class="pre">GPS_CUSTOM_PATH</span></tt>. These files are
loaded only after all standard GPS modules have been loaded, as well as the
custom files, and before the script file or batch commands specified on the
command lines with the <cite>&#8211;eval</cite> or <cite>&#8211;load</cite> switches.</p>
<p>As a result, one can use the usual GPS functions exported to python in these
startup scripts. Likewise, the script run from the command line can use
functions defined in the startup files.</p>
<p>Since the <cite>import</cite> command is used, the functions defined in this modules will
only be accessible by prefixing their name by the name of the file in which
they are defined. For instance if a file <tt class="file docutils literal"><span class="pre">mystartup.py</span></tt> is copied to the
startup directory, and defines the function <cite>func</cite>, then the latter will be
accessible in GPS through <cite>mystartup.func</cite>.</p>
<p>Python&#8217;s own mechanism for loading files at startup (the environment variable
<cite>PYTHONSTARTUP</cite>) is not suitable for use within the context of GPS. When python
is loaded by GPS, the GPS module itself is not yet available, and thus any
script that depends on that module will fail to load correctly. Instead, copy
your script to one of the plug-ins directories, as documented above.</p>
<p>If you are writing a set of python scripts that other people will use,
you need to provide the python files themselves. This is a set of <tt class="file docutils literal"><span class="pre">.py</span></tt>
files, which the user should install in the <tt class="file docutils literal"><span class="pre">plug-ins</span></tt> directory.</p>
<p>To make the Python function accessible through GPS, this can be done:</p>
<ul class="simple">
<li>Either by exporting the APIs directly through Python, under the form of
Actions (see the <cite>Action</cite> class), Menus (see the <cite>Contextual</cite> and <cite>Menu</cite>
classes) or toolbar buttons (see the <cite>ToolButton</cite> and <cite>Toolbar</cite> classes);</li>
<li>Or by writing an XML file with the format described in the customization
section of this documentation. This XML file should create a set of actions,
through the <cite>&lt;action&gt;</cite> tag, exported to the user. This allows him to either
create menus to execute these commands or to bind them to special key
shortcuts. The menus can be created directly in python, with the <cite>GPS.Menu</cite>
class. The same XML can in fact be directly embedded in the python file
itself and executed through <cite>GPS.parse_xml</cite>.</li>
</ul>
<p>The following example defines a python command that inserts a line full of
dashes (&#8216;-&#8216;) at the current cursor location. This command is associated with
the key binding <tt class="kbd docutils literal"><span class="pre">control-c</span> <span class="pre">n</span></tt>, and can be distributed as a single Python
file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># This code can be stored in a file test.py in $HOME/.gps/plug-ins</span>
<span class="kn">from</span> <span class="nn">GPS</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">add_dashes_line</span><span class="p">():</span>
   <span class="n">Editor</span><span class="o">.</span><span class="n">replace_text</span> <span class="p">(</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">file</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span>
                        <span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">location</span><span class="p">()</span><span class="o">.</span><span class="n">line</span><span class="p">(),</span>
                        <span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">location</span><span class="p">()</span><span class="o">.</span><span class="n">column</span><span class="p">(),</span>
                        <span class="s">&quot;--------------------------------&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">GPS</span><span class="o">.</span><span class="n">parse_xml</span> <span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">   &lt;action name=&quot;dashes line&quot;&gt;</span>
<span class="s">      &lt;shell lang=&quot;python&quot;&gt;test.add_dashes_line()&lt;/shell&gt;</span>
<span class="s">      &lt;context&gt;Source editor&lt;/context&gt;</span>
<span class="s">   &lt;/action&gt;</span>
<span class="s">   &lt;key action=&quot;dashes line&quot;&gt;control-c n&lt;/key&gt;</span>
<span class="s">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Several complex examples are provided in the GPS distribution, in the directory
<tt class="file docutils literal"><span class="pre">examples/python</span></tt>. These are modules that you might want to use for your
own GPS, but more important that will show how GPS can be extended from Python.</p>
<p>If your script doesn&#8217;t do what you expect it to do, there are several ways to
debug it, among which the easiest is probably to add some &#8220;print&#8221; statements.
Since some output of the scripts is sometimes hidden by GPS (for instance for
interactive commands), you might not see this output.</p>
<p>In this case, you can reuse the tracing facility embedded in GPS itself.
Modify the file <tt class="file docutils literal"><span class="pre">$HOME/.gps/traces.cfg</span></tt>, and add the following line:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">PYTHON</span><span class="o">.</span><span class="n">OUT</span><span class="o">=</span><span class="n">yes</span>
</pre></div>
</div>
<p>This will include the python traces as part of the general traces available in
the file <tt class="file docutils literal"><span class="pre">$HOME/.gps/log</span></tt>. Note that it may slow down GPS if there is a
lot of output to process.</p>
</div>
<div class="section" id="subprogram-parameters">
<span id="id54"></span><h3>16.8.6. Subprogram parameters<a class="headerlink" href="#subprogram-parameters" title="Permalink to this headline">¶</a></h3>
<p id="index-238">A few of the functions exported by GPS in the GPS shell or in python expect a
subprogram as a parameter.</p>
<p>This is handled in different ways depending on what language your are using:</p>
<ul>
<li><p class="first">GPS shell</p>
<p>It isn&#8217;t possible to define new functions in the GPS shell. However, this
concept is similar to the GPS actions (<a class="reference internal" href="#defining-actions"><em>Defining Actions</em></a>), which
allow you to execute a set of commands and launch external processes.</p>
<p>Therefore, a subprogram parameter in the GPS shell is a string, which is the
name of the action to execute.</p>
<p>For instance, the following code defines the action &#8220;on_edition&#8221;,
which is called every time a new file is edited. The action is defined
in the shell itself, although this could be more conveniently done in
a separate customization file:</p>
<div class="highlight-python"><pre>parse_xml """&lt;action name="on_edition"&gt;
             &lt;shell&gt;echo "File edited"&lt;/shell&gt;&lt;/action&gt;"""
Hook "file_edited"
Hook.add %1 "on_edition"</pre>
</div>
</li>
<li><p class="first">Python</p>
<p>Python of course has its own notion of subprogram, and GPS is fully compatible
with it. As a result, the syntax is much more natural than in the GPS shell.
The following example has the same result as above:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">GPS</span>
<span class="k">def</span> <span class="nf">on_edition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">):</span>
  <span class="k">print</span> <span class="s">&quot;File edited&quot;</span>
<span class="n">GPS</span><span class="o">.</span><span class="n">Hook</span> <span class="p">(</span><span class="s">&quot;file_edited&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span> <span class="p">(</span><span class="n">on_edition</span><span class="p">)</span>
</pre></div>
</div>
<p>Things are in fact slightly more complex if you want to pass methods as
arguments. Python has basically three notions of callable subprograms,
detailed below. The following examples all create a combo box in the toolbar,
which calls a subprogram whenever its value is changed. The documentation for
the combo box indicates that the callback in this case takes two parameters:</p>
<ul class="simple">
<li>The instance of the combo</li>
<li>The current selection in the combo box</li>
</ul>
<p>The first parameter is the instance of the combo box associated with the
toolbar widget, and, as always in python, you can store your own data in the
instance, as shown in the examples below.</p>
<p>Here is the description of the various subprograms:</p>
<ul>
<li><p class="first">Global subprograms</p>
<p>These are standard subprograms, found outside class definitions. There is
no implicit parameter in this case. However, if you need to pass data to
such a subprogram, you need to use global variables:</p>
<div class="highlight-python"><pre>import GPS

my_var = "global data"

def on_changed (combo, choice):
   global my_var
   print "on_changed called: " + \\
      my_var + " " + combo.data + " " + choice

combo = GPS.Combo \\
  ("name", label="name", on_changed=on_changed)
GPS.Toolbar().append (combo)
combo.data = "My own data"</pre>
</div>
</li>
<li><p class="first">Unbound methods</p>
<p>These are methods of a class. You do not specify, when you pass the
method in parameter to the combo box, what instance should be passed
as its first parameter. Therefore, there is no extra parameter either.</p>
<p>Note however than whatever class the method is defined in, the first
parameter is always an instance of the class documented in the GPS
documentation (in this case a GPS.Combo instance), not an
instance of the current class.</p>
<p>In this first example, since we do not have access to the instance of
MyClass, we also need to store the global data as a class
component. This is a problem if multiple instances of the class can
be created:</p>
<div class="highlight-python"><pre>import GPS
class MyClass:
   my_var = "global data"
   def __init__ (self):
      self.combo = GPS.Combo \\
         ("name", label="name", on_changed=MyClass.on_changed)
      GPS.Toolbar().append (self.combo)
      self.combo.data = "My own data"

   def on_changed (combo, choice):
      ## No direct access to the instance of MyClass.
      print "on_changed called: " + \\
         MyClass.my_var + " " + combo.data + " " + choice

MyClass()</pre>
</div>
<p>As the example above explains, there is no direct access to MyClass when
executing on_changed. An easy workaround is the following, in which the
global data can be stored in the instance of MyClass, and thus be different
for each instance of MyClass:</p>
<div class="highlight-python"><pre>import GPS
class MyClass:
   def __init__ (self):
      self.combo = GPS.Combo \\
         ("name", label="name", on_changed=MyClass.on_changed)
      GPS.Toolbar().append (self.combo)
      self.combo.data = "My own data"
      self.combo.myclass = self   ## Save the instance
      self.my_var = "global data"

   def on_changed (combo, choice):
      print "on_changed called: " + \\
         combo.myclass.my_var + " " + combo.data + " " + choice

MyClass()</pre>
</div>
</li>
<li><p class="first">Bound methods</p>
<p>The last example works as expected, but is not convenient to use. The
solution here is to use a bound method, which is a method for a specific
instance of a class. Such a method always has an extra first parameter, set
implicitly by Python or GPS, which is the instance of the class the method
is defined in.</p>
<p>Notice the way we pass the method in parameter to append(), and the extra
third argument to on_changed in the example below:</p>
<div class="highlight-python"><pre>import GPS
class MyClass:
   def __init__ (self):
      self.combo = GPS.Combo \\
         ("name", label="name", on_changed=self.on_changed)
      GPS.Toolbar().append (self.combo)
      self.combo.data = "My own data"
      self.my_var = "global data"

   def on_changed (self, combo, choice):
      # self is the instance of MyClass specified in call to append()
      print "on_changed called: " + \\
         self.my_var + " " + combo.data + " " + choice

MyClass()</pre>
</div>
<p>It is often convenient to use the object-oriented approach when writing
python scripts. If for instance you want to spawn an external process, GPS
provides the <cite>GPS.Process</cite> class. When you create an instance, you specify
a callback to be called when some input is made available by the process.
Matching the above example, the code would look something like:</p>
<div class="highlight-python"><pre>class MyClass:
  def __init__ (self):
     self.process = GPS.Process
         ("command_line", on_match = self.on_match)

  def on_match (self, process, matched, unmatched);
     print "Process output: " + unmatched + matched + "\\n"</pre>
</div>
<p>A more natural approach, rather than having a class that has a process
field, is to directly extend the <cite>GPS.Process</cite> class, as in:</p>
<div class="highlight-python"><pre>class MyClass (GPS.Process):
  def __init__ (self):
     GPS.Process.__init__ \\
        (self, "command_line", on_match = self.on_match)

  def on_match (self, matched, unmatched);
     print "Process output: " + unmatched + matched + "\\n"</pre>
</div>
<p>Any command that can be used on a process (such as <cite>send</cite>) can then
directly be used on instances of MyClass.</p>
<p>There is one non-obvious improvement in the code above: the <cite>on_match</cite>
callback has one less parameter. What happens is the following: as per the
documentation of <cite>GPS.Process.__init__</cite>, GPS gives three arguments to its
<cite>on_match</cite> callback: the instance of the process (<cite>process</cite> in the first
example above), the string that matched the regular expression, and the
string before that match.</p>
<p>In the first example above, we are passing <cite>self.on_match</cite>, ie a bound
method, as a callback. That tells python that it should automatically, and
transparently, add an extra first parameter when calling
<cite>MyClass.on_match</cite>, which is <cite>self</cite>. This is why the first example has four
parameters to <cite>on_match</cite>.</p>
<p>However, the second example only has three parameters, because GPS has
detected that <cite>self</cite> (the instance of <cite>MyClass</cite>) and the instance of
<cite>GPS.Process</cite> are the same in this case. Thus it doesn&#8217;t add an extra
parameter (<cite>self</cite> and <cite>process</cite> would have been the same).</p>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="python-faq">
<span id="id55"></span><h3>16.8.7. Python FAQ<a class="headerlink" href="#python-faq" title="Permalink to this headline">¶</a></h3>
<p id="index-239">This section lists some of the problems that have been encountered while using
Python inside GPS. This is not a general Python discussion.</p>
<div class="section" id="hello-world-in-python">
<span id="id56"></span><h4>16.8.7.1. Hello World! in python<a class="headerlink" href="#hello-world-in-python" title="Permalink to this headline">¶</a></h4>
<p>Writing a python script to interact with GPS is very simple. Here we show how
to create a new menu in GPS that when clicked, diplays a dialog saying the
famous &#8216;Hello World!&#8217;.</p>
<p>Here is the code that you need to put in hello_world.py:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">GPS</span>

<span class="k">def</span> <span class="nf">hello_world</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
   <span class="n">GPS</span><span class="o">.</span><span class="n">MDI</span><span class="o">.</span><span class="n">dialog</span> <span class="p">(</span><span class="s">&quot;Hello World!&quot;</span><span class="p">)</span>

<span class="n">GPS</span><span class="o">.</span><span class="n">Menu</span><span class="o">.</span><span class="n">create</span> <span class="p">(</span><span class="s">&quot;/Help/Hello World!&quot;</span><span class="p">,</span> <span class="n">on_activate</span><span class="o">=</span><span class="n">hello_world</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to use this plug-in, you can launch GPS with the following command
line:</p>
<div class="highlight-python"><pre>$ gps --load=python:hello_world.py</pre>
</div>
<p>If would want the plug-in to be loaded every time you launch GPS without having
to specify it on the command line, you should copy hello_world.py to your
<cite>$HOME/.gps/plug-ins/</cite> directory or <cite>%USERPROFILE%\.gps\</cite> under Windows.</p>
<p>Alternatively, you can add the directory in which you plug-in is located to you
<cite>GPS_CUSTOM_PATH</cite> environment variable.  For a description of the various
environment variables used by GPS, <a class="reference internal" href="environment.html#environment-variables"><em>Environment Variables</em></a>.</p>
</div>
<div class="section" id="spawning-external-processes">
<span id="id57"></span><h4>16.8.7.2. Spawning external processes<a class="headerlink" href="#spawning-external-processes" title="Permalink to this headline">¶</a></h4>
<p>There exist various solutions to spawn external processes from a script:</p>
<ul>
<li><p class="first">Use the functionalities provided by the <cite>GPS.Process</cite> class</p>
</li>
<li><p class="first">Execute a GPS action through <cite>GPS.execute_action</cite>.</p>
<p>This action should have an <cite>&lt;external&gt;</cite> XML node indicating how to
launch the process</p>
</li>
<li><p class="first">Create a pipe and execute the process with <cite>os.popen()</cite> calls</p>
<p>This solution doesn&#8217;t provide a full interaction with the process, though.</p>
</li>
<li><p class="first">Use a standard expect library of Python</p>
<p>The use of an expect library may be a good solution. There are various python
expect libraries that already exist.</p>
<p>These libraries generally try to copy the parameters of the standard <cite>file</cite>
class. They may fail doing so, as GPS&#8217;s consoles do not fully emulate all the
primitive functions of that class (there is no file descriptor for instance).</p>
<p>When possible, it is recommended to use one of the methods above instead.</p>
</li>
</ul>
</div>
<div class="section" id="redirecting-the-output-of-spawned-processes">
<span id="id58"></span><h4>16.8.7.3. Redirecting the output of spawned processes<a class="headerlink" href="#redirecting-the-output-of-spawned-processes" title="Permalink to this headline">¶</a></h4>
<p>In general, it is possible to redirect the output of any Python script to any
GPS window (either an already existing one, or creating one automatically),
through the <cite>&#8220;output&#8221;</cite> attribute of XML configuration files.</p>
<p>However, there is a limitation in python that the output of processes spawned
through os.exec() or os.spawn() is redirected to the standard output, and not
to the usual python output that GPS has overriden.</p>
<p>There are two solutions for this:</p>
<ul>
<li><p class="first">Execute the external process through a pipe</p>
<p>The output of the pipe is then redirected to Python&#8217;s output, as in:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="k">def</span> <span class="nf">my_external</span><span class="p">():</span>
   <span class="n">f</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span> <span class="p">(</span><span class="s">&#39;ls&#39;</span><span class="p">)</span>
   <span class="n">console</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Console</span> <span class="p">(</span><span class="s">&quot;ls&quot;</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
      <span class="n">console</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s">&#39;   &#39;</span> <span class="o">+</span> <span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
<p>This solution allows you, at the same time, to modify the output, for
instance to indent it as in the example above.</p>
</li>
<li><p class="first">Execute the process through GPS</p>
<p>You can go through the process of defining an XML customization string for
GPS, and execute your process this way, as in:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">parse_xml</span> <span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">   &lt;action name=&quot;ls&quot;&gt;</span>
<span class="s">     &lt;external output=&quot;output of ls&quot;&gt;ls&lt;/external&gt;</span>
<span class="s">   &lt;/action&gt;&quot;&quot;&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">my_external</span><span class="p">():</span>
   <span class="n">GPS</span><span class="o">.</span><span class="n">execute_action</span> <span class="p">(</span><span class="s">&quot;ls&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This solution also allows you to send the output to a different window than
the rest of your script. But you cannot filter or modify the output as in the
first solution.</p>
</li>
</ul>
</div>
<div class="section" id="contextual-menus-on-object-directories-only">
<span id="id59"></span><h4>16.8.7.4. Contextual menus on object directories only<a class="headerlink" href="#contextual-menus-on-object-directories-only" title="Permalink to this headline">¶</a></h4>
<p>The following filter can be used for actions that can only execute in the
Project View, and only when the user clicks on an object directory. The
contextual menu entry will not be visible in other contexts:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;root&gt;</span>
   <span class="nt">&lt;filter</span> <span class="na">name=</span><span class="s">&quot;object directory&quot;</span>
           <span class="na">shell_cmd=</span><span class="s">&quot;import os.path; os.path.samefile (GPS.current_context().project().object_dirs()[0],GPS.current_context().directory())&quot;</span>
           <span class="na">shell_lang=</span><span class="s">&quot;python&quot;</span>
           <span class="na">module=</span><span class="s">&quot;Explorer&quot;</span> <span class="nt">/&gt;</span>

   <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;Test on object directory&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;filter</span> <span class="na">id=</span><span class="s">&quot;object directory&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;shell&gt;</span>echo &quot;Success&quot;<span class="nt">&lt;/shell&gt;</span>
   <span class="nt">&lt;/action&gt;</span>

   <span class="nt">&lt;contextual</span> <span class="na">action=</span><span class="s">&quot;Test on object directory&quot;</span> <span class="nt">&gt;</span>
      <span class="nt">&lt;Title&gt;</span>Test on object directory<span class="nt">&lt;/Title&gt;</span>
   <span class="nt">&lt;/contextual&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</pre></div>
</div>
<p>Another example would be to have a filter so that the contextual menu only
appears when on a project node in the Project View. Using <cite>%P</cite> in your command
is not enough, since the current context when you click on a file or directory
also contain information about the project this file or directory belongs to.
Thus this implicit filter will not be enough to hide your contextual menu.</p>
<p>As a result, you need to do a slightly more complex test, where you check that
the current context doesn&#8217;t contains information on directories (which will
disable the contextual menu for directories, files and entities). Since the
command uses <cite>%P</cite>, GPS garantees that a project is available.</p>
<p>We&#8217;ll implement this contextual menu in a Python file, called
<tt class="file docutils literal"><span class="pre">filters.py</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">GPS</span>
<span class="k">def</span> <span class="nf">on_project</span><span class="p">():</span>
   <span class="k">try</span><span class="p">:</span>
      <span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">directory</span><span class="p">()</span>
      <span class="k">return</span> <span class="bp">False</span>
   <span class="k">except</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">True</span>

<span class="n">GPS</span><span class="o">.</span><span class="n">parse_xml</span> <span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">&lt;action name=&quot;test_filter&quot;&gt;</span>
<span class="s">&lt;filter module=&quot;Explorer&quot;</span>
<span class="s">     shell_lang=&quot;python&quot;</span>
<span class="s">     shell_cmd=&quot;filters.on_project()&quot; /&gt;</span>
<span class="s">&lt;shell&gt;echo current project is %P&lt;/shell&gt;</span>
<span class="s">&lt;/action&gt;</span>
<span class="s">&lt;contextual action=&quot;test_filter&quot;&gt;</span>
<span class="s">&lt;title&gt;Print current project&lt;/title&gt;</span>
<span class="s">&lt;/contextual&gt;&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The example above shows the flexibility of filters, since you can pretty much
do anything you wish through the shell commands. However, it is complex to
write for such a simple filter. Luckily, GPS provides a predefined filter
just for that purpose, so that you can write instead, in an XML file:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;test_filter&quot;</span> <span class="nt">&gt;</span>
<span class="nt">&lt;filter</span> <span class="na">id=</span><span class="s">&quot;Explorer_Project_Node&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;shell&gt;</span>echo current project is %P<span class="nt">&lt;/shell&gt;</span>
<span class="nt">&lt;/action&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="redirecting-the-output-to-specific-windows">
<span id="id60"></span><h4>16.8.7.5. Redirecting the output to specific windows<a class="headerlink" href="#redirecting-the-output-to-specific-windows" title="Permalink to this headline">¶</a></h4>
<p>By default, the output of all python commands is displayed in the Python
console. However, you might want in some cases to create other windows in
GPS for this output. This can be done in one of two ways:</p>
<ul>
<li><p class="first">Define a new action</p>
<p>If the whole output of your script should be redirected to the same window,
or if the script will only be used interactively through a menu or a key
binding, the easiest way is to create a new XML action, and redirect the
output, as in:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;redirect output&quot;</span> <span class="na">output=</span><span class="s">&quot;New Window&quot;</span><span class="nt">&gt;</span>
     <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;python&quot;</span><span class="nt">&gt;</span>print &quot;a&quot;<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</pre></div>
</div>
<p>All the various shell commands in your action can be output in a different
window, and this also applies for the output of external commands.</p>
</li>
<li><p class="first">Explicit redirection</p>
<p>If, however, you want to control in your script where the output should be
sent, for instance if you can&#8217;t know that statically when you write your
commands, you can use the following code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Console</span> <span class="p">(</span><span class="s">&quot;New window&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;foo&quot;</span>
<span class="k">print</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span> <span class="p">())</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Console</span> <span class="p">(</span><span class="s">&quot;Python&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The first line redirect all input and output to a new window, which is
created if it doesn&#8217;t exist yet. Note however that the output of stderr
is not redirected, and you need to explicitely do it for <cite>sys.stderr</cite>.</p>
<p>The last line restore the default Python console. You must do this
at the end of your script, or all scripts will continue to use the new
consoles.</p>
<p>You can alternatively create separate objects for the output, and use them
in turn:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">my_out</span>  <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Console</span> <span class="p">(</span><span class="s">&quot;New Window&quot;</span><span class="p">)</span>
<span class="n">my_out2</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Console</span> <span class="p">(</span><span class="s">&quot;New Window2&quot;</span><span class="p">)</span>

<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">=</span><span class="n">my_out</span>
<span class="k">print</span> <span class="s">&quot;a&quot;</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">=</span><span class="n">my_out2</span>
<span class="k">print</span> <span class="s">&quot;b&quot;</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">=</span><span class="n">GPS</span><span class="o">.</span><span class="n">Console</span> <span class="p">(</span><span class="s">&quot;Python&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The parameter to the constructor <cite>GPS.Console</cite> indicates whether any output
sent to that console should be saved by GPS, and reused for the <cite>%1</cite>, <cite>%2</cite>,
... parameters if the command is executed in a GPS action. That should
generally be 1, except for stderr where it should be 0.</p>
</li>
</ul>
</div>
<div class="section" id="reloading-a-python-file-in-gps">
<span id="id61"></span><h4>16.8.7.6. Reloading a python file in GPS<a class="headerlink" href="#reloading-a-python-file-in-gps" title="Permalink to this headline">¶</a></h4>
<p>After you have made modification to a python file, you might want to
reload it in GPS. This requires careful use of python commands.</p>
<p>Here is an example. Lets assume you have a python file (<tt class="file docutils literal"><span class="pre">&quot;mymod.py&quot;</span></tt>)
which contains the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">parse_xml</span> <span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">   &lt;action name=&quot;my_action&quot;&gt;</span>
<span class="s">      &lt;shell lang=&quot;python&quot;&gt;mymod.myfunc()&lt;/shell&gt;</span>
<span class="s">   &lt;/action&gt;&quot;&quot;&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">myfunc</span><span class="p">():</span>
   <span class="k">print</span> <span class="s">&quot;In myfunc</span><span class="se">\\</span><span class="s">n&quot;</span>
</pre></div>
</div>
<p>As you can guess from this file, it defines an action &#8220;my_action&#8221;, that you can
for instance associate with a keybinding through the Edit-&gt;Key shortcuts menu.</p>
<p>If this file has been copied in one of the <tt class="file docutils literal"><span class="pre">plug-ins</span></tt> directories, it
will be automatically loaded at startup.</p>
<p>Notice that the function <cite>myfunc</cite> is thus found in a separate namespace, with
the name <cite>mymod</cite>, same as the file.</p>
<p>If you decide, during your GPS session, to edit this file and have the function
print &#8220;In myfunc2&#8221; instead, you then have to reload the file by typing the
following command in the Python console:</p>
<div class="highlight-python"><pre>&gt; execfile ("HOME/.gps/plug-ins/mymod.py", mymod.__dict__)</pre>
</div>
<p>The first parameter is the full path to the file that you want to reload.
The second argument is less obvious, but indicates that the file should be
reloaded in the namespace <cite>mymod</cite>.</p>
<p>If you omit the optional second parameter, Python will load the file, but
the function <cite>myfunc</cite> will be defined in the global namespace, and thus
the new definition is accessible through:</p>
<div class="highlight-python"><pre>&gt; myfunc()</pre>
</div>
<p>Thus, the key shortcut you had set, which still executes <cite>mymod.myfunc()</cite> will
keep executing the old definition.</p>
<p>By default, GPS provides a contextual menu when you are editing a Python file.
This contextual menu (Python-&gt;Reload module) will take care of all the above
details.</p>
</div>
<div class="section" id="printing-the-gps-python-documentation">
<span id="id62"></span><h4>16.8.7.7. Printing the GPS Python documentation<a class="headerlink" href="#printing-the-gps-python-documentation" title="Permalink to this headline">¶</a></h4>
<p>The python extension provided by GPS is fully documentation in this manual and
a separate manual accessible through the Help menu in GPS.</p>
<p>However, this documentation is provided in HTML, and might not be the best
suitable for printing, if you wish to do so.</p>
<p>The following paragraph explains how you can generate your own documentation
for any python module, including GPS, and print the result:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pydoc</span>
<span class="n">pydoc</span><span class="o">.</span><span class="n">writedoc</span> <span class="p">(</span><span class="n">GPS</span><span class="p">)</span>
</pre></div>
</div>
<p>In the last comamnd, <cite>GPS</cite> is the name of the module that you want to print the
documentation for.</p>
<p>These commands generate a <tt class="file docutils literal"><span class="pre">.html</span></tt> file in the current directory.</p>
<p>Alternatively, you can generate a simple text file with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">e</span><span class="o">=</span><span class="nb">file</span><span class="p">(</span><span class="s">&quot;./python_doc&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
<span class="n">e</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="n">pydoc</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">document</span> <span class="p">(</span><span class="n">GPS</span><span class="p">))</span>
<span class="n">e</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
<p>This text file includes bold characters by default. Such bold characters are
correctly interpreted by tools such as <tt class="file docutils literal"><span class="pre">a2ps</span></tt> which can be used to
convert the text file into a postscript document.</p>
</div>
<div class="section" id="automatically-loading-python-files-at-startup">
<span id="id63"></span><h4>16.8.7.8. Automatically loading python files at startup<a class="headerlink" href="#automatically-loading-python-files-at-startup" title="Permalink to this headline">¶</a></h4>
<p>At startup, GPS will automatically load all python files found in the
directories <tt class="file docutils literal"><span class="pre">share/gps/plug-ins</span></tt> and <tt class="file docutils literal"><span class="pre">$HOME/.gps/plug-ins</span></tt>.</p>
<p>In addition, python files located under <tt class="file docutils literal"><span class="pre">&lt;prefix&gt;/share/gps/python</span></tt> can
be imported (using the <cite>import</cite> command) by any python script.</p>
<p>You can also set the <cite>PYTHONPATH</cite> environment variable to add other directories
to the python search path.</p>
</div>
<div class="section" id="hiding-contextual-menus">
<span id="id64"></span><h4>16.8.7.9. Hiding contextual menus<a class="headerlink" href="#hiding-contextual-menus" title="Permalink to this headline">¶</a></h4>
<p id="index-240">GPS provides most of its tools through contextual menus, accessed by right
clicking in various parts of GPS. Due to the number of tools provided by GPS,
these contextual menus tend to be big, and you might want to control what
should be displayed in them. There are several ways to control this:</p>
<ul>
<li><p class="first">Define appropriate filters for your actions</p>
<p>If you are creating your own contextual menus through customization files and
XML, these menus are associated with actions (<cite>&lt;action&gt;</cite>) that you have
created yourself most of the time. In this case, you need to define filters
appropriately, through the <cite>&lt;filter&gt;</cite> tag, to decide when the action is
relevant, and therefore when the contextual menu should be displayed.</p>
</li>
<li><p class="first">Use shell commands to hide the menus</p>
<p>If you want to control the visibility of predefined contextual menus, or for
menus where you cannot easily modify the associated filter, you can use shell
and python commands to hide the menu entry. For this, you will need to find
out the name of the menu, which can be done by checking the list returned by
<cite>GPS.Contextual.list()</cite> and using the most likely entry. This name is also
the value of the <cite>&lt;title&gt;</cite> tag for contextual menus that you have created
yourself. Using this name, you can then disable the contextual menu by
executing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">.</span><span class="n">Contextual</span> <span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
</pre></div>
</div>
<p>in the python console</p>
</li>
</ul>
</div>
<div class="section" id="creating-custom-graphical-interfaces">
<span id="id65"></span><h4>16.8.7.10. Creating custom graphical interfaces<a class="headerlink" href="#creating-custom-graphical-interfaces" title="Permalink to this headline">¶</a></h4>
<p id="index-241">GPS is based on the Gtk+ graphical toolkit, which is available under many
platforms and for many programming languages.</p>
<p>In particular, GPS comes with pygtk, a python binding to Gtk+.  Using pygtk,
you will be able to create your own dialogs and graphical windows using the
python capabilities provided by GPS.</p>
<p>See the menu <cite>Help-&gt;Python Extensions</cite>, in particular the <cite>GPS.MDI</cite>
documentation, for a sample of code on how to create your own graphical
interfaces and integrate them in GPS.</p>
</div>
</div>
<div class="section" id="hooks">
<span id="id66"></span><h3>16.8.8. Hooks<a class="headerlink" href="#hooks" title="Permalink to this headline">¶</a></h3>
<p id="index-242">A <strong>hook</strong> is a named set of commands to be executed on particular occasions as
a result of user actions in GPS.</p>
<p>GPS and its various modules define a number of standard hooks, which are called
for instance when a new project is loaded, when a file is edited, and so on.
You can define your own commands to be executed in such cases.</p>
<span class="target" id="index-243"></span><p id="index-244">You can find out the list of hooks that GPS currently knows about by calling
the <strong>Hook.list</strong> function, which takes no argument, and returns a list of hook
names that you can use. More advanced description for each hook is available
through the <cite>Help-&gt;Python Extensions</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">GPS</span><span class="o">&gt;</span> <span class="n">Hook</span><span class="o">.</span><span class="n">list</span>
<span class="n">project_changed</span>
<span class="n">open_file_action_hook</span>
<span class="n">preferences_changed</span>
<span class="p">[</span><span class="o">...</span><span class="p">]</span>

<span class="n">Python</span><span class="o">&gt;</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Hook</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</pre></div>
</div>
<p id="index-245">The description of each hooks includes a pointer to the type of the hook, that
is what parameters the subprograms in this hook will receive. For instance:</p>
<p id="index-246">The list of all known hook types can be found through the <strong>Hook.list_types</strong>
command. This takes no argument and returns a list of all known types of hooks.
As before, you can more information for each of these type through a call to
<strong>Hook.describe_type</strong>.</p>
<div class="section" id="adding-commands-to-hooks">
<h4>16.8.8.1. Adding commands to hooks<a class="headerlink" href="#adding-commands-to-hooks" title="Permalink to this headline">¶</a></h4>
<p>You can add your own command to existing hooks through a call to the
<strong>Hook.add</strong> command. Whenever the hook is executed by GPS or another script,
your command will also be executed, and will be given the parameters that were
specified when the hook is run. The first parameter is always the name of the
hook being executed.</p>
<p>This <strong>Hook.add</strong> applies to an instance of the hook class, and takes one
parameter, the command to be executed. This is a subprogram parameter
(<a class="reference internal" href="#subprogram-parameters"><em>Subprogram parameters</em></a>).</p>
<ul>
<li><p class="first">GPS shell</p>
<p>The command can be any GPS action (<a class="reference internal" href="#defining-actions"><em>Defining Actions</em></a>). The arguments
for the hook will be passed to the action, and are available as $1, $2, ...;
In the following example, the message &#8220;Just executed the hook:
project_changed&#8221; will be printed in the Shell console. Note that we are
defining the action to be executed inline, but this could in fact be defined
in a separate XML customization file for convenience:</p>
<div class="highlight-python"><pre>GPS&gt; parse_xml """&lt;action name="my_action"&gt;&lt;shell&gt;echo "Just executed the hook"&lt;/shell&gt;&lt;/action_name&gt;"""
GPS&gt; Hook project_changed
GPS&gt; Hook.add %1 "my_action"</pre>
</div>
</li>
<li><p class="first">Python</p>
<p>The command must be a subprogram to execute. The arguments for the hook will
be passed to this subprogram. In the following example, the message &#8220;The hook
project_changed was executed by GPS&#8221; will be displayed in the Python console
whenever the project changes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">my_callback</span> <span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;The hook &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot; was executed by GPS&quot;</span>
<span class="n">GPS</span><span class="o">.</span><span class="n">Hook</span> <span class="p">(</span><span class="s">&quot;project_changed&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span> <span class="p">(</span><span class="n">my_callback</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>The example above shows the simplest type of hook, which doesn&#8217;t take any
argument. However, most hooks receive several parameters. For instance, the
hook &#8220;file_edited&#8221; receives the file name as a parameter.</p>
<ul>
<li><p class="first">GPS shell</p>
<p>The following code will print the name of the hook (&#8220;file_edited&#8221;) and the
name of the file in the shell console every time a file is open by GPS:</p>
<div class="highlight-python"><pre>GPS&gt; parse_xml """&lt;action name="my_action"&gt;&lt;shell&gt;echo name=$1 file=$2&lt;/shell&gt;&lt;/action&gt;"""
GPS&gt; Hook "file_edited"
GPS&gt; Hook.add %1 "my_action"</pre>
</div>
</li>
<li><p class="first">Python</p>
<p>The following code prints the name of the file being edited by GPS in the
python console whenever a new editor is opened. The second argument is of
type GPS.File:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">my_file_callback</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">file</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;Editing &quot;</span> <span class="o">+</span> <span class="nb">file</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="n">GPS</span><span class="o">.</span><span class="n">Hook</span> <span class="p">(</span><span class="s">&quot;file_edited&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span> <span class="p">(</span><span class="n">my_file_callback</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="action-hooks">
<h4>16.8.8.2. Action hooks<a class="headerlink" href="#action-hooks" title="Permalink to this headline">¶</a></h4>
<span class="target" id="index-247"></span><p id="index-248">Some hooks have a special use in GPS. Their name always ends with
&#8220;_action_hook&#8221;.</p>
<p>As opposed to the standard hooks described in the previous section, the
execution of the action hooks stops as soon as one of the subprograms returns a
True value (&#8220;1&#8221; or &#8220;true&#8221;). The subprograms associated with that hook are
executed one after the other. If any such subprogram knows how to act for that
hook, it should do the appropriate action and return &#8220;1&#8221;.</p>
<p>Other action hooks expect a string as a return value instead of a boolean. The
execution will stop when a subprogram returns a non-empty string.</p>
<p>This mechanism is used extensively by GPS internally. For instance, whenever a
file needs to be opened in an editor, GPS executes the &#8220;open_file_action_hook&#8221;
hook to request its editing. Several modules are connected to that hook.</p>
<p>One of the first modules to be executed is the external editor module. If the
user has chosen to use an external editor, this module will simply spawn Emacs
or the external editor that the user has selected, and return 1. This
immediately stops the execution of the &#8220;open_file_action_hook&#8221;.</p>
<p>However, if the user doesn&#8217;t want to use external editors, this module will
return 0. This will keep executing the hook, and in particular will execute the
source editor module, which will always act and open an editor internally in
GPS.</p>
<p>This is a very flexible mechanism. In your own script, you could choose to have
some special handling for files with a &#8221;.foo&#8221; extension for instance. If the
user wants to open such a file, you would spawn for instance an external
command (say &#8220;my_editor&#8221;) on this file, instead of opening it in GPS.</p>
<p>This is done with a code similar to the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">def</span> <span class="nf">my_foo_handler</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">file</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span>
                   <span class="n">column_end</span><span class="p">,</span> <span class="n">enable_nav</span><span class="p">,</span> <span class="n">new_file</span><span class="p">,</span> <span class="nb">reload</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">splitext</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">name</span><span class="p">())[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;.foo&quot;</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">spawnv</span><span class="p">(</span>
           <span class="n">os</span><span class="o">.</span><span class="n">P_NOWAIT</span><span class="p">,</span> <span class="s">&quot;/usr/bin/emacs&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;emacs&quot;</span><span class="p">,</span> <span class="nb">file</span><span class="o">.</span><span class="n">name</span><span class="p">()))</span>
        <span class="k">return</span> <span class="mi">1</span>   <span class="c">## Prevent further execution of the hook</span>
    <span class="k">return</span> <span class="mi">0</span>  <span class="c">## Let other subprograms in the hook do their job</span>

<span class="n">GPS</span><span class="o">.</span><span class="n">Hook</span><span class="p">(</span><span class="s">&quot;open_file_action_hook&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">my_foo_handler</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="running-hooks">
<h4>16.8.8.3. Running hooks<a class="headerlink" href="#running-hooks" title="Permalink to this headline">¶</a></h4>
<p id="index-249">Any module in GPS is responsible for running the hooks when appropriate.  Most
of the time, the subprograms exported by GPS to the scripting languages will
properly run the hook. But you might also need to run them in your own scripts.</p>
<p>As usual, this will result in the execution of all the functions bound to that
hook, whether they are defined in Ada or in any of the scripting languages.</p>
<p>This is done through the <strong>Hook.run</strong> command. This applies to an instance of
the Hook class, and a variable number of arguments These must be in the right
order and of the right type for that specific type of hook.</p>
<p>If you are running an action hook, the execution will stop as usual as soon as
one of the subprograms return a True value.</p>
<p>The following example shows how to run a simple hook with no parameter, and a
more complex hook with several parameters. The latter will in fact request the
opening of an editor for the file in GPS, and thus has an immediately visible
effect on the interface. The file is opened at line 100. See the description of
the hook for more information on the other parameters:</p>
<div class="highlight-python"><pre>GPS.Hook ("project_changed").run()
GPS.Hook ("open_file_action_hook").run \\
              (GPS.File ("test.adb"), 100, 1, 0, 1, 1, 1)</pre>
</div>
</div>
<div class="section" id="creating-new-hooks">
<h4>16.8.8.4. Creating new hooks<a class="headerlink" href="#creating-new-hooks" title="Permalink to this headline">¶</a></h4>
<span class="target" id="index-250"></span><p id="index-251">The list of hooks known to GPS is fully dynamic. GPS itself declares a number
of hooks, mostly for its internal use although of course you can also connect
to them.</p>
<p>But you can also create your own hooks to report events happening in your own
modules and programs. This way, any other script or GPS module can react to
these events.</p>
<p>Such hooks can either be of a type exported by GPS, which constraints the list
of parameters for the callbacks, but make such hooks more portable and secure;
or they can be of a general type, which allows basically any kind of
parameters. In the latter case, checks are done at runtime to ensure that the
subprogram that is called as a result of running the hook has the right number
of parameters. If this isn&#8217;t the case, GPS will complain and display error
messages. Such general hooks will also not pass their parameters to other
scripting languages.</p>
<p>Creating new hooks is done through a call to <strong>Hook.register</strong>. This function
takes two arguments: the name of the hook you are creating, and the type of the
hook.</p>
<p>The name of the hook is left to you. Any character is allowed in that name,
although using only alphanumerical characters is recommended.</p>
<p>The type of the hook must be one of the following:</p>
<ul>
<li><p class="first">&#8220;&#8221; (the empty string)</p>
<p>This indicates that the hook doesn&#8217;t take any argument. None should be given
to <strong>Hook.run</strong>, and none should be expected by the various commands
connected to that hook, apart from the hook name itself.</p>
</li>
<li><p class="first">one of the values returned by <strong>Hook.list_types</strong></p>
<p>This indicates that the hook is of one of the types exported by GPS itself.
The advantage of using such explicit types as opposed to &#8220;general&#8221; is that
GPS is able to make more tests for the validity of the parameters. Such hooks
can also be connected to from other scripting languages.</p>
</li>
<li><p class="first">&#8220;general&#8221;</p>
<p>This indicates that the hook is of the general type that allows any number of
parameter, of any type. Other scripts will be able to connect to it, but will
not be executed when the hook is run if they do not expect the same number of
parameters that was given to <strong>Hook.run</strong>. Other scripts in other language
will only receive the hook name in parameter, not the full list of
parameters.</p>
</li>
</ul>
<p>A small trick worth noting: if the command bound to a hook doesn&#8217;t have the
right number of parameters that this hook provides, the command will not be
executed and GPS will report an error. You can make sure that your command will
always be executed by either giving default values for its parameter, or by
using python&#8217;s syntax to indicate a variable number of arguments.</p>
<p>This is especially useful if you are connecting to a &#8220;general&#8221; hook, since you
do not really know in advance how many parameters the call of <strong>Hook.run</strong> will
provide:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## This callback can be connected to any type of hook</span>
<span class="k">def</span> <span class="nf">trace</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
   <span class="k">print</span> <span class="s">&quot;hook=&quot;</span> <span class="o">+</span> <span class="n">name</span>

<span class="c">## This callback can be connected to hooks with one or two parameters</span>
<span class="k">def</span> <span class="nf">trace2</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
   <span class="k">print</span> <span class="s">&quot;hook=&quot;</span> <span class="o">+</span> <span class="nb">str</span> <span class="p">(</span><span class="n">arg1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span> <span class="p">(</span><span class="n">arg2</span><span class="p">)</span>

<span class="n">Hook</span><span class="o">.</span><span class="n">register</span> <span class="p">(</span><span class="s">&quot;my_custom_hook&quot;</span><span class="p">,</span> <span class="s">&quot;general&quot;</span><span class="p">)</span>
<span class="n">Hook</span> <span class="p">(</span><span class="s">&quot;my_custom_hook&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span> <span class="p">(</span><span class="n">trace2</span><span class="p">)</span>
<span class="n">Hook</span> <span class="p">(</span><span class="s">&quot;my_custom_hook&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c">## Prints 1 2</span>
<span class="n">Hook</span> <span class="p">(</span><span class="s">&quot;my_custom_hook&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="c">## Prints 1 100</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="adding-support-for-new-version-control-systems">
<span id="id67"></span><h2>16.9. Adding support for new Version Control Systems<a class="headerlink" href="#adding-support-for-new-version-control-systems" title="Permalink to this headline">¶</a></h2>
<div class="section" id="custom-vcs-interfaces">
<span id="index-252"></span><span id="id68"></span><h3>16.9.1. Custom VCS interfaces<a class="headerlink" href="#custom-vcs-interfaces" title="Permalink to this headline">¶</a></h3>
<p>The Version Control interface in GPS can be customized, either to refine the
behavior of the existing system and adapt it to specific needs, or to add
support for other Version Control systems.</p>
<p>Custom VCS interfaces are defined through XML files and Python plugins.  Those
files are read in the same location as all the other XML and Python
customizations that GPS offers. See
<a class="reference internal" href="#customizing-through-xml-and-python-files"><em>Customizing through XML and Python files</em></a> for a complete description.</p>
<p>There are three steps to follow when creating a custom VCS interface. The first
step is to describe the VCS itself, the second step is to implement actions
corresponding to all the operations that this VCS can perform, and the third
step is to define the layout of the menus. The following three sections
(<a class="reference internal" href="#describing-a-vcs"><em>Describing a VCS</em></a>, <a class="reference internal" href="#implementing-vcs-actions"><em>Implementing VCS actions</em></a>, and
<a class="reference internal" href="#implementing-vcs-menus"><em>Implementing VCS menus</em></a>) describe those steps.</p>
<p>GPS is distributed with XML/Python files describing the interfaces to
ClearCase, CVS, Subversion, Git and Mercurial (experimental support).
These XML/Python files are located in the directory <cite>share/gps/plug-ins</cite>
in the GPS installation, and can be used as a reference for implementing
new custom VCS interfaces.</p>
</div>
<div class="section" id="describing-a-vcs">
<span id="id69"></span><h3>16.9.2. Describing a VCS<a class="headerlink" href="#describing-a-vcs" title="Permalink to this headline">¶</a></h3>
<div class="section" id="the-vcs-node">
<span id="id70"></span><h4>16.9.2.1. The VCS node<a class="headerlink" href="#the-vcs-node" title="Permalink to this headline">¶</a></h4>
<p>The <cite>vcs</cite> node is the toplevel node which contains the description of the
general behavior expected from the VCS. It has the following attributes:</p>
<dl class="docutils">
<dt><em>name</em></dt>
<dd>The attribute <cite>name</cite> indicates the identifier of the VCS. The
casing of this name is important, and the same casing must be used in
the project files.</dd>
<dt><em>absolute_names</em></dt>
<dd>The attribute <cite>absolute_names</cite> indicates the behavior of the VCS relative to
file names, and can take the values <cite>TRUE</cite> or <cite>FALSE</cite>. If it is set to
<cite>TRUE</cite>, it means that all commands in the VCS will work on absolute file
names. If it set to <cite>FALSE</cite>, it means that all actions work on base file
names, and that GPS will move to the appropriate directory before executing
an action.</dd>
<dt><em>group_queries_by_directory</em></dt>
<dd>The attribute <cite>group_queries_by_directory</cite> indicates that, when querying
status for all the source files in a directory, a query for the directory
should be launched, instead of launching a query for multiple files.  This
operation is faster on some Version Control systems. By default, this is set
to <cite>FALSE</cite>.</dd>
<dt><em>ignore_file</em></dt>
<dd>The attribute <cite>ignore_file</cite> specifies the name of the file used by the VCS
Explorer to get the list of files to ignore. By default for the CVS mode this
is set to <tt class="file docutils literal"><span class="pre">.cvsignore</span></tt>.</dd>
<dt><em>atomic_commands</em></dt>
<dd>The attribute <cite>atomic_commands</cite> specifies if the VCS supports atomicity and
can take the values <cite>TRUE</cite> or <cite>FALSE</cite>. If it is set to <cite>TRUE</cite> it means that
the VCS supports atomic commands. It is <cite>FALSE</cite> by default. This attribute is
important to trigger the activities group commit feature. See
<a class="reference internal" href="vcs.html#the-vcs-activities"><em>The VCS Activities</em></a>.</dd>
<dt><em>path_style</em></dt>
<dd>The attribute <cite>path_style</cite> specifies which kind of directory separator is
supported by the VCS and can take the values <cite>UNIX</cite>, <cite>DOS</cite>, <cite>Cygwin</cite> or
<cite>System_Default</cite>. The later value is the default value. With this attribute
it is possible to control the directory separator to use when specifying
files to the VCS. For the <cite>Cygwin</cite> case the drive is specified as
<cite>/cygdrive/&lt;drive&gt;</cite>.</dd>
<dt><em>dir_sep</em></dt>
<dd>Alias for <cite>path_style</cite>, obsolescent.</dd>
<dt><em>commit_directory</em></dt>
<dd>The attribute <cite>commit_directory</cite> specifies if the VCS supports
commit on directories and can take the values <cite>TRUE</cite> or <cite>FALSE</cite>.
If it is set to <cite>TRUE</cite> it means that the VCS supports commit on
directories this is the case for <cite>Subversion</cite> for example.</dd>
<dt><em>administrative_directory</em></dt>
<dd>The attribute <cite>administrative_directory</cite> specifies the name of
the directory where the external VCS stores the local repository
information. For example for Subversion this is <tt class="file docutils literal"><span class="pre">.svn</span></tt>. This
information is used when the project is setup to select automatically
the external VCS. <a class="reference internal" href="vcs.html#version-control-system"><em>Version Control System</em></a>.</dd>
<dt><em>prev_revision</em></dt>
<dd>A string which can be used when querying revisions to indicate the
previous revision of a file, for instance &#8220;PREV&#8221; for subversion.</dd>
<dt><em>head_revision</em></dt>
<dd>A string which can be used when querying revisions to indicate the
latest revision of a file, for instance &#8220;HEAD&#8221; for subversion.</dd>
<dt><em>require_log</em></dt>
<dd>The attribute <cite>require_log</cite> specifies if the VCS require a log for the
commit/add/delete actions. It can take the values <cite>TRUE</cite> or <cite>FALSE</cite>. If it is
set to <cite>TRUE</cite> GPS will ensure that a log is created for each file. If it is
set to <cite>FALSE</cite> GPS will not ask for log, it is expected to be handled by the
external VCS.</dd>
</dl>
<p>Note that to support group commit with shared log on GPS both <cite>absolute_name</cite>
and <cite>atomic_commands</cite> must be true. This is the case for the Subversion VCS for
example.</p>
<p>Here is an example, adapted to the use of CVS:</p>
<div class="highlight-python"><pre>&lt;vcs name="Custom CVS" absolute_names="FALSE"&gt;

   (... description of action associations ...)
   (... description of supported status ...)
   (... description of output parsers ...)

&lt;/vcs&gt;</pre>
</div>
</div>
<div class="section" id="associating-actions-to-operations">
<span id="id71"></span><h4>16.9.2.2. Associating actions to operations<a class="headerlink" href="#associating-actions-to-operations" title="Permalink to this headline">¶</a></h4>
<p>GPS knows about a certain set of predefined &#8216;operations&#8217; that a VCS can
perform. The user can decide to implement some of them - not necessarily all of
them - in this section.</p>
<p>The following node is used to associate a predefined operation to an action:</p>
<div class="highlight-python"><pre>&lt;OPERATION  action="ACTION_LABEL" label="NAME OF OPERATION" /&gt;</pre>
</div>
<p>Where:</p>
<dl class="docutils">
<dt><em>OPERATION</em></dt>
<dd>is the name of the predefined action. The list of predefined actions
is described in <a class="reference internal" href="#implementing-vcs-actions"><em>Implementing VCS actions</em></a>,</dd>
<dt><em>ACTION_LABEL</em></dt>
<dd>is the name of the corresponding gps Action that will be launched when
GPS wants to ask the VCS to perform OPERATION,</dd>
<dt><em>NAME OF OPERATION</em></dt>
<dd>is the name that will appear in the GPS menus when working on a file
under the control of the defined VCS.</dd>
</dl>
</div>
<div class="section" id="defining-revision-information">
<span id="id72"></span><h4>16.9.2.3. Defining revision information<a class="headerlink" href="#defining-revision-information" title="Permalink to this headline">¶</a></h4>
<p>Some VCS reports revisions number from which it is possible to deduce the
related branches. This is the case in CVS for example where a revision number
for a branch uses as prefix the branch point revision number. For such VCS it
is possible to specify two regular expressions:</p>
<dl class="docutils">
<dt><em>`parent_revision`</em></dt>
<dd><p class="first">Parse the revision number and report as first match the parent revision:</p>
<div class="highlight-python"><pre>&lt;parent_revision regexp="..." /&gt;</pre>
</div>
<p class="last">For CVS on <strong>1.2.4.5</strong> it must match <strong>1.2</strong>.</p>
</dd>
<dt><em>`branch_root_revision`</em></dt>
<dd><p class="first">Parse the revision number and report as first match the branch root
revision:</p>
<div class="highlight-python"><pre>&lt;branch_root_revision regexp="..." /&gt;</pre>
</div>
<p class="last">For CVS on <strong>1.2.4.5</strong> it must match <strong>1.2.4</strong>.</p>
</dd>
</dl>
</div>
<div class="section" id="defining-status">
<span id="id73"></span><h4>16.9.2.4. Defining status<a class="headerlink" href="#defining-status" title="Permalink to this headline">¶</a></h4>
<p>All VCS have the notion of &#8216;status&#8217; or &#8216;state&#8217; to describe the
relationship between the local file and the repository. The XML node
<cite>status</cite> is used to describe the status that are known to a
custom VCS, and the icons associated to it:</p>
<div class="highlight-python"><pre>&lt;status label="STATUS_LABEL" stock="STOCK_LABEL" /&gt;</pre>
</div>
<p>Where:</p>
<dl class="docutils">
<dt><em>STATUS_LABEL</em></dt>
<dd>is the name of the status, for example &#8216;Up to date&#8217; or &#8216;Needs update&#8217;
in the context of CVS.</dd>
<dt><em>STOCK_LABEL</em></dt>
<dd>is the stock identifier of the icon associated to this status, that
will be used, for example, in the VCS Explorer. See section
<a class="reference internal" href="#adding-stock-icons"><em>Adding stock icons</em></a> for more details on how to define stock
icons.</dd>
</dl>
<p>Note that the order in which status are defined in the XML file is
important: the first status to be displayed must correspond to the
status &#8216;Up-to-date&#8217; or equivalent.</p>
</div>
<div class="section" id="output-parsers">
<span id="id74"></span><h4>16.9.2.5. Output parsers<a class="headerlink" href="#output-parsers" title="Permalink to this headline">¶</a></h4>
<p>There are cases in which GPS needs to parse the output of the VCS
commands: when querying the status, or when &#8216;annotating&#8217; a
file.</p>
<p>The following parsers can be implemented in the <cite>vcs</cite> node.</p>
<dl class="docutils">
<dt><em>`&lt;status_parser&gt;`, `&lt;local_status_parser&gt;` and `&lt;update_parser&gt;`</em></dt>
<dd><p class="first">These parsers are used by the command VCS.status_parse, to parse a string for
the status of files controlled by a VCS.</p>
<p>They accept the following child nodes:</p>
<dl class="last docutils">
<dt><em>`&lt;regexp&gt;` (mandatory)</em></dt>
<dd>Indicates the regular expression to match.</dd>
<dt><em>`&lt;file_index&gt;`</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that contains the name
of a file.</dd>
<dt><em>`&lt;status_index&gt;`</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that contains the file
status. This status is passed through the regular expressions defined in the
<cite>status_matcher</cite> nodes, see below.</dd>
<dt><em>`&lt;local_revision_index&gt;`</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that contains the name
of the local revision (the version of the file that was checked out).</dd>
<dt><em>`&lt;repository_revision_index&gt;`</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that contains the name
of the repository revision (the latest version of the file in the VCS).</dd>
<dt><em>`&lt;status_matcher&gt;`</em></dt>
<dd>A regular expression which, when matching an expressions, identifies the
status passed in the node attribute <cite>label</cite>.</dd>
</dl>
</dd>
<dt><em>`&lt;annotations_parser&gt;`</em></dt>
<dd><p class="first">This parser is used by the command VCS.annotations_parse, to parse a string
for annotations in a file controlled by a VCS.</p>
<p>It accepts the following child nodes:</p>
<dl class="last docutils">
<dt><em>`&lt;regexp&gt;` (mandatory)</em></dt>
<dd>Indicates the regular expression to match.</dd>
<dt><em>`&lt;repository_revision_index&gt;` (mandatory)</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that contains the
repository revision of the line.</dd>
<dt><em>`&lt;author_index&gt;`</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that contains the
author of the line.</dd>
<dt><em>`&lt;date_index&gt;`</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that contains the
date of the line.</dd>
<dt><em>`&lt;file_index&gt;`</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that indicates the
part of the line that belongs to the file.</dd>
<dt><em>`&lt;tooltip_pattern&gt;`</em></dt>
<dd>A template pattern that will be used to format the tooltip information.
It can contain text and reference parenthesized expressions in
<cite>regexp</cite> using \`n` (where <cite>n</cite> represents the nth
expression in <cite>regexp</cite>).</dd>
</dl>
</dd>
<dt><em>`&lt;log_parser&gt;`</em></dt>
<dd><p class="first">This parser is used by the command VCS.log_parse, to parse a string for
revision histories in a file controlled by a VCS.</p>
<p>It accepts the following child nodes:</p>
<dl class="last docutils">
<dt><em>`&lt;regexp&gt;` (mandatory)</em></dt>
<dd>Indicates the regular expression to match.</dd>
<dt><em>`&lt;repository_revision_index&gt;` (mandatory)</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that contains the
repository revision of the log.</dd>
<dt><em>`&lt;author_index&gt;`</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that contains the
author of the log.</dd>
<dt><em>`&lt;date_index&gt;`</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that contains the
date of the log.</dd>
<dt><em>`&lt;log_index&gt;`</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that contains the
actual text of the log.</dd>
</dl>
</dd>
<dt><em>`&lt;revision_parser&gt;`</em></dt>
<dd><p class="first">This parser is used by the command VCS.revision_parse, to parse a string for
revision tags and branches in a file controlled by a VCS.</p>
<p>It accepts the following child nodes:</p>
<dl class="last docutils">
<dt><em>`&lt;regexp&gt;` (mandatory)</em></dt>
<dd>Indicates the regular expression to match.</dd>
<dt><em>`&lt;sym_index&gt;` (mandatory)</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that contains the
tags or branches symbolic name of the revision.</dd>
<dt><em>`&lt;repository_revision_index&gt;` (mandatory)</em></dt>
<dd>An index of a parenthesized expression in <cite>regexp</cite> that contains the
repository revision number of the revision.</dd>
</dl>
</dd>
</dl>
</div>
</div>
<div class="section" id="implementing-vcs-actions">
<span id="id75"></span><h3>16.9.3. Implementing VCS actions<a class="headerlink" href="#implementing-vcs-actions" title="Permalink to this headline">¶</a></h3>
<p>A number of &#8216;standard&#8217; VCS operations are known to GPS. Each of
these operations can be implemented, using Actions. See <a class="reference internal" href="#defining-actions"><em>Defining Actions</em></a>) for a complete description of how to implement actions.</p>
<p>Here is a list of all the defined VCS operations, and their
parameters:</p>
<p><em>status_files</em></p>
<blockquote>
<div><ul class="simple">
<li>$1  = whether the log files should be cleared when obtaining up-to-date
status</li>
<li>$2- = the list of files to query status for.</li>
</ul>
<p>Query the status for a list of files. This should perform a complete
VCS query and return results as complete as possible.</p>
</div></blockquote>
<p><em>status_dir</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = the directory.</li>
</ul>
<p>Same as above, but works on all the files in one directory.</p>
</div></blockquote>
<p><em>status_dir_recursive</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = the directory.</li>
</ul>
<p>Same as above, but works on all the files in one directory and all
subdirectories, recursively.</p>
</div></blockquote>
<p><em>local_status_files</em></p>
<blockquote>
<div><ul class="simple">
<li>$* = list of files</li>
</ul>
<p>Query the local status for specified files. This query should be as
fast as possible, not connecting to any remote VCS. The results need
not be complete, but it is not useful to implement this command if
the output does not contain at least the working revision.</p>
</div></blockquote>
<p><em>open</em></p>
<blockquote>
<div><ul class="simple">
<li>$* = list of files</li>
</ul>
<p>Open files or directories for editing. This command should be
implemented on any VCS that require an explicit check-out/open/edit
action before being able to edit a file.</p>
</div></blockquote>
<p><em>update</em></p>
<blockquote>
<div><ul class="simple">
<li>$* = list of files</li>
</ul>
<p>Bring the specified files in sync with the latest repository revision.</p>
</div></blockquote>
<p><em>resolved</em></p>
<blockquote>
<div><ul class="simple">
<li>$* = list of files</li>
</ul>
<p>Mark files&#8217; merge conflics as resolved. Some version control systems
(like Subversion) will block any commit until this action is called.</p>
</div></blockquote>
<p><em>commit</em></p>
<blockquote>
<div><ul class="simple">
<li>$1  = log file</li>
<li>$2- = list of files</li>
</ul>
<p>Commit/submit/check-in files or directories with provided log. The log is
passed in a file.</p>
</div></blockquote>
<p><em>commit_dir</em></p>
<blockquote>
<div><ul class="simple">
<li>$1  = log</li>
<li>$2  = directory</li>
</ul>
<p>Commit/submit one directory with provided log. The log is passed in
a file.</p>
</div></blockquote>
<p><em>history_text</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = file</li>
</ul>
<p>Query the entire changelog history for the specified file. The result
is expected to be placed into an editor as plain text.</p>
</div></blockquote>
<p><em>history</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = file</li>
</ul>
<p>Query the entire changelog history for the specified file. The result
is expected to be placed into a Revision View.</p>
</div></blockquote>
<p><em>history_revision</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = revision</li>
<li>$2 = file</li>
</ul>
<p>Query the history for corresponding revision of the specified file.</p>
</div></blockquote>
<p><em>annotate</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = file</li>
</ul>
<p>Query the annotations for a file.</p>
</div></blockquote>
<p><em>add</em></p>
<blockquote>
<div><ul class="simple">
<li>$1  = log</li>
<li>$2- = list of files or dirs</li>
</ul>
<p>Add files/dirs to the repository, with the provided revision log. The
added files/dirs are commited.</p>
</div></blockquote>
<p><em>add_no_commit</em></p>
<blockquote>
<div><ul class="simple">
<li>$1  = log</li>
<li>$2- = list of files or dirs</li>
</ul>
<p>Add files/dirs to the repository, with the provided revision log. The
added files/dirs are not commited.</p>
</div></blockquote>
<p><em>remove</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = log</li>
<li>$2 = file or dir</li>
</ul>
<p>Remove file/dir from the repository, with the provided revision log.</p>
</div></blockquote>
<p><em>remove_no_commit</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = log</li>
<li>$2 = file or dir</li>
</ul>
<p>Remove file/dir from the repository, with the provided revision log.
The removed files/dirs are not commited.</p>
</div></blockquote>
<p><em>revert</em></p>
<blockquote>
<div><ul class="simple">
<li>$* = files</li>
</ul>
<p>Revert the local file to repository revision, cancelling all local
changes, and close the file for editing if it was open.</p>
</div></blockquote>
<p><em>diff_patch</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = file</li>
</ul>
<p>Create a textual diff for the given file. This command is used to
build the activity patch file.</p>
</div></blockquote>
<p><em>diff_head</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = file</li>
</ul>
<p>Display a visual comparison between the local file and the latest
repository revision. The diff command must report a <em>normal</em> diff
as opposed to <em>context</em> or <em>unified</em> ones.</p>
</div></blockquote>
<p><em>diff_base_head</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = file</li>
</ul>
<p>Display a visual comparison between the revision from which the file
has been checked-out and the latest revision. The diff command must
report a <em>normal</em> diff as opposed to <em>context</em> or <em>unified</em> ones.</p>
</div></blockquote>
<p><em>diff_working</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = file</li>
</ul>
<p>Display a visual comparison between the local file and the revision
from which it was obtained. The diff command must report a <em>normal</em> diff
as opposed to <em>context</em> or <em>unified</em> ones.</p>
</div></blockquote>
<p><em>diff</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = rev</li>
<li>$2 = file</li>
</ul>
<p>Display a visual comparison between the local file and the specified
revision. The diff command must report a <em>normal</em> diff
as opposed to <em>context</em> or <em>unified</em> ones.</p>
</div></blockquote>
<p><em>diff2</em></p>
<blockquote>
<div><ul class="simple">
<li>$1 = revision 1</li>
<li>$2 = revision 2</li>
<li>$3 = file</li>
</ul>
<p>Display a visual comparison between the two specified revisions of
the file. The diff command must report a <em>normal</em> diff
as opposed to <em>context</em> or <em>unified</em> ones.</p>
</div></blockquote>
</div>
<div class="section" id="implementing-vcs-menus">
<span id="id76"></span><h3>16.9.4. Implementing VCS menus<a class="headerlink" href="#implementing-vcs-menus" title="Permalink to this headline">¶</a></h3>
<p>GPS defines a standard set of Actions to interact with Version Control Systems.
All these actions can be viewed, for instance, in the &#8220;VCS&#8221; of the Key
Shortcuts dialog (see <a class="reference internal" href="#the-key-manager-dialog"><em>The Key Manager Dialog</em></a>).</p>
<p>A Python facility exists in plugin <cite>vcs.py</cite> to associate menu items to VCS
actions. This facility defines in one place the VCS menus that are to be
displayed in the global VCS menu, in the contextual menus on contexts that
contain files, and on the menus in the VCS explorer.</p>
<p>To use this facility, you must first define a list of associations in Python,
and then register this list through a call to <cite>vcs.register_vcs_actions</cite>.</p>
<p>This function takes as parameter:</p>
<dl class="docutils">
<dt><em>the name of the version control system</em></dt>
<dd>as defined in the <cite>name</cite> attribute of the <cite>vcs</cite> node in the XML
definition.</dd>
<dt><em>a list of dictionaries</em></dt>
<dd>of the form <cite>ACTION : &lt;name of the vcs action&gt;, LABEL: &lt;menu label&gt;</cite>.
The predefined <cite>SEPARATOR</cite> dictionary can be used to indicate a
separator which will be displayed in the contextual menus on file and on the
VCS Explorer.</dd>
</dl>
<p>If you have defined a custom VCS in a previous version of GPS, you will need
to define your menus through this facility. The easiest is to simply copy one
of the existing plugins (for instance <cite>subversion.py</cite> or
<cite>clearcase.py</cite>) and simply change the first parameter in the call to
<cite>register_vcs_actions</cite>.</p>
</div>
</div>
<div class="section" id="the-server-mode">
<span id="id77"></span><h2>16.10. The Server Mode<a class="headerlink" href="#the-server-mode" title="Permalink to this headline">¶</a></h2>
<p id="index-253">In order to give access to the GPS capabilities from external processes
(e.g. <cite>Emacs</cite>), GPS can be launched in <em>server mode</em>.</p>
<p>The two relevant command line switches are <cite>&#8211;server</cite> and <cite>&#8211;hide</cite>.</p>
<p><cite>&#8211;server</cite> will open a socket on the given port, allowing multiple clients to
connect to a running GPS, and sending GPS shell or python commands.</p>
<p><cite>&#8211;hide</cite> tells GPS not to display its main window when starting.  note that
under unix systems, you still need to have access to the current screen (as
determined by the <cite>DISPLAY</cite> environment variable) in this mode.</p>
<p>Using the two switches together provides a way to launch GPS as a background
process with no initial user interface.</p>
<p>Clients connecting through a standard socket have access to a simple shell
using <cite>GPS&gt;&gt;</cite> as the separating prompt between each command. This is needed in
order to determine when the output (result) of a command is terminated.</p>
<p>All the GPS shell commands (as defined in <a class="reference internal" href="#the-gps-shell"><em>The GPS Shell</em></a>) are available
from this shell. In addition, the python interpreter, if enabled, is also
available through the use of the <cite>python</cite> prefix before a python command.</p>
<p>For example, sending <cite>pwd</cite> through the socket will send the <cite>pwd</cite> command
through the GPS shell and display the result on the socket; similarly, sending
<cite>python GPS.pwd()</cite> will send the <cite>GPS.help()</cite> command through the python
interpreter (see <a class="reference internal" href="#the-python-interpreter"><em>The Python Interpreter</em></a> for more details).</p>
<p>The socket shell provides also additional commands:</p>
<ul class="simple">
<li>logout
This command will inform the GPS server that the connection should now
be closed.</li>
<li>id &lt;string&gt;
This command will register the current session with a given string.
This string can then be used within GPS itself (for example via a
.xml or python plug-in) to display extra information to the client via
the socket, using the command GPS.Socket().send.</li>
</ul>
<p>For example, let suppose that we start gps with the <cite>&#8211;server=1234</cite>
command: this will bring up GPS as usual.</p>
<p>Now, on a separate terminal, create a simple client by typing the following:</p>
<div class="highlight-python"><pre>telnet localhost 1234
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
GPS&gt;&gt; id test-1
id set to 'test-1'
GPS&gt;&gt; pwd
c:\\working-dir\\
GPS&gt;&gt;</pre>
</div>
<p>Then in the GPS Python Console:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">GPS</span><span class="o">.</span><span class="n">Socket</span> <span class="p">(</span><span class="s">&quot;test-1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">send</span> <span class="p">(</span><span class="s">&quot;hello, it&#39;s time to logout</span><span class="se">\\</span><span class="s">n&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>At this point, the following is received on the client (telnet) side:</p>
<div class="highlight-python"><pre>GPS&gt;&gt; hello, it's time to logout</pre>
</div>
<p>We can then close the client:</p>
<div class="highlight-python"><pre>logout
Connection closed by foreign host.</pre>
</div>
</div>
<div class="section" id="adding-project-templates">
<span id="id78"></span><h2>16.11. Adding project templates<a class="headerlink" href="#adding-project-templates" title="Permalink to this headline">¶</a></h2>
<p id="index-254">The Project template wizard lists a selection of templates. The default set is
found automatically by GPS in the <cite>share/gps/templates</cite> directory of your GPS
installation.</p>
<p>It is possible to register new directories in which GPS will look for
templates, by using the Shell/Python command
<cite>GPS.ProjectTemplate.add_templates_dir</cite>.</p>
<p>To create a new project template, first create a subdirectory in the
<cite>share/gps/templates/</cite> directory, or in one of the directories which has been
registered through <cite>GPS.ProjectTemplate.add_templates_dir</cite>. Then, in this
directory, create one template description file.</p>
<p>A template description file is a text file with the <cite>.gpt</cite> extension,
with the following syntax:</p>
<div class="highlight-python"><pre>Name: &lt;name&gt;
Category: &lt;category&gt;
Project: &lt;project file&gt;
&lt;optional_hook_line&gt;

&lt;variable_1&gt;: &lt;variable_1_default_value&gt;: &lt;variable_1_description&gt;
&lt;variable_2&gt;: &lt;variable_2_default_value&gt;: &lt;variable_3_description&gt;
&lt;etc&gt;

[Description]
&lt;the description&gt;</pre>
</div>
<p>Where the following should be defined:</p>
<ul class="simple">
<li>&lt;name&gt;
The name of the template as it will appear in the template tree in the project
template wizard.</li>
<li>&lt;category&gt;
The category in which the template will be inserted in the template tree. There
can be multiple levels of categories, separated with <cite>/</cite>.</li>
<li>&lt;variable_1&gt;
A name which will be substituted in the template files when deploying the
template, see below.</li>
<li>&lt;variable_1_default_value&gt;
The default value for variable 1, which will appear in the project template
wizard.</li>
<li>&lt;variable_1_description&gt;
The description of variable 1.</li>
<li>&lt;optional_hook_line&gt;
An optional line of the form <cite>post_hook: &lt;python_file&gt;</cite> where
<cite>&lt;python_file&gt;</cite> is the name of a Python file present in the same directory
as the template description file. This Python file will be run by GPS once,
right after the project template is deployed</li>
<li>&lt;description&gt;
A short paragraph describing the project template. This paragraph will be
displayed in the project template wizard when the template is selected in the
tree.</li>
</ul>
<p>When deploying templates, GPS will copy in the destination directory chosen by
the use all files and directories present in the directory that contains the
template description file, except the Python file indicated as post_hook, and
the template description file itself.</p>
<p>As it deploys templates, GPS will replace strings of the form
&#64;code{&#64;_&lt;variable_name&gt;_} with the value of the variable.  If <cite>&lt;variable_name&gt;</cite>
is all lower case, the substitution will be transformed to lower-case. If
<cite>&lt;variable_name&gt;</cite> is in Mixed_Case, the substitution will be transformed into
Mixed_Case as well. If it is in upper case, then the substitution will contain
the original value specified by the user.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="environment.html" title="17. Environment"
             >next</a> |</li>
        <li class="right" >
          <a href="remote.html" title="15. Using GPS for Remote Development"
             >previous</a> |</li>
        <li><a href="index.html">GPS 5.2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2013, AdaCore.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>